;(function(){var _vendors=['ms','moz','webkit','o'];function checkCustomEvent(){if(typeof window.CustomEvent==="function")return false;trace("window.CustomEvent is not supported, but replaceable");function CustomEvent(evt,p){p=p||{bubbles:false,cancelable:false,detail:undefined};var e=document.createEvent('CustomEvent');e.initCustomEvent(evt,p.bubbles,p.cancelable,p.detail);return e;};CustomEvent.prototype=window.Event.prototype;window.CustomEvent=CustomEvent;};function checkAnimationFrame(){var lastTime=0;for(var x=0;x<_vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[_vendors[x]+'RequestAnimationFrame'];window.cancelAnimationFrame=window[_vendors[x]+'CancelAnimationFrame']||window[_vendors[x]+'CancelRequestAnimationFrame'];};if(!window.requestAnimationFrame){trace("window.requestAnimationFrame is not supported, but replaceable");window.requestAnimationFrame=function(callback,element){var currTime=new Date().getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall);},timeToCall);lastTime=currTime+timeToCall;return id;};};if(!window.cancelAnimationFrame){trace("window.cancelAnimationFrame is not supported, but replaceable");window.cancelAnimationFrame=function(id){clearTimeout(id);};}};function checkNavigator(){if(!window.navigator)window.navigator=navigator;if(!window.navigator)trace("window.navigator is not supported!");};function checkAudioContext(){if(!window.AudioContext)window.AudioContext=window.webkitAudioContext;if(!window.AudioContext)trace("window.AudioContext is not supported!");};function checkUserMedia(){for(var x=0;x<_vendors.length&&!window.navigator.getUserMedia;++x){window.navigator.getUserMedia=window.navigator[_vendors[x]+'GetUserMedia'];};if(!window.navigator.getUserMedia)trace("window.navigator.getUserMedia is not supported!");};function checkURL(){if(!window.URL)window.URL=window.webkitURL;if(!window.URL)trace("window.URL is not supported!");};function checkFullscreenEnabled(){var pollute=true,doc=document,api,vendor,apis={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},webkit:{enabled:"webkitFullscreenEnabled",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},moz:{enabled:"mozFullScreenEnabled",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}}},w3=apis.w3;for(vendor in apis){if(apis[vendor].enabled in doc){api=apis[vendor];break;}};function dispatch(type,target){var event=doc.createEvent("Event");event.initEvent(type,true,false);target.dispatchEvent(event);};function handleChange(e){e.stopPropagation();e.stopImmediatePropagation();doc[w3.enabled]=doc[api.enabled];doc[w3.element]=doc[api.element];};function handleError(e){};function createResolver(method){return function resolver(resolve,reject){if(method===w3.exit&&!doc[api.element]){setTimeout(function(){reject(new TypeError());},1);return;};function change(){resolve();doc.removeEventListener(api.events.change,change,false);};function error(){reject(new TypeError());doc.removeEventListener(api.events.error,error,false);};doc.addEventListener(api.events.change,change,false);doc.addEventListener(api.events.error,error,false);};};if(pollute&&!(w3.enabled in doc)&&api){doc.addEventListener(api.events.change,handleChange,false);doc.addEventListener(api.events.error,handleError,false);doc[w3.enabled]=doc[api.enabled];doc[w3.element]=doc[api.element];doc[w3.exit]=function(){var result=doc[api.exit]();return!result&&window.Promise?new Promise(createResolver(w3.exit)):result;};Element.prototype[w3.request]=function(){var result=this[api.request].apply(this,arguments);return!result&&window.Promise?new Promise(createResolver(w3.request)):result;};}};checkCustomEvent();checkAnimationFrame();checkNavigator();checkAudioContext();checkUserMedia();checkURL();checkFullscreenEnabled();})();"use strict";function trace(){console.log(arguments);};function prop(t,pn,p){p.enumerable=true;p.configurable=true;Object.defineProperty(t,pn,p);};function cnst(t,pn,v){prop(t,pn,{get:function(){return v;}});};function roFunc(t,pn,f){cnst(t,pn,f);};function createClass(t,p,oa,b){function bc(t,p,a,oa,b){function bca(t,s,a,f){if(!t.$c)t.$c=[];if(t.$c.indexOf(f)==-1)t.$c.push(f);if(a.callee.caller==null||a.callee.caller.name!="bcb"){while(t.$c.length>0){var fnc=t.$c.shift();if(typeof fnc=="function")fnc.call(t);};t.$c=null;t.new=null;delete t.$c;delete t.new;};return t;};function bcb(t,p,a,oa){(p||Object).apply(t,oa||a);var s={};for(var k in t){if(k!="$c"&&k!="new"){if(Object.getOwnPropertyDescriptor(t,k).writable)s[k]=t[k];else prop(s,k,Object.getOwnPropertyDescriptor(t,k));}};return s;};var s=bcb(t,p,a,oa);if(typeof b=="function")b(t,s);return bca(t,s,a,t.new);};var h=arguments.callee.caller;var a=h&&h.name=="createSingletonClass"?h.arguments.callee.caller.arguments:h.arguments;return bc(t,p,a,oa,b);};function createSingletonClass(o,t,p,oa,b){var a=arguments.callee.caller.arguments.callee.caller;if(a&&a.name=="createClass")return createClass(t,p,oa,b);return o.$i||(o.$i=createClass(t,p,oa,b));};function sourcePath(v){if(ASJS.sourcePath=="")ASJS.sourcePath=v;};function includeOnce(f){if(ASJS.includedScript[f])return;ASJS.includedScript[f]=1;var script=ASJS.Tag("script");script.setAttr("type","text/javascript");script.setAttr("src",ASJS.sourcePath+f);(new ASJS.Head()).addChild(script);};var stage;var ASJS={sourcePath:"",includedScript:{},inited:false,start:function(b){if(ASJS.inited)return;ASJS.inited=true;window.onload=function(){stage=new ASJS.Stage();stage.init();new b();};}};ASJS.Point=function(x,y){return createClass(this,Object,null,function(_scope,_super){_scope.x=x||0;_scope.y=y||0;});};ASJS.Rectangle=function(x,y,width,height){return createClass(this,ASJS.Point,null,function(_scope,_super){_scope.width=width||0;_scope.height=height||0;});};ASJS.Matrix=function(a,b,c,d,e,f){return createClass(this,Object,null,function(_scope,_super){_scope.a=a||1;_scope.b=b||0;_scope.c=c||0;_scope.d=d||1;_scope.e=e||0;_scope.f=f||0;_scope.translate=function(tx,ty){matrix.e=tx;matrix.f=ty;};_scope.skew=function(sx,sy){matrix.b=sx;matrix.c=sy;};_scope.scale=function(sw,sh){matrix.a=sw;matrix.d=sh;}});};ASJS.GeomUtils={};cnst(ASJS.GeomUtils,"THETA",Math.PI/180);roFunc(ASJS.GeomUtils,"pointInOrigo",function(point){return point.x==0&&point.y==0;});roFunc(ASJS.GeomUtils,"twoPointDistance",function(pointA,pointB){return Math.sqrt(Math.pow(pointB.x-pointA.x,2)+Math.pow(pointB.y-pointA.y,2));});roFunc(ASJS.GeomUtils,"pointInRect",function(point,rect){return point.x>=rect.x&&point.x<=rect.x+rect.width&&point.y>=rect.y&&point.y<=rect.y+rect.height;});roFunc(ASJS.GeomUtils,"twoPointEquals",function(pointA,pointB){return pointA.x==pointB.x&&pointA.y==pointB.y;});roFunc(ASJS.GeomUtils,"twoPointAngle",function(pointA,pointB){var v=new ASJS.Point(pointB.x-pointA.x,pointB.y-pointA.y);var angle=Math.acos(v.x/Math.sqrt(Math.pow(v.x,2)+Math.pow(v.y,2)));return angle/ASJS.GeomUtils.THETA;});roFunc(ASJS.GeomUtils,"rectInRect",function(rectA,rectB){return rectA.x>=rectB.x&&rectA.y==rectB.y&&rectA.x+rectA.width<=rectB.x+rectB.width&&rectA.y+rectA.height<=rectB.y+rectB.height;});roFunc(ASJS.GeomUtils,"localToGlobal",function(target,point){var pos=new ASJS.Point(point.x,point.y);var child=target;while(child){pos.x*=child.scaleX;pos.y*=child.scaleY;pos.x+=child.x;pos.y+=child.y;child=child.parent;};return pos;});roFunc(ASJS.GeomUtils,"globalToLocal",function(target,point){var pos=new ASJS.Point(point.x,point.y);var child=target;var children=[child];while(child){child=child.parent;children.unshift(child);};var i=0;var l=children.length;while(++i<l){child=children[i];pos.x-=child.x;pos.y-=child.y;pos.x/=child.scaleX;pos.y/=child.scaleY;};return pos;});roFunc(ASJS.GeomUtils,"hitTest",function(target,point){var rotationDeg=-target.rotation*ASJS.GeomUtils.THETA;var rect=target.bounds;var globalPos=target.localToGlobal(new ASJS.Point(0,0));var diffPoint=new ASJS.Point(point.x-(globalPos.x+rect.width*0.5),point.y-(globalPos.y+rect.height*0.5));var rotatedDiffPoint=new ASJS.Point(diffPoint.x*Math.cos(rotationDeg)-diffPoint.y*Math.sin(rotationDeg),diffPoint.x*Math.sin(rotationDeg)+diffPoint.y*Math.cos(rotationDeg));var recalcPoint=new ASJS.Point(point.x-(diffPoint.x-rotatedDiffPoint.x),point.y-(diffPoint.y-rotatedDiffPoint.y));var localPoint=target.globalToLocal(recalcPoint);return localPoint.x>=0&&localPoint.y>=0&&localPoint.x<=rect.width&&localPoint.y<=rect.height;});ASJS.EventDispatcher=function(){return createClass(this,Object,null,function(_scope,_super){var _handlers={};_scope.dispatchEvent=function(event,data,bubble){var e;if(typeof event=="string"){e=new CustomEvent(event,{bubbles:bubble==undefined?true:bubble,cancelable:true,detail:data});}else e=event;var t=e.type||event;if(!_scope.hasEventListener(t))return;var handlers=_handlers[t];var i=-1;var l=handlers.length;while(++i<l)handlers[i](e);};_scope.addEventListener=function(type,handler){var types=type.split(" ");while(types.length>0){var t=types.shift();if(t!=""){if(_scope.hasEventListener(t,handler))return;if(!_handlers[t])_handlers[t]=[];_handlers[t].push(handler);}}};_scope.removeEventListeners=function(){_handlers={};};_scope.removeEventListener=function(type,handler){if(!_scope.hasEventListener(type,handler))return;_handlers[type].slice(_handlers[type].indexOf(handler),1);};_scope.hasEventListener=function(type,handler){var handlers=_handlers[type];if(handlers){if(!handler)return true;var i=-1;var l=handlers.length;while(++i<l){if(handlers[i]==handler)return true;}};return false;};});};ASJS.Event={};cnst(ASJS.Event,"CHANGE","change");ASJS.MouseEvent={};cnst(ASJS.MouseEvent,"SCROLL","DOMMouseScroll mousewheel scroll");cnst(ASJS.MouseEvent,"CLICK","click");cnst(ASJS.MouseEvent,"DOUBLE_CLICK","dblclick");cnst(ASJS.MouseEvent,"MOUSE_DOWN","mousedown");cnst(ASJS.MouseEvent,"MOUSE_UP","mouseup");cnst(ASJS.MouseEvent,"MOUSE_LEAVE","mouseleave");cnst(ASJS.MouseEvent,"MOUSE_ENTER","mouseenter");cnst(ASJS.MouseEvent,"MOUSE_MOVE","mousemove");cnst(ASJS.MouseEvent,"MOUSE_OVER","mouseover");cnst(ASJS.MouseEvent,"MOUSE_OUT","mouseout");cnst(ASJS.MouseEvent,"TOUCH_START","touchstart");cnst(ASJS.MouseEvent,"TOUCH_END","touchend");cnst(ASJS.MouseEvent,"TOUCH_MOVE","touchmove");cnst(ASJS.MouseEvent,"TOUCH_CANCEL","touchcancel");cnst(ASJS.MouseEvent,"CONTEXT_MENU","contextmenu");cnst(ASJS.MouseEvent,"SELECT_START","onselectstart");ASJS.KeyboardEvent={};cnst(ASJS.KeyboardEvent,"KEY_UP","keyup");cnst(ASJS.KeyboardEvent,"KEY_DOWN","keydown");cnst(ASJS.KeyboardEvent,"KEY_PRESS","keypress");ASJS.FocusEvent={};cnst(ASJS.FocusEvent,"FOCUS","focus");cnst(ASJS.FocusEvent,"BLUR","blur");ASJS.MediaEvent={};cnst(ASJS.MediaEvent,"ABORT","abort");cnst(ASJS.MediaEvent,"CAN_PLAY","canplay");cnst(ASJS.MediaEvent,"CAN_PLAY_THROUGH","canplaythrough");cnst(ASJS.MediaEvent,"DURATION_CHANGE","durationchange");cnst(ASJS.MediaEvent,"EMPTIED","emptied");cnst(ASJS.MediaEvent,"ENDED","ended");cnst(ASJS.MediaEvent,"ERROR","error");cnst(ASJS.MediaEvent,"LOADED_DATA","loadeddata");cnst(ASJS.MediaEvent,"LOADED_META_DATA","loadedmetadata");cnst(ASJS.MediaEvent,"LOAD_START","loadstart");cnst(ASJS.MediaEvent,"PAUSE","pause");cnst(ASJS.MediaEvent,"PLAY","play");cnst(ASJS.MediaEvent,"PLAYING","playing");cnst(ASJS.MediaEvent,"PROGRESS","progress");cnst(ASJS.MediaEvent,"RATE_CHANGE","ratechange");cnst(ASJS.MediaEvent,"SEEKED","seeked");cnst(ASJS.MediaEvent,"SEEKING","seeking");cnst(ASJS.MediaEvent,"STALLED","stalled");cnst(ASJS.MediaEvent,"SUSPEND","suspend");cnst(ASJS.MediaEvent,"TIME_UPDATE","timeupdate");cnst(ASJS.MediaEvent,"VOLUME_CHANGE","volumechange");cnst(ASJS.MediaEvent,"WAITING","waiting");ASJS.LoaderEvent={};cnst(ASJS.LoaderEvent,"ERROR","error");cnst(ASJS.LoaderEvent,"ABORT","abort");cnst(ASJS.LoaderEvent,"LOAD_START","loadstart");cnst(ASJS.LoaderEvent,"PROGRESS","progress");cnst(ASJS.LoaderEvent,"LOAD","load");cnst(ASJS.LoaderEvent,"LOAD_END","loadend");cnst(ASJS.LoaderEvent,"TIMEOUT","timeout");cnst(ASJS.LoaderEvent,"READY_STATE_CHANGE","readystatechange");ASJS.WindowEvent={};cnst(ASJS.WindowEvent,"POPSTATE","popstate");cnst(ASJS.WindowEvent,"RESIZE","resize");cnst(ASJS.WindowEvent,"ONLINE","online");cnst(ASJS.WindowEvent,"OFFLINE","offline");cnst(ASJS.WindowEvent,"MESSAGE","message");ASJS.Window=function(){return createSingletonClass(ASJS.Window,this,ASJS.EventDispatcher,null,function(_scope,_super){var _el=window;var _browserStatus;_scope.new=function(){for(var key in _el){if(key.search('on')===0)_el.addEventListener(key.slice(2),function(e){_scope.dispatchEvent(e);});};_browserStatus=_scope.navigator.onLine?ASJS.WindowEvent.ONLINE:ASJS.WindowEvent.OFFLINE;_scope.addEventListener(ASJS.WindowEvent.ONLINE+" "+ASJS.WindowEvent.OFFLINE,function(e){_browserStatus=e.type;});};prop(_scope,"el",{get:function(){return _el;}});prop(_scope,"isOnline",{get:function(){return _browserStatus==ASJS.WindowEvent.ONLINE;}});prop(_scope,"width",{get:function(){return _scope.el.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;}});prop(_scope,"height",{get:function(){return _scope.el.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;}});prop(_scope,"screen",{get:function(){return _scope.el.screen;}});prop(_scope,"screenTop",{get:function(){return _scope.screen.availTop;}});prop(_scope,"screenLeft",{get:function(){return _scope.screen.availLeft;}});prop(_scope,"screenWidth",{get:function(){return _scope.screen.width;}});prop(_scope,"screenHeight",{get:function(){return _scope.screen.height;}});prop(_scope,"screenAvailWidth",{get:function(){return _scope.screen.availWidth;}});prop(_scope,"screenAvailHeight",{get:function(){return _scope.screen.availHeight;}});prop(_scope,"url",{get:function(){return _scope.el.URL;}});prop(_scope,"navigator",{get:function(){return _scope.el.navigator;}});prop(_scope,"audioContext",{get:function(){return _scope.el.AudioContext;}});prop(_scope,"userMedia",{get:function(){return _scope.navigator.getUserMedia;}});prop(_scope,"devicePixelRatio",{get:function(){return _scope.el.devicePixelRatio;}});prop(_scope,"scrollTop",{get:function(){return(_scope.el.pageYOffset!=undefined?_scope.el.pageYOffset:document.scrollTop)-(document.clientTop||0);},set:function(v){_scope.el.scrollTo(_scope.scrollLeft,v);}});prop(_scope,"scrollLeft",{get:function(){return(_scope.el.pageXOffset!=undefined?_scope.el.pageXOffset:document.scrollLeft)-(document.clientLeft||0);},set:function(v){_scope.el.scrollTo(v,_scope.scrollTop);}});prop(_scope,"location",{get:function(){return _scope.el.location;},set:function(v){_scope.el.location=v;}});_scope.setTimeout=function(callback,duration){return _scope.el.setTimeout(function(){_scope.requestAnimationFrame(callback);},duration);};_scope.clearTimeout=function(id){return _scope.el.clearTimeout(id);};_scope.setInterval=function(callback,duration){return _scope.el.setInterval(function(){_scope.requestAnimationFrame(callback);},duration);};_scope.clearInterval=function(id){return _scope.el.clearInterval(id);};_scope.requestAnimationFrame=function(callback){return _scope.el.requestAnimationFrame(callback);};_scope.cancelAnimationFrame=function(id){_scope.el.cancelAnimationFrame(id);}});};ASJS.Keyboard=function(){return createClass(this,Object,null,function(_scope,_super){var _window=new ASJS.Window();var _pressedKeys={};var _downCallback;var _upCallback;_scope.isPressed=function(w){return _pressedKeys[w];};_scope.addKeyListener=function(target,downCallback,upCallback){if(!target)return;_downCallback=downCallback;_upCallback=upCallback;_scope.removeKeyListener(target);target.addEventListener(ASJS.KeyboardEvent.KEY_DOWN,onKeyDown);target.addEventListener(ASJS.KeyboardEvent.KEY_UP,onKeyUp);_window.addEventListener(ASJS.FocusEvent.BLUR,onBlur);};_scope.removeKeyListener=function(target){target.removeEventListener(ASJS.KeyboardEvent.KEY_DOWN,onKeyDown);target.removeEventListener(ASJS.KeyboardEvent.KEY_UP,onKeyUp);_window.removeEventListener(ASJS.FocusEvent.BLUR,onBlur);};function onBlur(){for(var k in _pressedKeys)_pressedKeys[k]=false;};function onKeyDown(e){_pressedKeys[e.which]=true;if(_downCallback)_downCallback();};function onKeyUp(e){_pressedKeys[e.which]=false;if(_upCallback)_upCallback();};});};cnst(ASJS.Keyboard,"SPACE",32);cnst(ASJS.Keyboard,"BACKSPACE",8);cnst(ASJS.Keyboard,"TAB",9);cnst(ASJS.Keyboard,"ENTER",13);cnst(ASJS.Keyboard,"SHIFT",16);cnst(ASJS.Keyboard,"CTRL",17);cnst(ASJS.Keyboard,"ALT",18);cnst(ASJS.Keyboard,"PAUSE_BREAK",19);cnst(ASJS.Keyboard,"CAPS_LOCK",20);cnst(ASJS.Keyboard,"ESCAPE",27);cnst(ASJS.Keyboard,"PAGE_UP",33);cnst(ASJS.Keyboard,"PAGE_DOWN",34);cnst(ASJS.Keyboard,"END",35);cnst(ASJS.Keyboard,"HOME",36);cnst(ASJS.Keyboard,"LEFT_ARROW",37);cnst(ASJS.Keyboard,"UP_ARROW",38);cnst(ASJS.Keyboard,"RIGHT_ARROW",39);cnst(ASJS.Keyboard,"DOWN_ARROW",40);cnst(ASJS.Keyboard,"INSERT",45);cnst(ASJS.Keyboard,"DELETE",46);cnst(ASJS.Keyboard,"NUM_0",48);cnst(ASJS.Keyboard,"NUM_1",49);cnst(ASJS.Keyboard,"NUM_2",50);cnst(ASJS.Keyboard,"NUM_3",51);cnst(ASJS.Keyboard,"NUM_4",52);cnst(ASJS.Keyboard,"NUM_5",53);cnst(ASJS.Keyboard,"NUM_6",54);cnst(ASJS.Keyboard,"NUM_7",55);cnst(ASJS.Keyboard,"NUM_8",56);cnst(ASJS.Keyboard,"NUM_9",57);cnst(ASJS.Keyboard,"A",65);cnst(ASJS.Keyboard,"B",66);cnst(ASJS.Keyboard,"C",67);cnst(ASJS.Keyboard,"D",68);cnst(ASJS.Keyboard,"E",69);cnst(ASJS.Keyboard,"F",70);cnst(ASJS.Keyboard,"G",71);cnst(ASJS.Keyboard,"H",72);cnst(ASJS.Keyboard,"I",73);cnst(ASJS.Keyboard,"J",74);cnst(ASJS.Keyboard,"K",75);cnst(ASJS.Keyboard,"L",76);cnst(ASJS.Keyboard,"M",77);cnst(ASJS.Keyboard,"N",78);cnst(ASJS.Keyboard,"O",79);cnst(ASJS.Keyboard,"P",80);cnst(ASJS.Keyboard,"Q",81);cnst(ASJS.Keyboard,"R",82);cnst(ASJS.Keyboard,"S",83);cnst(ASJS.Keyboard,"T",84);cnst(ASJS.Keyboard,"U",85);cnst(ASJS.Keyboard,"V",86);cnst(ASJS.Keyboard,"W",87);cnst(ASJS.Keyboard,"X",88);cnst(ASJS.Keyboard,"Y",89);cnst(ASJS.Keyboard,"Z",90);cnst(ASJS.Keyboard,"LEFT_WINDOW_KEY",91);cnst(ASJS.Keyboard,"RIGHT_WINDOW_KEY",92);cnst(ASJS.Keyboard,"SELECT_KEY",93);cnst(ASJS.Keyboard,"NUMPAD_0",96);cnst(ASJS.Keyboard,"NUMPAD_1",97);cnst(ASJS.Keyboard,"NUMPAD_2",98);cnst(ASJS.Keyboard,"NUMPAD_3",99);cnst(ASJS.Keyboard,"NUMPAD_4",100);cnst(ASJS.Keyboard,"NUMPAD_5",101);cnst(ASJS.Keyboard,"NUMPAD_6",102);cnst(ASJS.Keyboard,"NUMPAD_7",103);cnst(ASJS.Keyboard,"NUMPAD_8",104);cnst(ASJS.Keyboard,"NUMPAD_9",105);cnst(ASJS.Keyboard,"MULTIPLY",106);cnst(ASJS.Keyboard,"ADD",107);cnst(ASJS.Keyboard,"SUBTRACT",109);cnst(ASJS.Keyboard,"DECIMAL_POINT",110);cnst(ASJS.Keyboard,"DIVIDE",111);cnst(ASJS.Keyboard,"F1",112);cnst(ASJS.Keyboard,"F2",113);cnst(ASJS.Keyboard,"F3",114);cnst(ASJS.Keyboard,"F4",115);cnst(ASJS.Keyboard,"F5",116);cnst(ASJS.Keyboard,"F6",117);cnst(ASJS.Keyboard,"F7",118);cnst(ASJS.Keyboard,"F8",119);cnst(ASJS.Keyboard,"F9",120);cnst(ASJS.Keyboard,"F10",121);cnst(ASJS.Keyboard,"F11",122);cnst(ASJS.Keyboard,"F12",123);cnst(ASJS.Keyboard,"NUM_LOCK",144);cnst(ASJS.Keyboard,"SCROLL_LOCK",145);cnst(ASJS.Keyboard,"SEMICOLON",186);cnst(ASJS.Keyboard,"EQUAL_SIGN",187);cnst(ASJS.Keyboard,"COMMA",188);cnst(ASJS.Keyboard,"DASH",189);cnst(ASJS.Keyboard,"PERIOD",190);cnst(ASJS.Keyboard,"FORWARD_SLASH",191);cnst(ASJS.Keyboard,"GRAVE_ACCENT",192);cnst(ASJS.Keyboard,"OPEN_BRACKET",219);cnst(ASJS.Keyboard,"BACK_SLASH",220);cnst(ASJS.Keyboard,"CLOSE_BRAKET",221);cnst(ASJS.Keyboard,"SINGLE_QUOTE",222);ASJS.Mouse=function(){return createSingletonClass(ASJS.Mouse,this,Object,null,function(_scope,_super){var priv={};cnst(priv,"EVENT",ASJS.MouseEvent.MOUSE_MOVE+" "+ASJS.MouseEvent.TOUCH_MOVE);var _window=new ASJS.Window();var _mousePos=new ASJS.Point();prop(_scope,"mouseX",{get:function(){return _mousePos.x;}});prop(_scope,"mouseY",{get:function(){return _mousePos.y;}});_scope.show=function(){stage.setCSS("cursor","default");};_scope.hide=function(){stage.setCSS("cursor","none");};_scope.getRelativePosition=function(target){return target.globalToLocal(_mousePos);};_scope.init=function(){if(stage)_window.addEventListener(priv.EVENT,onMouseMove);};_scope.getTouchPointByEvent=function(e){var iosTouchEvent=e.touches;var androidTouchEvent=(e.originalEvent?e.originalEvent.touches:null);var touches=iosTouchEvent||androidTouchEvent;if(touches&&touches.length>0){var touch=touches[0];return new ASJS.Point(touch.pageX,touch.pageY);};return new ASJS.Point(e.pageX,e.pageY);};function onMouseMove(e){_mousePos=_scope.getTouchPointByEvent(e);};});};ASJS.Cycler=function(){return createSingletonClass(ASJS.Cycler,this,Object,null,function(_scope,_super){var _window=new ASJS.Window();var _isPlaying=false;var _fps=24;var _interval=getIntervalByFps();var _callbacks=[];var _timeoutId;prop(_scope,"isPlaying",{get:function(){return _isPlaying;}});prop(_scope,"fps",{get:function(){return _fps;},set:function(v){_fps=v;_interval=getIntervalByFps();_scope.start();}});_scope.addCallback=function(callback){if(!_scope.callbackExists(callback))_callbacks.push(callback);};_scope.removeCallback=function(callback){if(!_scope.callbackExists(callback))return;var i=-1;var l=_callbacks.length;var index;while(++i<l){if(_callbacks[i]==callback)index=i;};_callbacks.splice(index,1);};_scope.callbackExists=function(callback){var i=-1;var l=_callbacks.length;while(++i<l){if(_callbacks[i]==callback)return true;};return false;};_scope.start=function(){_isPlaying=true;tick();};_scope.stop=function(){_isPlaying=false;_timeoutId=_window.clearTimeout(_timeoutId);};function tick(){_timeoutId=_window.clearTimeout(_timeoutId);var i=-1;var l=_callbacks.length;while(++i<l){if(_callbacks[i])_callbacks[i]();};_timeoutId=_window.setTimeout(tick,_interval);};function getIntervalByFps(){return 1000/_fps;};});};ASJS.Head=function(){return createSingletonClass(ASJS.Head,this,Object,null,function(_scope,_super){var _children=[];var _el=document.head;prop(_scope,"el",{get:function(){return _head;}});prop(_scope,"numChildren",{get:function(){return _children.length;}});_scope.addChild=function(child){if(!child)return null;if(child.parent)child.parent.removeChild(child);_children.push(child);_el.append(child.el);child.parent=_scope;return child;};_scope.removeChild=function(child){if(!child)return null;_el.removeChild(child.el);var index=_scope.getChildIndex(child);if(index>-1)_children.splice(index,1);child.parent=null;return child;};_scope.contains=function(child){return _scope.getChildIndex(child)>-1;};_scope.getChildIndex=function(child){return!child?-1:_children.indexOf(child);}});};ASJS.Tag=function(tag){return createClass(this,Object,null,function(_scope,_super){var priv={};cnst(priv,"CREATED","created");var _el=!tag||typeof tag=="string"?document.createElement(tag||"div"):tag;var _parent=null;var _state=priv.CREATED;var _eventHandlers={};prop(_scope,"text",{get:function(){return _el.textContent||_el.innerText;},set:function(v){_el.textContent=v;_el.innerText=v;}});prop(_scope,"html",{get:function(){return _el.innerHTML;},set:function(v){_el.innerHTML=v;}});prop(_scope,"el",{get:function(){return _el;}});prop(_scope,"bounds",{get:function(){return new ASJS.Rectangle();}});prop(_scope,"parent",{get:function(){return _parent;},set:function(v){if(v==null||v.getChildIndex(_scope)>-1){_parent=v;_scope._sendParentChangeEvent();}}});prop(_scope,"stage",{get:function(){return _scope.parent?_scope.parent.stage:null;}});_scope.hasClass=function(v){var classList=_scope.getClassList();if(classList)return classList.contains(v);return!!_el.className.match(new RegExp('(\\s|^)'+v+'(\\s|$)'));};_scope.addClass=function(v){if(!_scope.hasClass(v))_el.className+=" "+v;};_scope.removeClass=function(v){var classList=_scope.getClassList();if(classList)classList.remove(v);else if(_scope.hasClass(v))_el.className=_el.className.replace(new RegExp('(\\s|^)'+v+'(\\s|$)'),' ');};_scope.getClassList=function(v){return _el.classList;};_scope.getAttr=function(k){return _el.getAttribute(k);};_scope.setAttr=function(k,v){if(_el.setAttribute)_el.setAttribute(k,v);};_scope.removeAttr=function(k){_el.removeAttribute(k);};_scope.clear=function(){_scope.html="";_scope.text="";};_scope.dispatchEvent=function(event,data,bubble){try{var e;if(typeof event=="string"){e=new CustomEvent(event,{bubbles:bubble==undefined?true:bubble,cancelable:true,detail:data});}else e=event;_scope.el.dispatchEvent(e);}catch(e){}};_scope.addEventListener=function(type,callback,capture){var types=type.split(" ");while(types.length>0){var t=types.shift();if(t!=""){if(_scope.hasEventListener(t,callback))return;if(!_eventHandlers[t])_eventHandlers[t]=[];_eventHandlers[t].push(callback);_scope.el.addEventListener(t,callback,capture);}}};_scope.removeEventListeners=function(){for(var type in _eventHandlers){var handlers=_eventHandlers[type];while(handlers.length>0)_scope.removeEventListener(type,handlers[0]);}};_scope.removeEventListener=function(type,callback){var handlers=_eventHandlers[type];if(!handlers)return;if(callback){var i=handlers.indexOf(callback);if(i==-1)return;handlers.splice(i,1);_scope.el.removeEventListener(type,callback);}else{while(handlers.length>0)_scope.removeEventListener(type,handlers[0]);};if(handlers.length==0){_eventHandlers[type]=null;delete _eventHandlers[type];}};_scope.hasEventListener=function(type,callback){var handlers=_eventHandlers[type];if(!handlers)return false;if(!callback)return true;return handlers.indexOf(callback)>-1;};_scope._sendParentChangeEvent=function(){var state=_scope.stage?ASJS.Stage.ADDED_TO_STAGE:ASJS.Stage.REMOVED_FROM_STAGE;if(_state!=priv.CREATED||state!=ASJS.Stage.REMOVED_FROM_STAGE)_scope.dispatchEvent(state,null,false);_state=state;}});};ASJS.PrimitiveDisplayObject=function(tag){return createClass(this,ASJS.Tag,null,function(_scope,_super){var priv={};cnst(priv,"ADD_PIXEL_TYPES",["width","height","top","left"]);_scope.new=function(){_scope.id="instance_"+(++ASJS.PrimitiveDisplayObject.instanceId);};prop(_scope,"id",{get:function(){return _scope.getAttr("id");},set:function(v){_scope.setAttr("id",v);}});prop(_scope,"enabled",{get:function(){return _scope.getAttr("disabled")!="disabled";},set:function(v){if(v){_scope.removeAttr("disabled");_scope.setCSS("pointer-events","auto");}else{_scope.setAttr("disabled","disabled");_scope.setCSS("pointer-events","none");}}});_scope.getCSS=function(k){var style=window.getComputedStyle(_scope.el);var v=style.getPropertyValue(k);if(v=="")v=_scope.el.style[ASJS.CSS.replaceHyphen(k)];return priv.ADD_PIXEL_TYPES.indexOf(k)>-1?parseFloat(v):v;};_scope.setCSS=function(k,v){k=ASJS.CSS.replaceHyphen(k);_scope.el.style[k]=priv.ADD_PIXEL_TYPES.indexOf(k)>-1&&typeof v=="number"?v+"px":v;};function getAbsoluteValue(v){return typeof v=="string"&&v.indexOf("%")>-1&&_scope.parent?(_scope.parent.width/100)*parseFloat(v):v;}});};ASJS.PrimitiveDisplayObject.instanceId=-1;ASJS.CSS=function(){return createSingletonClass(ASJS.CSS,this,Object,null,function(_scope,_super){var _window=new ASJS.Window();var _head=new ASJS.Head();var _runTimeStyle;var _merged;_scope.new=function(){updateMergedList();};prop(_scope,"styles",{get:function(){return _merged;}});_scope.getRuleBySelector=function(s){var i=-1;var l=_merged.length;while(++i<l){var rule=_merged[i].rule;if(rule.selectorText==s)return rule;};return null;};_scope.getRuleExists=function(s){return _scope.getRuleBySelector(s)!=null;};_scope.getPropertyFromRule=function(s,t){var r=_scope.getRuleBySelector(s);return!r?null:r.style[t];};_scope.setPropertyToRule=function(s,t,v){var r=_scope.getRuleBySelector(s);if(r){r.style[t]=v;updateMergedList();}};_scope.addRule=function(s,t){if(_scope.getRuleBySelector(s))return;createRunTimeStyle();_runTimeStyle.el.sheet.insertRule(s+"{"+(t||"")+"}",0);updateMergedList();};_scope.removeRule=function(s){var styles=getSheets();var i=-1;var l=_merged.length;while(++i<l){var rule=_merged[i];if(rule.rule.selectorText==s){styles[rule.sheetId].deleteRule(rule.ruleId);updateMergedList();return;}}};function updateMergedList(){var styles=getSheets();var i=-1;var l=styles.length;_merged=[];while(++i<l){var style=styles[i].cssRules;var j=-1;var m=style.length;while(++j<m)_merged.push(new Rule(i,j,style[j]));}};function getSheets(){return document.styleSheets;};function hasRunTimeStyle(){return _runTimeStyle;};function createRunTimeStyle(){if(hasRunTimeStyle())return;_runTimeStyle=new ASJS.Tag("style");_runTimeStyle.setAttr("type","text/css");_head.addChild(_runTimeStyle);};var Rule=function(sheetId,ruleId,rule){return createClass(this,Object,null,function(_scope,_super){_scope.sheetId=sheetId;_scope.ruleId=ruleId;_scope.rule=rule;});};});};prop(ASJS.CSS,"styles",{get:function(){return(new ASJS.CSS()).styles;}});roFunc(ASJS.CSS,"getRuleBySelector",function(s){return(new ASJS.CSS()).getRuleBySelector(s);});roFunc(ASJS.CSS,"getRuleExists",function(s){return(new ASJS.CSS()).getRuleExists(s);});roFunc(ASJS.CSS,"getPropertyFromRule",function(s,t){return(new ASJS.CSS()).getPropertyFromRule(s,t);});roFunc(ASJS.CSS,"setPropertyToRule",function(s,t,v){(new ASJS.CSS()).setPropertyToRule(s,t,v);});roFunc(ASJS.CSS,"addRule",function(s,t){(new ASJS.CSS()).addRule(s,t);});roFunc(ASJS.CSS,"removeRule",function(s){(new ASJS.CSS()).removeRule(s);});roFunc(ASJS.CSS,"replaceHyphen",function(s){return s.replace(/-./g,function(v){return v.replace("-","").toUpperCase();});});ASJS.Deferred=function(){return createClass(this,Object,null,function(_scope,_super){var _promise=new Promise();var _calledResolve=false;var _calledReject=false;var _resolveData;var _rejectData;_scope.new=function(){_promise.addEventListener(Promise.ADD_RESOLVE,callResolve);_promise.addEventListener(Promise.ADD_REJECT,callReject);};prop(_scope,"promise",{get:function(){return _promise;}});_scope.resolve=function(data){_resolveData=data;_calledResolve=true;callResolve();};_scope.reject=function(data){_rejectData=data;_calledReject=true;callReject();};function callResolve(){if(!_calledResolve)return;while(_promise.resolveFunction.length>0)_promise.resolveFunction.shift()(_resolveData);};function callReject(){if(!_calledReject)return;while(_promise.rejectFunction.length>0)_promise.rejectFunction.shift()(_rejectData);};function Promise(){return createClass(this,ASJS.EventDispatcher,null,function(_scope,_super){_scope.resolveFunction=[];_scope.rejectFunction=[];_scope.resolve=function(f){if(_scope.resolveFunction.indexOf(f)==-1){_scope.resolveFunction.push(f);_scope.dispatchEvent(Promise.ADD_RESOLVE);};return _scope;};_scope.reject=function(f){if(_scope.rejectFunction.indexOf(f)==-1){_scope.rejectFunction=f;_scope.dispatchEvent(Promise.ADD_REJECT);};return _scope;}});};cnst(Promise,"ADD_RESOLVE","Promise-addResolve");cnst(Promise,"ADD_REJECT","Promise-addReject");});};ASJS.RequestMethod={};cnst(ASJS.RequestMethod,"DELETE","DELETE");cnst(ASJS.RequestMethod,"GET","GET");cnst(ASJS.RequestMethod,"HEAD","HEAD");cnst(ASJS.RequestMethod,"OPTIONS","OPTIONS");cnst(ASJS.RequestMethod,"POST","POST");cnst(ASJS.RequestMethod,"PUT","PUT");ASJS.Loader=function(){return createClass(this,ASJS.EventDispatcher,null,function(_scope,_super){var _async=true;var _method=ASJS.RequestMethod.GET;var _headers={};var _responseType="text";var _request;var _username;var _password;var _url;var _data;_scope.new=function(){reset();};prop(_scope,"url",{get:function(){return _url;}});prop(_scope,"content",{get:function(){return _request.response;}});prop(_scope,"status",{get:function(){return _request.status;}});prop(_scope,"statusText",{get:function(){return _request.statusText;}});prop(_scope,"readyState",{get:function(){return _request.readyState;}});prop(_scope,"contentType",{set:function(v){_headers["Content-type"]=v;}});prop(_scope,"username",{set:function(v){_username=v;}});prop(_scope,"password",{set:function(v){_password=v;}});prop(_scope,"data",{set:function(v){_data=v;}});prop(_scope,"async",{set:function(v){_async=v;}});prop(_scope,"method",{set:function(v){_method=v;}});prop(_scope,"responseType",{set:function(v){_responseType=v;}});_scope.unload=function(){_scope.free();};_scope.setHeader=function(k,v){_headers[k]=v;};_scope.getHeader=function(k){return _request.getRequestHeader(k);};_scope.cancel=function(){_request.abort();};_scope.load=function(url){if(!url)return;_url=url;_request.open(_method,_url,_async,_username,_password);_request.responseType=_responseType;for(var k in _headers)_request.setRequestHeader(k,_headers[k]);_request.send(_data);};_scope.free=function(){reset();};function reset(){_request=null;_request=new XMLHttpRequest();if("withCredentials"in _request){}else if(typeof XDomainRequest!="undefined"){_request=new XDomainRequest();}else _request=null;if(_request==null)throw new Error("CORS not supported");_request.withCredentials=true;_request.addEventListener(ASJS.LoaderEvent.READY_STATE_CHANGE,onReadyStateChange);_request.addEventListener(ASJS.LoaderEvent.PROGRESS,onProgress);_request.addEventListener(ASJS.LoaderEvent.LOAD,onLoad);_request.addEventListener(ASJS.LoaderEvent.ERROR,onError);_request.addEventListener(ASJS.LoaderEvent.ABORT,onAbort);_request.addEventListener(ASJS.LoaderEvent.LOAD_START,onLoadStart);_request.addEventListener(ASJS.LoaderEvent.TIMEOUT,onTimeout);_request.addEventListener(ASJS.LoaderEvent.LOAD_END,onLoadEnd);};function onReadyStateChange(e){_scope.dispatchEvent(ASJS.LoaderEvent.READY_STATE_CHANGE,e);};function onLoadStart(){_scope.dispatchEvent(ASJS.LoaderEvent.LOAD_START);};function onProgress(e){if(e.lengthComputable)_scope.dispatchEvent(ASJS.LoaderEvent.PROGRESS,e);};function onLoad(e){_scope.dispatchEvent(ASJS.LoaderEvent.LOAD,e);};function onAbort(e){_scope.dispatchEvent(ASJS.LoaderEvent.ABORT,e);};function onTimeout(e){_scope.dispatchEvent(ASJS.LoaderEvent.TIMEOUT,e);};function onLoadEnd(e){_scope.dispatchEvent(ASJS.LoaderEvent.LOAD_END,e);};function onError(e){_scope.dispatchEvent(ASJS.LoaderEvent.ERROR,e);};});};ASJS.ScriptLoader=function(){return createClass(this,ASJS.Loader,null,function(_scope,_super){var _head=new ASJS.Head();var _type=ASJS.ScriptLoader.TYPE_EVALUATE;var _content;prop(_scope,"type",{get:function(){return _type;},set:function(v){_type=v;}});prop(_scope,"content",{get:function(){if(!_content&&_super.content!=""){_content=_type==ASJS.ScriptLoader.TYPE_EVALUATE?getEvaluatedScript():getImportedScript();_scope.free();};return _content;}});_scope.unload=function(){_content=null;_super.unload();};_scope.load=function(url){_scope.unload();_super.load(url);};function getEvaluatedScript(){return new Function(_super.content+" return Main;")();};function getImportedScript(){var id="ew"+(++ASJS.ScriptLoader.scripts);var script=new ASJS.Tag("script");script.setAttr("type","text/javascript");script.text="ASJS."+id+" = function(){"+_super.content+"return Main;};";_head.addChild(script);_head.removeChild(script);script=null;delete script;return ASJS[id]();}});};cnst(ASJS.ScriptLoader,"TYPE_EVALUATE","ASJS-ScriptLoader-typeEvaluate");cnst(ASJS.ScriptLoader,"TYPE_IMPORT","ASJS-ScriptLoader-typeImport");ASJS.ScriptLoader.scripts=0;ASJS.StyleLoader=function(){return createClass(this,ASJS.Loader,null,function(_scope,_super){var _head=new ASJS.Head();var _style;_scope.useStyle=function(){if(_style||_super.content=="")return;_style=new ASJS.Tag("style");_style.setAttr("type","text/css");_style.text=_super.content;_head.addChild(_style);_scope.free();};_scope.unload=function(){if(_style&&_head.contains(_style))_head.removeChild(_style);_style=null;_super.unload();};_scope.load=function(url){_scope.unload();_super.load(url);}});};ASJS.DisplayObject=function(tag){return createClass(this,ASJS.PrimitiveDisplayObject,null,function(_scope,_super){var _mouse=new ASJS.Mouse();var _filters=[];var _rotation=0;var _scaleX=1;var _scaleY=1;var _cssDisplay="block";_scope.new=function(){_scope.tabindex=-1;_scope.setCSS("pointer-events","auto");_scope.setCSS("position","absolute");_scope.setCSS("display",_cssDisplay);_scope.setSize(0,0);_scope.move(0,0);};prop(_scope,"bounds",{get:function(){return new ASJS.Rectangle(_scope.calcX,_scope.calcY,_scope.calcWidth,_scope.calcHeight);}});prop(_scope,"calcX",{get:function(){return _scope.x+(parseFloat(_scope.getCSS("marginLeft"))||0);}});prop(_scope,"calcY",{get:function(){return _scope.y+(parseFloat(_scope.getCSS("marginTop"))||0);}});prop(_scope,"calcWidth",{get:function(){var paddingLeft=parseFloat(_scope.getCSS("paddingLeft"))||0;var paddingRight=parseFloat(_scope.getCSS("paddingRight"))||0;var borderLeft=parseFloat(_scope.getCSS("borderLeft"))||0;var borderRight=parseFloat(_scope.getCSS("borderRight"))||0;return _scope.width+paddingLeft+paddingRight+borderLeft+borderRight;}});prop(_scope,"calcHeight",{get:function(){var paddingTop=parseFloat(_scope.getCSS("paddingTop"))||0;var paddingBottom=parseFloat(_scope.getCSS("paddingBottom"))||0;var borderTop=parseFloat(_scope.getCSS("borderTop"))||0;var borderBottom=parseFloat(_scope.getCSS("borderBottom"))||0;return _scope.height+paddingTop+paddingBottom+borderTop+borderBottom;}});prop(_scope,"mouse",{get:function(){return _mouse.getRelativePosition(_scope);}});prop(_scope,"tabIndex",{get:function(){return _scope.getAttr("tabindex");},set:function(v){_scope.setAttr("tabindex",v);}});prop(_scope,"tooltip",{get:function(){return _scope.setAttr("title");},set:function(v){_scope.setAttr("title",v);}});prop(_scope,"filters",{get:function(){return _filters;},set:function(v){_filters=v;var filters="";var i=-1;var l=_filters.length;while(++i<l)filters+=" "+_filters[i].execute();_scope.setCSS("filter",filters);}});prop(_scope,"display",{get:function(){return _cssDisplay;},set:function(v){_cssDisplay=v;_scope.setCSS("display",_cssDisplay);}});prop(_scope,"visible",{get:function(){return _scope.getCSS("display")!="none";},set:function(v){_scope.setCSS("display",v?_cssDisplay:"none");}});prop(_scope,"alpha",{get:function(){return parseFloat(_scope.getCSS("opacity"));},set:function(v){_scope.setCSS("opacity",v);}});prop(_scope,"x",{get:function(){return(parseFloat(_scope.getCSS("left"))||0)-(_scope.width-_scope.width/_scaleX)*0.5;},set:function(v){_scope.setCSS("left",v+(_scope.width-_scope.width/_scaleX)*0.5);}});prop(_scope,"y",{get:function(){return(parseFloat(_scope.getCSS("top"))||0)-(_scope.height-_scope.height/_scaleY)*0.5;},set:function(v){_scope.setCSS("top",v+(_scope.height-_scope.height/_scaleY)*0.5);}});prop(_scope,"width",{get:function(){return parseFloat(_scope.getCSS("width"))*_scaleX;},set:function(v){_scope.setCSS("width",typeof v!="number"?v:(parseFloat(v)/_scaleX));}});prop(_scope,"height",{get:function(){return parseFloat(_scope.getCSS("height"))*_scaleY;},set:function(v){_scope.setCSS("height",typeof v!="number"?v:(parseFloat(v)/_scaleY));}});prop(_scope,"rotation",{get:function(){return _rotation;},set:function(v){_rotation=parseFloat(v);drawTransform();}});prop(_scope,"scaleX",{get:function(){return _scaleX;},set:function(v){_scaleX=parseFloat(v);var oW=_scope.width/_scaleX;_scope.x+=(_scope.width-oW)*0.5;drawTransform();}});prop(_scope,"scaleY",{get:function(){return _scaleY;},set:function(v){_scaleY=parseFloat(v);var oH=_scope.height/_scaleY;_scope.y+=(_scope.height-oH)*0.5;drawTransform();}});_scope.requestFullscreen=function(){if(!ASJS.DisplayObject.FULLSCREEN_ENABLED)return;_scope.el.requestFullscreen();};_scope.exitFullscreen=function(){if(!ASJS.DisplayObject.FULLSCREEN_ENABLED)return;document.exitFullscreen();};_scope.scale=function(scaleX,scaleY){_scope.scaleX=scaleX;_scope.scaleY=scaleY;};_scope.move=function(x,y){_scope.x=x;_scope.y=y;};_scope.setSize=function(w,h){_scope.width=w;_scope.height=h;};_scope.hitTest=function(point){return ASJS.GeomUtils.hitTest(_scope,point);};_scope.localToGlobal=function(point){return ASJS.GeomUtils.localToGlobal(_scope,point);};_scope.globalToLocal=function(point){return ASJS.GeomUtils.globalToLocal(_scope,point);};function drawTransform(){_scope.setCSS("transform",'rotate('+_rotation+'deg) scaleX('+_scaleX+') scaleY('+_scaleY+')');}});};cnst(ASJS.DisplayObject,"FULLSCREEN_ENABLED",document.fullscreenEnabled);ASJS.Sprite=function(tag){return createClass(this,ASJS.DisplayObject,null,function(_scope,_super){var _children=[];var _mouseChildren=true;prop(_scope,"bounds",{get:function(){var rect=_super.bounds;var size=new ASJS.Rectangle();var i=-1;var l=_scope.numChildren;while(++i<l){var child=_scope.getChildAt(i);var childRect=child.bounds;if(i==0){size.x=childRect.x;size.y=childRect.y;size.width=childRect.width+childRect.x;size.height=childRect.height+childRect.y;}else{if(childRect.x<size.x)size.x=childRect.x;if(childRect.y<size.y)size.y=childRect.y;if(childRect.width+childRect.x>size.width)size.width=childRect.width+childRect.x;if(childRect.height+childRect.y>size.height)size.height=childRect.height+childRect.y;}};rect.x+=size.x;rect.y+=size.y;if(size.width-size.x>rect.width)rect.width=size.width-size.x;if(size.height-size.y>rect.height)rect.height=size.height-size.y;return rect;}});prop(_scope,"mouseChildren",{get:function(){return _mouseChildren;},set:function(v){_mouseChildren=v;var i=-1;var l=_scope.numChildren;while(++i<l)_scope.getChildAt(i).enabled=_mouseChildren;}});prop(_scope,"numChildren",{get:function(){return _children.length;}});_scope.clear=function(){while(_scope.numChildren>0)_scope.removeChildAt(0);_super.clear();};_scope.contains=function(child){return _scope.getChildIndex(child)>-1;};_scope.addChild=function(child){return _scope.addChildAt(child,_scope.numChildren);};_scope.addChildAt=function(child,index){if(!child)return null;if(child.parent)child.parent.removeChild(child);_scope.el.appendChild(child.el);child.enabled=child.enabled?_mouseChildren:child.enabled;_children.push(child);_scope.setChildIndex(child,index);child.parent=_scope;return child;};_scope.removeChild=function(child){if(!child)return null;_scope.el.removeChild(child.el);var index=_scope.getChildIndex(child);if(index>-1)_children.splice(index,1);child.parent=null;return child;};_scope.removeChildAt=function(index){return _scope.removeChild(_scope.getChildAt(index));};_scope.getChildAt=function(index){return index<0||index>_scope.numChildren-1?null:_children[index];};_scope.setChildIndex=function(child,index){if(!child||index<0)return null;var childActualIndex=_scope.getChildIndex(child);if(childActualIndex>-1)_children.splice(childActualIndex,1);var afterChild=_scope.getChildAt(index);if(afterChild)_scope.el.insertBefore(child.el,afterChild.el);_children.splice(index,0,child);return child;};_scope.getChildIndex=function(child){return!child?-1:_children.indexOf(child);};_scope.swapChildren=function(childA,childB){var childAIndex=_scope.getChildIndex(childA);var childBIndex=_scope.getChildIndex(childB);if(childAIndex==-1||childBIndex==-1)return false;_scope.setChildIndex(childA,childBIndex);_scope.setChildIndex(childB,childAIndex);return true;};_scope.getChildByDOMObject=function(domObject){if(!domObject)return null;var i=-1;var l=_scope.numChildren;while(++i<l){var child=_scope.getChildAt(i);if(domObject.id==child.id)return child;else if(child.numChildren){var grandChild=child.getChildByDOMObject(domObject);if(grandChild)return grandChild;}};return null;};_scope._sendParentChangeEvent=function(){_super._sendParentChangeEvent();var i=-1;var l=_scope.numChildren;while(++i<l)_scope.getChildAt(i)._sendParentChangeEvent();}});};ASJS.Stage=function(){return createSingletonClass(ASJS.Stage,this,ASJS.Sprite,[document.body],function(_scope,_super){var _inited=false;var _mouse=new ASJS.Mouse();var _window=new ASJS.Window();var _stageWidth=0;var _stageHeight=0;prop(_scope,"title",{get:function(){return document.title;},set:function(v){document.title=v;}});prop(_scope,"stage",{get:function(){return _scope;}});prop(_scope,"stageWidth",{get:function(){return _stageWidth;}});prop(_scope,"stageHeight",{get:function(){return _stageHeight;}});_scope.init=function(){if(_inited)return;_inited=true;_scope.clear();_scope.setSize("100%","100%");_window.addEventListener(ASJS.WindowEvent.RESIZE,recalcStageSize);recalcStageSize();_mouse.init();};function recalcStageSize(){var overflowX=_scope.getCSS("overflow-x");var overflowY=_scope.getCSS("overflow-y");_scope.setCSS("overflow-x","hidden");_scope.setCSS("overflow-y","hidden");_stageWidth=_window.width;_stageHeight=_window.height;_scope.setCSS("overflow-x",overflowX);_scope.setCSS("overflow-y",overflowY);_scope.dispatchEvent(ASJS.Stage.RESIZE);}});};cnst(ASJS.Stage,"RESIZE","ASJS-Stage-resize");cnst(ASJS.Stage,"ADDED_TO_STAGE","ASJS-Stage-addedToStage");cnst(ASJS.Stage,"REMOVED_FROM_STAGE","ASJS-Stage-removedFromStage");ASJS.IFrame=function(){return createClass(this,ASJS.DisplayObject,["iframe"],function(_scope,_super){prop(_scope,"src",{get:function(){return _scope.getAttr("src");},set:function(v){_scope.setAttr("src",v);}});_scope.isLoaded=function(){return _scope.el.contentDocument.title.indexOf("404")==-1;};_scope.sendMessage=function(data){_scope.el.contentWindow.postMessage(data,"*");}});};ASJS.Bitmap=function(bitmapWidth,bitmapHeight){return createClass(this,ASJS.DisplayObject,["canvas"],function(_scope,_super){var priv={};cnst(priv,"TARGET_FILL","targetFill");cnst(priv,"TARGET_STROKE","targetStroke");var _context;var _drawLine=false;var _drawFill=false;var _bitmapFilters;var _keepOriginal=true;var _original;_scope.new=function(){if(!getContext())throw new Error("ASJS.Bitmap (canvas) is not supported in your browser!");_scope.setBitmapSize(bitmapWidth,bitmapHeight);};prop(_scope,"keepOriginal",{get:function(){return _keepOriginal;},set:function(v){_keepOriginal=v;}});prop(_scope,"bitmapFilters",{get:function(){return _bitmapFilters;},set:function(v){_bitmapFilters=v;executeFilters();}});prop(_scope,"bitmapWidth",{get:function(){return _scope.getAttr("width");},set:function(v){_scope.setAttr("width",Math.max(1,v||1));}});prop(_scope,"bitmapHeight",{get:function(){return _scope.getAttr("height");},set:function(v){_scope.setAttr("height",Math.max(1,v||1));}});prop(_scope,"blendMode",{get:function(){return getContext().globalCompositeOperation;},set:function(v){getContext().globalCompositeOperation=v;}});prop(_scope,"globalAlpha",{get:function(){return getContext().globalAlpha;},set:function(v){getContext().globalAlpha=v;}});_scope.beginLineColorStyle=function(size,rgb,alpha,miterLimit,lineJoin,lineCap){beginPath();setLineStyle(size,miterLimit,lineJoin,lineCap);beginColorFill(priv.TARGET_STROKE,rgb,alpha);};_scope.beginLineGradientStyle=function(size,type,gradientParams,colors,lineMitter,lineJoin,lineCap){beginPath();setLineStyle(size,miterLimit,lineJoin,lineCap);beginGradientFill(priv.TARGET_STROKE,type,gradientParams,colors);};_scope.beginLinePatternStyle=function(size,image,repeat,lineMitter,lineJoin,lineCap){beginPath();setLineStyle(size,miterLimit,lineJoin,lineCap);beginPatternFill(priv.TARGET_STROKE,image,repeat);};_scope.beginColorFill=function(rgb,alpha){beginFill();beginColorFill(priv.TARGET_FILL,rgb,alpha);};_scope.beginGradientFill=function(type,gradientParams,colors){beginFill();beginGradientFill(priv.TARGET_FILL,type,gradientParams,colors);};_scope.beginPatternFill=function(image,repeat){beginFill();beginPatternFill(priv.TARGET_FILL,image,repeat);};_scope.translate=function(x,y){getContext().translate(x,y);};_scope.rotate=function(v){getContext().rotate(v*ASJS.GeomUtils.THETA);};_scope.scale=function(w,h){getContext().scale(w,h);};_scope.transform=function(matrix){getContext().transform(matrix.a,matrix.b,matrix.c,matrix.d,matrix.e,matrix.f);};_scope.endLineStyle=function(){var ctx=getContext();if(_drawLine)ctx.stroke();_drawLine=false;};_scope.endFill=function(){var ctx=getContext();getContext().closePath();if(_drawFill)ctx.fill();_drawFill=false;};_scope.moveTo=function(x,y){getContext().moveTo(x,y);};_scope.lineTo=function(x,y){getContext().lineTo(x,y);};_scope.drawRect=function(x,y,w,h){var ctx=getContext();if(_drawFill)ctx.fillRect(x,y,w,h);if(_drawLine)ctx.strokeRect(x,y,w,h);};_scope.drawCircle=function(x,y,r){_scope.drawArc(x,y,r,0,2*Math.PI);};_scope.drawArc=function(x,y,r,begin,end,counterclockwise){getContext().arc(x,y,r,begin,end,counterclockwise);};_scope.drawHTML=function(v){try{rasterizeHTML.drawHTML(v,_scope.el);}catch(e){throw new Error("Missing: http://www.github.com/cburgmer/rasterizeHTML.js");}};_scope.drawImage=function(image,sx,sy,sw,sh,x,y,w,h){try{getContext().drawImage(image.el,sx,sy,sw,sh,x,y,w,h);}catch(e){}};_scope.textStyle=function(font,align,baseline){var ctx=getContext();ctx.font=font;ctx.textAlign=align;ctx.textBaseline=baseline;};_scope.drawText=function(text,x,y){var ctx=getContext();if(_drawFill)ctx.fillText(text,x,y);if(_drawLine)ctx.strokeText(text,x,y);};_scope.measureText=function(text){return getContext().measureText(text);};_scope.clearRect=function(x,y,w,h){getContext().clearRect(x,y,w,h);};_scope.getDataUrl=function(type,encoderOptions){return _scope.el.toDataURL(type,encoderOptions);};_scope.getColorRgb=function(x,y){var color=_scope.getImageData(x,y,1,1);return{r:color.data[0],g:color.data[1],b:color.data[2],a:color.data[3]};};_scope.setColor=function(x,y){_scope.drawRect(x,y,1,1);};_scope.getImageData=function(x,y,w,h){return getContext().getImageData(x,y,w,h);};_scope.putImageData=function(imageData,x,y){getContext().putImageData(imageData,x,y);};_scope.merge=function(bitmap,srcX,srcY,srcW,srcH,x,y){_scope.putImageData(bitmap.getImageData(srcX,srcY,srcW,srcH),x,y);};_scope.destroy=function(){_scope.clearRect(0,0,_scope.bitmapWidth,_scope.bitmapHeight);_scope.setBitmapSize(1,1);if(_original)_original=null;};_scope.setBitmapSize=function(width,height){_scope.bitmapWidth=width;_scope.bitmapHeight=height;};_scope.clone=function(){var bmp=new ASJS.Bitmap(_scope.bitmapWidth,_scope.bitmapHeight);bmp.setSize(_scope.bitmapWidth,_scope.bitmapHeight);bmp.drawImage(_scope,0,0,_scope.bitmapWidth,_scope.bitmapHeight,0,0,_scope.bitmapWidth,_scope.bitmapHeight);return bmp;};_scope.getOriginal=function(){var bmp=new ASJS.Bitmap(_scope.bitmapWidth,_scope.bitmapHeight);if(_original)bmp.drawImage(_original,0,0,_scope.bitmapWidth,_scope.bitmapHeight,0,0,_scope.bitmapWidth,_scope.bitmapHeight);return bmp;};function beginPath(){getContext().beginPath();_drawLine=true;};function beginFill(){getContext().beginPath();_drawFill=true;};function addColorToGradient(gradient,stop,color,alpha){var rgb=hexToRGB(color);rgb.a=alpha;gradient.addColorStop(stop,rgbToString(rgb));};function fillStyle(targetType,v){var ctx=getContext();if(targetType==priv.TARGET_FILL)ctx.fillStyle=v;else ctx.strokeStyle=v;};function setLineStyle(size,miterLimit,lineJoin,lineCap){var ctx=getContext();ctx.lineWidth=size;ctx.miterLimit=miterLimit||10;ctx.lineJoin=lineJoin||ASJS.Bitmap.LINE_JOIN_MITER;ctx.lineCap=lineCap||ASJS.Bitmap.LINE_CAP_BUTT;};function beginColorFill(targetType,rgb,alpha){var rgb=hexToRgb(rgb);rgb.a=alpha;fillStyle(targetType,rgbToString(rgb));};function beginGradientFill(targetType,type,gradientData,colors){var ctx=getContext();var gradient;switch(type){case ASJS.Bitmap.GRADIENT_LINEAR:gradient=ctx.createLinearGradient(gradientParams);break;case ASJS.Bitmap.GRADIENT_RADIAL:gradient=ctx.createRadialGradient(gradientParams);break;};var i=-1;var l=colors.length;var color;while(++i<l){color=colors[i];addColorToGradient(gradient,color.stop,color.color,color.alpha);};fillStyle(targetType,gradient);};function beginPatternFill(targetType,image,repeat){var pattern=getContext().createPattern(image.el,repeat||ASJS.Bitmap.PATTERN_REPEAT);fillStyle(targetType,pattern);};function getContext(){if(!_context)_context=_scope.el.getContext("2d");return _context;};function rgbToString(rgb){return"rgba( "+rgb.r+", "+rgb.g+", "+rgb.b+", "+rgb.a+" )";};function hexToRgb(v){var shorthandRegex=/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i;v=v.replace(shorthandRegex,function(m,r,g,b){return r+r+g+g+b+b;});var result=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(v);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16),a:1}:null;};function executeFilters(){var l=_scope.bitmapFilters.length;if(l==0)return;if(_scope.keepOriginal){if(!_original){_original=new ASJS.Image();_original.src=_scope.getDataUrl("image/png",1.0);}else{_scope.drawImage(_original,0,0,_scope.bitmapWidth,_scope.bitmapHeight,0,0,_scope.bitmapWidth,_scope.bitmapHeight);_original=null;}};var i=-1;var pixels=_scope.getImageData(0,0,_scope.bitmapWidth,_scope.bitmapHeight);while(++i<l){var filter=_scope.bitmapFilters[i];pixels=filter.execute(pixels);};_scope.putImageData(pixels,0,0);}});};cnst(ASJS.Bitmap,"GRADIENT_LINEAR","ASJS-Bitmap-gradientLinear");cnst(ASJS.Bitmap,"GRADIENT_RADIAL","ASJS-Bitmap-gradientRadial");cnst(ASJS.Bitmap,"PATTERN_REPEAT","repeat");cnst(ASJS.Bitmap,"PATTERN_NO_REPEAT","no-repeat");cnst(ASJS.Bitmap,"PATTERN_REPEAT_X","repeat-x");cnst(ASJS.Bitmap,"PATTERN_REPEAT_Y","repeat-y");cnst(ASJS.Bitmap,"LINE_CAP_BUTT","butt");cnst(ASJS.Bitmap,"LINE_CAP_ROUND","round");cnst(ASJS.Bitmap,"LINE_CAP_SQUARE","square");cnst(ASJS.Bitmap,"LINE_JOIN_BEVEL","bevel");cnst(ASJS.Bitmap,"LINE_JOIN_ROUND","round");cnst(ASJS.Bitmap,"LINE_JOIN_MITER","miter");ASJS.Image=function(){return createClass(this,ASJS.DisplayObject,["img"],function(_scope,_super){prop(_scope,"bitmap",{get:function(){var bmp=new ASJS.Bitmap(_scope.imageWidth,_scope.imageHeight);bmp.drawImage(_scope,0,0,_scope.imageWidth,_scope.imageHeight,0,0,_scope.imageWidth,_scope.imageHeight);return bmp;}});prop(_scope,"imageWidth",{get:function(){return _scope.el.width;}});prop(_scope,"imageHeight",{get:function(){return _scope.el.height;}});prop(_scope,"src",{get:function(){return _scope.getAttr("src");},set:function(v){_scope.setAttr("src",v);}});prop(_scope,"alt",{get:function(){return _scope.getAttr("alt");},set:function(v){_scope.setAttr("alt",v);}});});};ASJS.Label=function(){return createClass(this,ASJS.DisplayObject,["label"],function(_scope,_super){prop(_scope,"for",{get:function(){return _scope.getAttr("for");},set:function(v){if(v&&v.id)_scope.setAttr("for",v.id);}});});};ASJS.Link=function(){return createClass(this,ASJS.Sprite,["a"],function(_scope,_super){prop(_scope,"href",{get:function(){return _scope.getAttr("href");},set:function(v){_scope.setAttr("href",v);}});prop(_scope,"target",{get:function(){return _scope.getAttr("target");},set:function(v){_scope.setAttr("target",v);}});prop(_scope,"download",{get:function(){return _scope.getAttr("download");},set:function(v){_scope.setAttr("download",v);}});});};ASJS.Scale9Grid=function(){return createClass(this,ASJS.Sprite,null,function(_scope,_super){var _size=new ASJS.Point();var _rectangle=new ASJS.Rectangle();var _blocks=[];_scope.new=function(){var i=-1;var l=9;while(++i<l){_blocks[i]=new ASJS.Sprite();_blocks[i].setCSS("background-repeat","no-repeat");_scope.addChild(_blocks[i]);};_blocks[0].setCSS("background-position","left top");_blocks[2].setCSS("background-position","right top");_blocks[6].setCSS("background-position","left bottom");_blocks[8].setCSS("background-position","right bottom");};prop(_scope,"x",{set:function(v){_super.x=v;}});prop(_scope,"y",{set:function(v){_super.y=v;}});prop(_scope,"width",{set:function(v){_super.width=v;}});prop(_scope,"height",{set:function(v){_super.height=v;}});prop(_scope,"backgroundImage",{set:function(v){var i=-1;var l=9;while(++i<l)_blocks[i].setCSS("background-image","url("+v+")");}});prop(_scope,"size",{get:function(){return _size;},set:function(v){_size=v;}});prop(_scope,"rect",{get:function(){return _rectangle;},set:function(v){_rectangle=v;}});_scope.setSize=function(w,h){_super.setSize(w,h);};_scope.render=function(){var rightSize=_size.x-(_rectangle.x+_rectangle.width);var bottomSize=_size.y-(_rectangle.y+_rectangle.height);var center=new ASJS.Point(_scope.width-_rectangle.x-rightSize,_scope.height-_rectangle.y-bottomSize);var percent=new ASJS.Point(Math.round(center.x/_rectangle.width),Math.round(center.y/_rectangle.height));var tl=new ASJS.Point(-(percent.x*_rectangle.x)*2,-(percent.y*_rectangle.y)*2);var br=new ASJS.Point(percent.x*rightSize,percent.y*bottomSize);var ps=new ASJS.Point((_size.x*percent.x)*2,(_size.y*percent.y)*2);_blocks[0].setSize(_rectangle.x,_rectangle.y);_blocks[1].setSize(_scope.width-_rectangle.x-rightSize,_rectangle.y);_blocks[2].setSize(_scope.width-_blocks[0].width-_blocks[1].width,_rectangle.y);_blocks[3].setSize(_rectangle.x,_scope.height-_rectangle.y-bottomSize);_blocks[4].setSize(_blocks[1].width,_blocks[3].height);_blocks[5].setSize(_blocks[2].width,_blocks[3].height);_blocks[6].setSize(_rectangle.x,_scope.height-_blocks[0].height-_blocks[3].height);_blocks[7].setSize(_blocks[1].width,_blocks[6].height);_blocks[8].setSize(_blocks[2].width,_blocks[6].height);_blocks[1].x=_blocks[0].width;_blocks[2].x=_blocks[1].x+_blocks[1].width;_blocks[3].y=_blocks[0].height;_blocks[4].move(_blocks[3].width,_blocks[1].height);_blocks[5].move(_blocks[4].x+_blocks[4].width,_blocks[1].height);_blocks[6].y=_blocks[3].y+_blocks[3].height;_blocks[7].move(_blocks[6].width,_blocks[6].y);_blocks[8].move(_blocks[7].x+_blocks[7].width,_blocks[6].y);_blocks[1].setCSS("background-position",tl.x+"px top");_blocks[1].setCSS("background-size",ps.x+"px "+_size.y+"px");_blocks[3].setCSS("background-position","left "+tl.y+"px");_blocks[3].setCSS("background-size",_size.x+"px "+ps.y+"px");_blocks[4].setCSS("background-position",tl.x+"px "+tl.y+"px");_blocks[4].setCSS("background-size",ps.x+"px "+ps.y+"px");_blocks[5].setCSS("background-position","right "+tl.y+"px");_blocks[5].setCSS("background-size",_size.x+"px "+ps.y+"px");_blocks[7].setCSS("background-position",tl.x+"px bottom");_blocks[7].setCSS("background-size",ps.x+"px "+_size.y+"px");}});};ASJS.AbstractMediaPlayer=function(tag){return createClass(this,ASJS.Sprite,null,function(_scope,_super){_scope.new=function(){_scope.controls=false;_scope.preload=ASJS.AbstractMediaPlayer.PRELOAD_AUTO;};prop(_scope,"buffered",{get:function(){return _scope.el.buffered;}});prop(_scope,"controller",{get:function(){return _scope.el.controller;}});prop(_scope,"currentSrc",{get:function(){return _scope.el.currentSrc;}});prop(_scope,"duration",{get:function(){return _scope.el.duration;}});prop(_scope,"ended",{get:function(){return _scope.el.ended;}});prop(_scope,"error",{get:function(){return _scope.el.error;}});prop(_scope,"networkState",{get:function(){return _scope.el.networkState;}});prop(_scope,"paused",{get:function(){return _scope.el.paused;}});prop(_scope,"played",{get:function(){return _scope.el.played;}});prop(_scope,"readyState",{get:function(){return _scope.el.readyState;}});prop(_scope,"seekable",{get:function(){return _scope.el.seekable;}});prop(_scope,"seeking",{get:function(){return _scope.el.seeking;}});prop(_scope,"startDate",{get:function(){return _scope.el.startDate;}});prop(_scope,"textTracks",{get:function(){return _scope.el.textTracks;}});prop(_scope,"controls",{get:function(){return _scope.el.controls;},set:function(v){_scope.el.controls=v;}});prop(_scope,"preload",{get:function(){return _scope.el.preload;},set:function(v){_scope.el.preload=v;}});prop(_scope,"muted",{get:function(){return _scope.el.muted;},set:function(v){_scope.el.muted=v;}});prop(_scope,"loop",{get:function(){return _scope.el.loop;},set:function(v){_scope.el.loop=v;}});prop(_scope,"autoplay",{get:function(){return _scope.el.autoplay;},set:function(v){_scope.el.autoplay=v;}});prop(_scope,"src",{get:function(){return _scope.el.src;},set:function(v){_scope.el.src=v;}});prop(_scope,"crossOrigin",{get:function(){return _scope.el.crossOrigin;},set:function(v){_scope.el.crossOrigin=v;}});prop(_scope,"currentTime",{get:function(){return _scope.el.currentTime;},set:function(v){_scope.el.currentTime=v;}});prop(_scope,"defaultMuted",{get:function(){return _scope.el.defaultMuted;},set:function(v){_scope.el.defaultMuted=v;}});prop(_scope,"defaultPlaybackRate",{get:function(){return _scope.el.defaultPlaybackRate;},set:function(v){_scope.el.defaultPlaybackRate=v;}});prop(_scope,"mediaGroup",{get:function(){return _scope.el.mediaGroup;},set:function(v){_scope.el.mediaGroup=v;}});prop(_scope,"playbackRate",{get:function(){return _scope.el.playbackRate;},set:function(v){_scope.el.playbackRate=v;}});prop(_scope,"volume",{get:function(){return _scope.el.volume;},set:function(v){_scope.el.volume=v;}});_scope.play=function(){_scope.el.play();};_scope.pause=function(){_scope.el.pause();};_scope.load=function(){_scope.el.load();};_scope.unload=function(){_scope.clear();_scope.removeAttr("src");}});};cnst(ASJS.AbstractMediaPlayer,"PRELOAD_NONE","none");cnst(ASJS.AbstractMediaPlayer,"PRELOAD_AUTO","auto");cnst(ASJS.AbstractMediaPlayer,"PRELOAD_METADATA","metadata");ASJS.VideoPlayer=function(){return createClass(this,ASJS.AbstractMediaPlayer,["video"],function(_scope,_super){prop(_scope,"poster",{get:function(){return _scope.el.poster;},set:function(v){_scope.el.poster=v;}});});};ASJS.AudioPlayer=function(){return createClass(this,ASJS.AbstractMediaPlayer,["audio"]);};ASJS.MediaSource=function(src,type){return createClass(this,ASJS.DisplayObject,["source"],function(_scope,_super){_scope.new=function(){_scope.src=src;_scope.type=type;};prop(_scope,"type",{get:function(){return _scope.getAttr("type");},set:function(v){_scope.setAttr("type",v);}});prop(_scope,"src",{get:function(){return _scope.getAttr("src");},set:function(v){_scope.setAttr("src",v);}});});};cnst(ASJS.MediaSource,"TYPE_AUDIO_MP3","audio/mpeg");cnst(ASJS.MediaSource,"TYPE_AUDIO_OGG","audio/ogg");cnst(ASJS.MediaSource,"TYPE_AUDIO_WAV","audio/wav");cnst(ASJS.MediaSource,"TYPE_VIDEO_MP4","video/mp4");cnst(ASJS.MediaSource,"TYPE_VIDEO_OGG","video/ogg");cnst(ASJS.MediaSource,"TYPE_VIDEO_WEBM","video/webm");ASJS.VideoTrack=function(){return createClass(this,ASJS.DisplayObject,["track"],function(_scope,_super){prop(_scope,"src",{get:function(){return _scope.getAttr("src");},set:function(v){_scope.setAttr("src",v);}});prop(_scope,"kind",{get:function(){return _scope.getAttr("kind");},set:function(v){_scope.setAttr("kind",v);}});prop(_scope,"label",{get:function(){return _scope.getAttr("label");},set:function(v){_scope.setAttr("label",v);}});prop(_scope,"srclang",{get:function(){return _scope.getAttr("srclang");},set:function(v){_scope.setAttr("srclang",v);}});});};cnst(ASJS.VideoTrack,"KIND_CAPTIONS","captions");cnst(ASJS.VideoTrack,"KIND_CHAPTERS","chapters");cnst(ASJS.VideoTrack,"KIND_DESCRIPTIONS","descriptions");cnst(ASJS.VideoTrack,"KIND_METADATA","metadata");cnst(ASJS.VideoTrack,"KIND_SUBTITLES","subtitles");ASJS.Easing=function(){return createClass(this,Object,null,function(_scope,_super){var _cycler=new ASJS.Cycler();var _isPlaying;var _id;var _step;var _target;var _from;var _change;var _to;var _type;var _duration;var _stepCallback;var _completeCallback;_scope.new=function(){_scope.stop();};_scope.stop=function(){_isPlaying=false;_cycler.removeCallback(update);};_scope.play=function(target,to,duration,type,stepCallback,completeCallback){_target=target;_from={};_change={};_to=to;_type=type;_duration=(duration/(1000/_cycler.fps));_stepCallback=stepCallback;_completeCallback=completeCallback;iterateParameters(function(k){_from[k]=_target[k];_change[k]=_to[k]-_from[k];});if(!ASJS.Easing[_type])_type="linearTween";letsPlay();};function letsPlay(){if(_isPlaying)return;_step=0;_isPlaying=true;_cycler.addCallback(update);};function update(){if(!_isPlaying)return;if(_step>=_duration){_scope.stop();iterateParameters(function(k){_target[k]=_to[k];});if(_stepCallback)_stepCallback();if(_completeCallback)_completeCallback();return;};iterateParameters(function(k){_target[k]=ASJS.Easing[_type](_step,_from[k],_change[k],_duration);});if(_stepCallback)_stepCallback();_step++;};function iterateParameters(callback){for(var k in _to)callback(k);}});};roFunc(ASJS.Easing,"linearTween",function(t,b,c,d){return c*t/d+b;});roFunc(ASJS.Easing,"easeInQuad",function(t,b,c,d){t/=d;return c*t*t+b;});roFunc(ASJS.Easing,"easeOutQuad",function(t,b,c,d){t/=d;return-c*t*(t-2)+b;});roFunc(ASJS.Easing,"easeInOutQuad",function(t,b,c,d){t/=d/2;if(t<1)return c/2*t*t+b;t--;return-c/2*(t*(t-2)-1)+b;});roFunc(ASJS.Easing,"easeInCubic",function(t,b,c,d){t/=d;return c*t*t*t+b;});roFunc(ASJS.Easing,"easeOutCubic",function(t,b,c,d){t/=d;t--;return c*(t*t*t+1)+b;});roFunc(ASJS.Easing,"easeInOutCubic",function(t,b,c,d){t/=d/2;if(t<1)return c/2*t*t*t+b;t-=2;return c/2*(t*t*t+2)+b;});roFunc(ASJS.Easing,"easeInQuart",function(t,b,c,d){t/=d;return c*t*t*t*t+b;});roFunc(ASJS.Easing,"easeOutQuart",function(t,b,c,d){t/=d;t--;return-c*(t*t*t*t-1)+b;});roFunc(ASJS.Easing,"easeInOutQuart",function(t,b,c,d){t/=d/2;if(t<1)return c/2*t*t*t*t+b;t-=2;return-c/2*(t*t*t*t-2)+b;});roFunc(ASJS.Easing,"easeInQuint",function(t,b,c,d){t/=d;return c*t*t*t*t*t+b;});roFunc(ASJS.Easing,"easeOutQuint",function(t,b,c,d){t/=d;t--;return c*(t*t*t*t*t+1)+b;});roFunc(ASJS.Easing,"easeInOutQuint",function(t,b,c,d){t/=d/2;if(t<1)return c/2*t*t*t*t*t+b;t-=2;return c/2*(t*t*t*t*t+2)+b;});roFunc(ASJS.Easing,"easeInSine",function(t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b;});roFunc(ASJS.Easing,"easeOutSine",function(t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b;});roFunc(ASJS.Easing,"easeInOutSine",function(t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b;});roFunc(ASJS.Easing,"easeInExpo",function(t,b,c,d){return c*Math.pow(2,10*(t/d-1))+b;});roFunc(ASJS.Easing,"easeOutExpo",function(t,b,c,d){return c*(-Math.pow(2,-10*t/d)+1)+b;});roFunc(ASJS.Easing,"easeInOutExpo",function(t,b,c,d){t/=d/2;if(t<1)return c/2*Math.pow(2,10*(t-1))+b;t--;return c/2*(-Math.pow(2,-10*t)+2)+b;});roFunc(ASJS.Easing,"easeInCirc",function(t,b,c,d){t/=d;return-c*(Math.sqrt(1-t*t)-1)+b;});roFunc(ASJS.Easing,"easeOutCirc",function(t,b,c,d){t/=d;t--;return c*Math.sqrt(1-t*t)+b;});roFunc(ASJS.Easing,"easeInOutCirc",function(t,b,c,d){t/=d/2;if(t<1)return-c/2*(Math.sqrt(1-t*t)-1)+b;t-=2;return c/2*(Math.sqrt(1-t*t)+1)+b;});ASJS.AnimationDescriptor=function(name,spriteSheet,size,frameDelay,sequenceList){return createClass(this,Object,null,function(_scope,_super){_scope.name=name||"";_scope.spriteSheet=spriteSheet||"";_scope.size=size||new ASJS.Point();_scope.frameDelay=Math.floor(Math.max(1,frameDelay||1));_scope.sequenceList=sequenceList||[];});};ASJS.AnimatedSprite=function(){return createClass(this,ASJS.DisplayObject,null,function(_scope,_super){var _cycler=new ASJS.Cycler();var _animations={};var _isPlaying=false;var _selectedAnimation="";var _step=0;var _angle=ASJS.AnimatedSprite.PLAY_NORMAL;var _imageCache=[];_scope.new=function(){_scope.stop();};prop(_scope,"selectedAnimation",{get:function(){return _selectedAnimation;}});_scope.addAnimationDescriptorList=function(animationDescriptorList){var i=-1;var l=animationDescriptorList.length;while(++i<l)_scope.addAnimationDescriptor(animationDescriptorList[i]);};_scope.addAnimationDescriptor=function(animationDescriptor){_animations[animationDescriptor.name]=animationDescriptor;};_scope.removeAnimationDescriptor=function(name){_animations[name]=null;delete _animations[name];};_scope.stop=function(){_step=0;_isPlaying=false;_cycler.removeCallback(update);};_scope.play=function(name,type){if(!_animations[name])return;var angle=!type?ASJS.AnimatedSprite.PLAY_NORMAL:(type==ASJS.AnimatedSprite.PLAY_NORMAL?ASJS.AnimatedSprite.PLAY_NORMAL:ASJS.AnimatedSprite.PLAY_REVERSE);if(_selectedAnimation==name&&_angle==angle){letsPlay();return;};_selectedAnimation=name;_angle=angle;_step=0;var spriteSheet=_animations[_selectedAnimation].spriteSheet;if(spriteSheet!=""){if(_imageCache.indexOf(spriteSheet)>-1)setSpriteSheet(spriteSheet);else{var loader=new ASJS.Loader();loader.addEventListener(ASJS.LoaderEvent.LOAD,function(){_imageCache.push(spriteSheet);setSpriteSheet(spriteSheet);});loader.addEventListener(ASJS.LoaderEvent.ERROR,function(){trace("Error: missing animation sprite sheet");});loader.load(spriteSheet);}}else letsPlay();};function setSpriteSheet(v){_scope.setCSS("background-image","url("+v+")");letsPlay();};function letsPlay(){if(_isPlaying)return;_isPlaying=true;_cycler.addCallback(update);};function update(){if(!_isPlaying)return;var selectedAnimation=_animations[_selectedAnimation];var sequenceList=selectedAnimation.sequenceList;var rect=sequenceList[_step];var size=selectedAnimation.size;var percentW=_scope.width/rect.width;var percentH=_scope.height/rect.height;_scope.setCSS("background-position",(-rect.x*percentW)+"px "+(-rect.y*percentH)+"px");_scope.setCSS("background-size",(size.x*percentW)+"px "+(size.y*percentH)+"px");_scope.setSize(rect.width*percentW,rect.height*percentH);if(_angle==ASJS.AnimatedSprite.PLAY_NORMAL){if(++_step>=sequenceList.length)_step=0;}else{if(--_step<0)_step=sequenceList.length-1;}}});};cnst(ASJS.AnimatedSprite,"PLAY_NORMAL","ASJS-AnimatedSprite-playNormal");cnst(ASJS.AnimatedSprite,"PLAY_REVERSE","ASJS-AnimatedSprite-playReverse");ASJS.AnimationLoader=function(){return createClass(this,Object,null,function(_scope,_super){var _dfd;var _loader;_scope.load=function(url){_dfd=new ASJS.Deferred();_loader=new ASJS.Loader();_loader.addEventListener(ASJS.LoaderEvent.LOAD,onLoad);_loader.addEventListener(ASJS.LoaderEvent.ERROR,onLoadError);_loader.method=ASJS.RequestMethod.GET;_loader.responseType="json";_loader.load(url);return _dfd.promise;};function parseAnimationDescriptor(data){var animationDescriptor=new ASJS.AnimationDescriptor(data.id,data.image,new ASJS.Point(data.imageSize.w,data.imageSize.h),data.frameDelay);var i=-1;var l=data.frames.length;var frames=[];while(++i<l){var frame=data.frames[i];var j=-1;var m=Math.max(1,frame.l||1)*animationDescriptor.frameDelay;while(++j<m)frames.push(new ASJS.Rectangle(frame.x,frame.y,frame.w,frame.h));};animationDescriptor.sequenceList=frames;return animationDescriptor;};function onLoad(){_loader.removeEventListeners();try{var i=-1;var l=_loader.content.length;var animationDescriptorList=[];while(++i<l)animationDescriptorList.push(parseAnimationDescriptor(_loader.content[i]));_dfd.resolve(animationDescriptorList);}catch(e){trace(e);throw new Error("Invalid animation descriptor file: "+_loader.url);_dfd.reject();}};function onLoadError(){_loader.removeEventListeners();_dfd.reject();}});};ASJS.BlendMode={};cnst(ASJS.BlendMode,"SOURCE_OVER","source-over");cnst(ASJS.BlendMode,"SOURCE_IN","source-in");cnst(ASJS.BlendMode,"SOURCE_OUT","source-out");cnst(ASJS.BlendMode,"SOURCE_ATOP","source-atop");cnst(ASJS.BlendMode,"DESTINATION_OVER","destination-over");cnst(ASJS.BlendMode,"DESTINATION_IN","destination-in");cnst(ASJS.BlendMode,"DESTINATION_OUT","destination-out");cnst(ASJS.BlendMode,"DESTINATION_ATOP","destination-atop");cnst(ASJS.BlendMode,"LIGHTER","lighter");cnst(ASJS.BlendMode,"COPY","copy");cnst(ASJS.BlendMode,"XOR","xor");cnst(ASJS.BlendMode,"MULTIPLY","multiply");cnst(ASJS.BlendMode,"SCREEN","screen");cnst(ASJS.BlendMode,"OVERLAY","overlay");cnst(ASJS.BlendMode,"DARKEN","darken");cnst(ASJS.BlendMode,"LIGHTEN","lighten");cnst(ASJS.BlendMode,"COLOR_DODGE","color-dodge");cnst(ASJS.BlendMode,"COLOR_BURN","color-burn");cnst(ASJS.BlendMode,"HARD_LIGHT","hard-light");cnst(ASJS.BlendMode,"SOFT_LIGHT","soft-light");cnst(ASJS.BlendMode,"DIFFERENCE","difference");cnst(ASJS.BlendMode,"EXCLUSION","exclusion");cnst(ASJS.BlendMode,"HUE","hue");cnst(ASJS.BlendMode,"SATURATION","saturation");cnst(ASJS.BlendMode,"COLOR","color");cnst(ASJS.BlendMode,"LUMINOSITY","luminosity");ASJS.GradientColorData=function(stop,color,alpha){return createClass(this,Object,null,function(_scope,_super){_scope.stop=stop||0;_scope.color=color||"#0";_scope.alpha=alpha||1;});};ASJS.LinearGradientData=function(x,y,w,h){return createClass(this,ASJS.Rectangle);};ASJS.RadialGradientData=function(x0,y0,r0,x1,y1,r1){return createClass(this,Object,null,function(_scope,_super){_scope.x0=x0||0;_scope.y0=y0||0;_scope.r0=r0||0;_scope.x1=x1||0;_scope.y1=y1||0;_scope.r1=r1||0;});};ASJS.AbstractBitmapFilter=function(){return createClass(this,Object,null,function(_scope,_super){_scope.execute=function(pixels){return pixels;}});};ASJS.AbstractConvoluteBitmapFilter=function(opaque){return createClass(this,ASJS.AbstractBitmapFilter,null,function(_scope,_super){var _opaque=opaque;prop(_scope,"_matrix",{get:function(){return[1];}});_scope.execute=function(pixels){var d=pixels.data;return convolute(pixels);};function convolute(pixels){var weights=_scope._matrix;var side=Math.round(Math.sqrt(weights.length));var halfSide=Math.floor(side*0.5);var src=pixels.data;var sw=pixels.width;var sh=pixels.height;var w=sw;var h=sh;var bitmapHelper=new ASJS.Bitmap(w,h);var output=bitmapHelper.getImageData(0,0,w,h);var dst=output.data;var alphaFac=_opaque?1:0;var y=-1;while(++y<h){var x=-1;while(++x<w){var sy=y;var sx=x;var dstOff=(y*w+x)*4;var r=0;var g=0;var b=0;var a=0;var cy=-1;while(++cy<side){var cx=-1;while(++cx<side){var scy=sy+cy-halfSide;var scx=sx+cx-halfSide;if(scy>=0&&scy<sh&&scx>=0&&scx<sw){var srcOff=(scy*sw+scx)*4;var wt=weights[cy*side+cx];r+=src[srcOff]*wt;g+=src[srcOff+1]*wt;b+=src[srcOff+2]*wt;a+=src[srcOff+3]*wt;}}};dst[dstOff]=r;dst[dstOff+1]=g;dst[dstOff+2]=b;dst[dstOff+3]=a+alphaFac*(255-a);}};return output;};});};ASJS.AlphaBitmapFilter=function(type){return createClass(this,ASJS.AbstractBitmapFilter,null,function(_scope,_super){var _isDarkness=type==ASJS.AlphaBitmapFilter.TYPE_DARKNESS;_scope.execute=function(pixels){var d=pixels.data;var i=-4;var l=d.length;while((i+=4)<l){var average=((d[i]+d[i+1]+d[i+2])/3);var a=Math.round(_isDarkness?255-average:average);d[i+3]-=a;};return pixels;}});};cnst(ASJS.AlphaBitmapFilter,"TYPE_DARKNESS","ASJS-AlphaBitmapFilter-typeDarkness");cnst(ASJS.AlphaBitmapFilter,"TYPE_BRIGHTNESS","ASJS-AlphaBitmapFilter-typeBrightness");ASJS.BlurBitmapFilter=function(opaque,value){return createClass(this,ASJS.AbstractConvoluteBitmapFilter,null,function(_scope,_super){var _blurValue=Math.max(1,value||1);prop(_scope,"_matrix",{get:function(){var value=1/Math.pow(_blurValue,2);var matrix=[];var i=-1;while(++i<_blurValue){var j=-1;while(++j<_blurValue){matrix.push(value);}};return matrix;}});});};ASJS.BrightnessBitmapFilter=function(adjustment){return createClass(this,ASJS.AbstractBitmapFilter,null,function(_scope,_super){var _adjustment=adjustment;_scope.execute=function(pixels){var d=pixels.data;var i=-4;var l=d.length;while((i+=4)<l){d[i]+=_adjustment;d[i+1]+=_adjustment;d[i+2]+=_adjustment;};return pixels;}});};ASJS.ContrastBitmapFilter=function(adjustment){return createClass(this,ASJS.AbstractBitmapFilter,null,function(_scope,_super){var _adjustment=adjustment||1;_scope.execute=function(pixels){var d=pixels.data;var i=-4;var l=d.length;while((i+=4)<l){d[i]=128-((128-d[i])*_adjustment);d[i+1]=128-((128-d[i+1])*_adjustment);d[i+2]=128-((128-d[i+2])*_adjustment);};return pixels;}});};ASJS.CutoutBitmapFilter=function(adjustment){return createClass(this,ASJS.AbstractBitmapFilter,null,function(_scope,_super){var _adjustment=adjustment||255;_scope.execute=function(pixels){var d=pixels.data;var average=255/_adjustment;var i=-4;var l=d.length;while((i+=4)<l){d[i]=Math.floor(d[i]/average)*average;d[i+1]=Math.floor(d[i+1]/average)*average;d[i+2]=Math.floor(d[i+2]/average)*average;};return pixels;}});};ASJS.GrayscaleBitmapFilter=function(){return createClass(this,ASJS.AbstractBitmapFilter,null,function(_scope,_super){_scope.execute=function(pixels){var d=pixels.data;var i=-4;var l=d.length;while((i+=4)<l){var r=d[i];var g=d[i+1];var b=d[i+2];var v=0.2126*r+0.7152*g+0.0722*b;d[i]=d[i+1]=d[i+2]=v;};return pixels;}});};ASJS.InvertBitmapFilter=function(){return createClass(this,ASJS.AbstractBitmapFilter,null,function(_scope,_super){_scope.execute=function(pixels){var d=pixels.data;var i=-4;var l=d.length;while((i+=4)<l){d[i]=128-(d[i]-128);d[i+1]=128-(d[i+1]-128);d[i+2]=128-(d[i+2]-128);};return pixels;}});};ASJS.SharpenBitmapFilter=function(opaque){return createClass(this,ASJS.AbstractConvoluteBitmapFilter,null,function(_scope,_super){prop(_scope,"_matrix",{get:function(){return[0,-1,0,-1,5,-1,0,-1,0];}});});};ASJS.ThresholdBitmapFilter=function(threshold){return createClass(this,ASJS.AbstractBitmapFilter,null,function(_scope,_super){var _threshold=threshold;_scope.execute=function(pixels){var d=pixels.data;var i=-4;var l=d.length;while((i+=4)<l){var r=d[i];var g=d[i+1];var b=d[i+2];var v=(0.2126*r+0.7152*g+0.0722*b>=_threshold)?255:0;d[i]=d[i+1]=d[i+2]=v;};return pixels;}});};ASJS.TintBitmapFilter=function(r,g,b,a){return createClass(this,ASJS.AbstractBitmapFilter,null,function(_scope,_super){var _r=r||0;var _g=g||0;var _b=b||0;var _a=a||0;_scope.execute=function(pixels){var d=pixels.data;var i=-4;var l=d.length;while((i+=4)<l){d[i]+=_r;d[i+1]+=_g;d[i+2]+=_b;d[i+3]+=_a;};return pixels;}});};ASJS.OpacityBitmapFilter=function(adjustment){return createClass(this,ASJS.AbstractBitmapFilter,null,function(_scope,_super){var _adjustment=adjustment||1;_scope.execute=function(pixels){var d=pixels.data;var i=-4;var l=d.length;while((i+=4)<l){d[i+3]*=_adjustment;};return pixels;}});};ASJS.MaskBitmapFilter=function(mask,pos,invert,cutout){return createClass(this,ASJS.AbstractBitmapFilter,null,function(_scope,_super){var _mask=mask;var _pos=pos;var _invert=invert;var _cutout=cutout==undefined?true:cutout;_scope.execute=function(pixels){var srcD=pixels.data;var maskPixels=mask.getImageData(0,0,mask.bitmapWidth,mask.bitmapHeight);var maskD=maskPixels.data;var srcW=pixels.width;var maskW=maskPixels.width;var maskH=maskPixels.height;var maxMaskW=_pos.x+maskW;var maxMaskH=_pos.y+maskH;var i=-4;var l=srcD.length;while((i+=4)<l){var srcPixelLinearPos=Math.floor(i/4);var srcPixelPos=new ASJS.Point(Math.floor(srcPixelLinearPos%srcW),Math.floor(srcPixelLinearPos/srcW));if(srcPixelPos.x>=_pos.x&&srcPixelPos.y>=_pos.y&&srcPixelPos.x<maxMaskW&&srcPixelPos.y<maxMaskH){var j=((srcPixelPos.y-_pos.y)*maskW+(srcPixelPos.x-_pos.x))*4;var sA=srcD[i+3];var mA=maskD[j+3];srcD[i+3]=Math.floor(sA*((_invert?(255-mA):mA)/255));}else if(_cutout)srcD[i+3]=0;};return pixels;}});};ASJS.PixelateBitmapFilter=function(value){return createClass(this,ASJS.AbstractBitmapFilter,null,function(_scope,_super){var _value=Math.max(1,value||1);_scope.execute=function(pixels){var d=pixels.data;var pixS=_value;var w=pixels.width;var h=pixels.height;var step=4*pixS;var i=-step;var l=d.length;while((i+=step)<l){var pixelLinearPos=Math.floor(i/4);var pixelPos=new ASJS.Point(Math.floor(pixelLinearPos%w),Math.floor(pixelLinearPos/w));if(pixelPos.x%pixS>0)i=i-pixelPos.x*4-step;else if((pixelPos.y%pixS)==0){var x;var y;var r=0;var g=0;var b=0;var a=0;var maxW=Math.min(w-pixelPos.x,pixS);var maxH=Math.min(h-pixelPos.y,pixS);x=-1;while(++x<maxW){y=-1;while(++y<maxH){var pos=i+y*4*w+x*4;r+=d[pos];g+=d[pos+1];b+=d[pos+2];a+=d[pos+3];}};var pb=maxW*maxH;r=Math.round(r/pb);g=Math.round(g/pb);b=Math.round(b/pb);a=Math.round(a/pb);x=-1;while(++x<maxW){y=-1;while(++y<maxH){var pos=i+y*4*w+x*4;d[pos]=r;d[pos+1]=g;d[pos+2]=b;d[pos+3]=a;}}}};return pixels;}});};ASJS.BitmapBounds={};roFunc(ASJS.BitmapBounds,"execute",function(bitmap){var pixels=bitmap.getImageData(0,0,bitmap.bitmapWidth,bitmap.bitmapHeight);var d=pixels.data;var w=pixels.width;var size=new ASJS.Rectangle(pixels.width,pixels.height,0,0);var i=-4;var l=d.length;while((i+=4)<l){if(d[i+3]>0){var pixelLinearPos=Math.floor(i/4);var pixelPos=new ASJS.Point(Math.floor(pixelLinearPos%w),Math.floor(pixelLinearPos/w));if(pixelPos.x<size.x)size.x=pixelPos.x;if(pixelPos.y<size.y)size.y=pixelPos.y;if(pixelPos.x-size.x+1>size.width)size.width=pixelPos.x-size.x+1;if(pixelPos.y-size.y+1>size.height)size.height=pixelPos.y-size.y+1;}};return size;});ASJS.Cell=function(tag){return createClass(this,ASJS.Sprite,null,function(_scope,_super){var _data={};var _checked=false;_scope.new=function(){_scope.setCSS("position","relative");_scope.mouseChildren=false;_scope.addEventListener(ASJS.MouseEvent.CLICK,onClick);};prop(_scope,"name",{get:function(){return _scope.getAttr("name");},set:function(v){_scope.setAttr("name",v);}});prop(_scope,"checked",{get:function(){return _checked;},set:function(v){_checked=v;}});prop(_scope,"data",{get:function(){return _data;},set:function(v){_data=v;if(_data.id)_scope.id=_data.id;_scope.showData();}});_scope.render=function(){};_scope.showData=function(){};function onClick(e){_scope.dispatchEvent(ASJS.Cell.CLICK,{ctrlKey:e.ctrlKey,shiftKey:e.shiftKey});}});};cnst(ASJS.Cell,"CLICK","ASJS-Cell-click");ASJS.CustomList=function(){return createClass(this,ASJS.Sprite,null,function(_scope,_super){var _multiselect=false;var _cell=ASJS.Cell;var _lastCellIndex=0;var _itemsContainer=new ASJS.Sprite();var _name="";_scope.new=function(){_itemsContainer.setCSS("position","relative");_itemsContainer.setSize("auto","auto");_itemsContainer.addEventListener(ASJS.Cell.CLICK,onCellClick);_scope.addChild(_itemsContainer);};prop(_scope,"length",{get:function(){return _itemsContainer.numChildren;}});prop(_scope,"cell",{set:function(v){_cell=v;}});prop(_scope,"multiselect",{get:function(){return _multiselect;},set:function(v){_multiselect=v;}});prop(_scope,"selected",{get:function(){var v=[];var i=-1;var l=_scope.length;while(++i<l){var item=_scope.getCellAt(i);if(item.checked)v.push(item);};return v;},set:function(v){_scope.clearSelection();var j=-1;var l=_scope.length;var vLength=_scope.multiselect?v.length:1;while(++j<vLength){var i=-1;while(++i<l){if(i==v[j])_scope.getCellAt(i).checked=true;}}}});prop(_scope,"name",{get:function(){return _name;},set:function(v){_name=v;var i=-1;var l=_scope.length;while(++i<l)_scope.getCellAt(i).name=_name;}});_scope.clearSelection=function(){var i=-1;var l=_scope.length;while(++i<l)_scope.getCellAt(i).checked=false;};_scope.clearList=function(){while(_scope.length>0)_itemsContainer.removeChildAt(0);};_scope.setList=function(cellDataVoList){_scope.clearList();var i=-1;var l=cellDataVoList.length;while(++i<l)_scope.addItem(cellDataVoList[i]);};_scope.getList=function(){var list=[];var i=-1;var l=_scope.length;while(++i<l)list.push(_scope.getItemAt(i));return list;};_scope.getCellAt=function(index){return index<0||index>=_scope.length?null:_itemsContainer.getChildAt(index);};_scope.getItemAt=function(index){var cell=_scope.getCellAt(index);return cell?cell.data:null;};_scope.getCellById=function(id){var i=-1;var l=_scope.length;while(++i<l){var cell=_scope.getCellAt(i);if(cell.id==id)return cell;};return null;};_scope.getItemById=function(id){var cell=_scope.getCellById(id);return cell?cell.data:null;};_scope.addItem=function(cellDataVo){var cell=new _cell();cell.name=_name;cell.data=cellDataVo;return _itemsContainer.addChild(cell);};_scope.addItemAt=function(cellDataVo,index){return _itemsContainer.setChildIndex(_scope.addItem(cellDataVo),index);};_scope.removeCell=function(cell){if(!cell||!_itemsContainer.contains(cell))return;_itemsContainer.removeChild(cell);};_scope.removeCellById=function(id){_scope.removeCell(_scope.getCellById(id));};_scope.render=function(){var i=-1;var l=_scope.length;while(++i<l){var cell=_scope.getCellAt(i);cell.setSize(_scope.width,_scope.height);cell.render();}};function onCellClick(e){var cell=_itemsContainer.getChildByDOMObject(e.target);if(!cell)return;if(!_scope.multiselect||(!e.detail.ctrlKey&&!e.detail.shiftKey))_scope.clearSelection();cell.checked=e.detail.ctrlKey?!cell.checked:true;var cellIndex=_itemsContainer.getChildIndex(cell);if(_scope.multiselect&&!e.detail.ctrlKey&&e.detail.shiftKey){var i=-1;var l=Math.abs(cellIndex-_lastCellIndex);var step=cellIndex>_lastCellIndex?-1:1;while(++i<l){cell=_scope.getCellAt(cellIndex+((i+1)*step));cell.checked=true;}};_lastCellIndex=cellIndex;_scope.dispatchEvent(ASJS.CustomList.CHANGE);}});};cnst(ASJS.CustomList,"CHANGE","ASJS-CustomList-change");ASJS.CellDataVo=function(data){return createClass(this,Object,null,function(_scope,_super){_scope.id;_scope.new=function(){var d=data||{};_scope.id=d.id||null;}});};ASJS.FormElement=function(tag){return createClass(this,ASJS.Sprite,null,function(_scope,_super){_scope.new=function(){_scope.tabIndex="auto";};prop(_scope,"name",{get:function(){return _scope.getAttr("name");},set:function(v){_scope.setAttr("name",v);}});_scope.render=function(){};});};ASJS.AbstractTextElement=function(tag){return createClass(this,ASJS.FormElement,null,function(_scope,_super){var _protectedChars=[ASJS.Keyboard.LEFT_ARROW,ASJS.Keyboard.UP_ARROW,ASJS.Keyboard.RIGHT_ARROW,ASJS.Keyboard.DOWN_ARROW,ASJS.Keyboard.BACKSPACE,ASJS.Keyboard.TAB,ASJS.Keyboard.DELETE,ASJS.Keyboard.ENTER,ASJS.Keyboard.SHIFT,ASJS.Keyboard.CTRL,ASJS.Keyboard.END,ASJS.Keyboard.HOME,ASJS.Keyboard.CAPS_LOCK,ASJS.Keyboard.ESCAPE];var _controlChars=[ASJS.Keyboard.A,ASJS.Keyboard.C,ASJS.Keyboard.V,ASJS.Keyboard.X,ASJS.Keyboard.NUMPAD_1,ASJS.Keyboard.NUMPAD_3,ASJS.Keyboard.F7,ASJS.Keyboard.F9];var _restrict;_scope.new=function(){_scope.addEventListener(ASJS.KeyboardEvent.KEY_PRESS,onKeyPress);_scope.addEventListener(ASJS.KeyboardEvent.KEY_UP,onKeyUp);_scope.addEventListener(ASJS.Event.CHANGE,onChange);};prop(_scope,"readonly",{get:function(){return _scope.getAttr("readonly");},set:function(v){if(v)_scope.setAttr("readonly","readonly");else _scope.removeAttr("readonly");}});prop(_scope,"placeholder",{get:function(){return _scope.getAttr("placeholder");},set:function(v){_scope.setAttr("placeholder",v);}});prop(_scope,"val",{get:function(){return _scope.el.value;},set:function(v){_scope.el.value=v;}});prop(_scope,"maxChar",{get:function(){return _scope.getAttr("maxLength");},set:function(v){_scope.setAttr("maxLength",v);}});prop(_scope,"restrict",{get:function(){return _restrict;},set:function(v){_restrict=v;}});prop(_scope,"autofocus",{get:function(){return _scope.getAttr("autofocus");},set:function(v){if(v)_scope.setAttr("autofocus","autofocus");else _scope.removeAttr("autofocus");}});function onKeyPress(e){if(_restrict){var charCode=e.which?e.which:e.keyCode;if(_protectedChars.indexOf(e.keyCode)>-1||(e.ctrlKey&&_controlChars.indexOf(charCode)>-1))return;if(!new RegExp(_restrict,"i").test(String.fromCharCode(e.which)))return false;}};function onKeyUp(e){var charCode=e.which?e.which:e.keyCode;if(e.ctrlKey&&_controlChars.indexOf(charCode)>-1)onChange(e);};function onChange(){if(_restrict)_scope.val=_scope.val.replace(new RegExp("(?!"+_restrict+").","g"),'');}});};ASJS.Button=function(){return createClass(this,ASJS.FormElement,["input"],function(_scope,_super){_scope.new=function(){_scope.setAttr("type","button");};prop(_scope,"label",{get:function(){return _scope.getAttr("value");},set:function(v){_scope.setAttr("value",v);}});prop(_scope,"submit",{get:function(){return _scope.getAttr("type")=="submit";},set:function(v){_scope.setAttr("type",v?"submit":"button");}});});};ASJS.Checkbox=function(){return createClass(this,ASJS.FormElement,["label"],function(_scope,_super){var _checkbox=new ASJS.DisplayObject("input");var _label=new ASJS.DisplayObject();_scope.new=function(){_checkbox.setAttr("type","checkbox");_checkbox.visible=false;_scope.addChild(_checkbox);_label.setSize("100%","100%");_label.enabled=false;_scope.addChild(_label);};prop(_scope,"label",{get:function(){return _label;}});prop(_scope,"checkbox",{get:function(){return _checkbox;}});prop(_scope,"enabled",{set:function(v){_super.enabled=_checkbox.enabled=v;_scope.render();}});prop(_scope,"name",{get:function(){return _checkbox.getAttr("name");},set:function(v){_checkbox.setAttr("name",v);}});prop(_scope,"checked",{get:function(){return _checkbox.el.checked;},set:function(v){_checkbox.el.checked=v;_checkbox.el.change();}});});};ASJS.DropDownOption=function(value,label,disabled,selected){return createClass(this,ASJS.PrimitiveDisplayObject,["option"],function(_scope,_super){_scope.new=function(){_scope.value=value||0;_scope.label=label||"";_scope.disabled=disabled||false;_scope.selected=selected||false;};prop(_scope,"value",{get:function(){return _scope.getAttr("value");},set:function(v){_scope.setAttr("value",v);}});prop(_scope,"label",{get:function(){return _scope.text;},set:function(v){_scope.text=v;}});prop(_scope,"selected",{get:function(){return _scope.getAttr("selected");},set:function(v){if(v)_scope.setAttr("selected","selected");else _scope.removeAttr("selected");}});prop(_scope,"disabled",{get:function(){return _scope.getAttr("disabled");},set:function(v){if(v)_scope.setAttr("disabled","disabled");else _scope.removeAttr("disabled");}});});};ASJS.DropDown=function(){return createClass(this,ASJS.FormElement,null,function(_scope,_super){var _select=new ASJS.Sprite("select");_scope.new=function(){_scope.setCSS("overflow","hidden");_scope.addChild(_select);};prop(_scope,"select",{get:function(){return _select;}});prop(_scope,"enabled",{set:function(v){_super.enabled=_select.enabled=v;_scope.render();}});prop(_scope,"name",{get:function(){return _select.getAttr("name");},set:function(v){_select.setAttr("name",v);}});prop(_scope,"val",{get:function(){return _select.el.value;},set:function(v){_select.el.value=v;}});_scope.clearOptions=function(){_select.html="";};_scope.setOptions=function(options){_scope.clearOptions();var i=-1;var l=options.length;while(++i<l)_scope.addOption(options[i]);};_scope.addOption=function(option){_select.addChild(option);};_scope.render=function(){_select.setSize(_scope.width+30,_scope.height);}});};ASJS.FileSelector=function(){return createClass(this,ASJS.FormElement,null,function(_scope,_super){_scope._fileInput=new ASJS.DisplayObject("input");var _preview=new ASJS.Sprite();_scope.new=function(){_scope._fileInput.setAttr("type","file");_scope._fileInput.addEventListener(ASJS.Event.CHANGE,_scope._onChange);_scope._fileInput.visible=false;_scope.addChild(_scope._fileInput);_preview.setSize("100%","100%");_preview.move(0,0);_scope.addChild(_preview);_scope.addEventListener(ASJS.MouseEvent.CLICK,onClick);};prop(_scope,"preview",{get:function(){return _preview;}});prop(_scope,"val",{get:function(){return _scope._fileInput.el.value;}});prop(_scope,"fileInput",{get:function(){return _fileInput;}});prop(_scope,"enabled",{set:function(v){_super.enabled=_scope._fileInput.enabled=v;_scope.render();}});prop(_scope,"name",{get:function(){return _scope._fileInput.getAttr("name");},set:function(v){_scope._fileInput.setAttr("name",v);}});_scope._onChange=function(){_preview.text=_scope.val;_scope.dispatchEvent(ASJS.FileSelector.ON_CHANGE);};function onClick(e){if(e.target==_scope._fileInput.el)return;_scope._fileInput.el.click();}});};cnst(ASJS.FileSelector,"ON_CHANGE","ASJS-FileSelector-onChange");ASJS.Form=function(){return createClass(this,ASJS.Sprite,["form"],function(_scope,_super){prop(_scope,"action",{get:function(){return _scope.getAttr("action");},set:function(v){_scope.setAttr("action",v);}});prop(_scope,"method",{get:function(){return _scope.getAttr("method");},set:function(v){_scope.setAttr("method",v);}});prop(_scope,"enctype",{get:function(){return _scope.getAttr("enctype");},set:function(v){_scope.setAttr("enctype",v);}});_scope.reset=function(){_scope.el.reset();};_scope.submit=function(){_scope.el.submit();}});};cnst(ASJS.Form,"ENCTYPE_MULTIPART","multipart/form-data");ASJS.ImageSelector=function(){return createClass(this,ASJS.FileSelector,null,function(_scope,_super){var _reader=new FileReader();_scope.new=function(){_reader.onload=readerOnLoad;};_scope._onChange=function(){var target=_scope._fileInput.el;if(target.files&&target.files[0]){_scope.dispatchEvent(ASJS.ImageSelector.ON_CHANGE_START);_reader.readAsDataURL(target.files[0]);}};function readerOnLoad(e){_scope.preview.setCSS('background-image','url('+e.target.result+')');_scope.dispatchEvent(ASJS.FileSelector.ON_CHANGE);}});};cnst(ASJS.ImageSelector,"ON_CHANGE_START","ASJS-ImageSelector-onChangeStart");ASJS.TextArea=function(){return createClass(this,ASJS.AbstractTextElement,["textarea"]);};ASJS.TextInput=function(){return createClass(this,ASJS.AbstractTextElement,["input"],function(_scope,_super){_scope.new=function(){_scope.type=ASJS.TextInput.TYPE_TEXT;};prop(_scope,"type",{get:function(){return _scope.getAttr("type");},set:function(v){_scope.setAttr("type",v);}});});};cnst(ASJS.TextInput,"TYPE_TEXT","text");cnst(ASJS.TextInput,"TYPE_PASSWORD","password");cnst(ASJS.TextInput,"TYPE_EMAIL","email");cnst(ASJS.TextInput,"TYPE_NUMBER","number");ASJS.RadioButton=function(){return createClass(this,ASJS.FormElement,["label"],function(_scope,_super){var _radio=new ASJS.DisplayObject("input");var _label=new ASJS.DisplayObject();_scope.new=function(){_radio.setAttr("type","radio");_radio.visible=false;_scope.addChild(_radio);_label.setSize("100%","100%");_label.enabled=false;_scope.addChild(_label);};prop(_scope,"radio",{get:function(){return _radio;}});prop(_scope,"enabled",{set:function(v){_super.enabled=_radio.enabled=v;_scope.render();}});prop(_scope,"name",{get:function(){return _radio.getAttr("name");},set:function(v){_radio.setAttr("name",v);}});prop(_scope,"checked",{get:function(){return _radio.el.checked;},set:function(v){_radio.el.checked=v;if(v)_radio.el.change();}});prop(_scope,"val",{get:function(){return _radio.value;},set:function(v){_radio.value=v;}});_scope.render=function(){};});};ASJS.AbstractFilter=function(){return createClass(this,Object,null,function(_scope,_super){_scope.execute=function(){}});};ASJS.ContrastFilter=function(value){return createClass(this,ASJS.AbstractFilter,null,function(_scope,_super){_scope.execute=function(){return"contrast("+value+"%)";}});};ASJS.InvertFilter=function(value){return createClass(this,ASJS.AbstractFilter,null,function(_scope,_super){_scope.execute=function(){return"invert("+value+"%)";}});};ASJS.BlurFilter=function(value){return createClass(this,ASJS.AbstractFilter,null,function(_scope,_super){_scope.execute=function(){return"blur("+value+"px)";}});};ASJS.GrayscaleFilter=function(value){return createClass(this,ASJS.AbstractFilter,null,function(_scope,_super){_scope.execute=function(){return"grayscale("+value+"%)";}});};ASJS.SaturateFilter=function(value){return createClass(this,ASJS.AbstractFilter,null,function(_scope,_super){_scope.execute=function(){return"saturate("+value+"%)";}});};ASJS.BrightnessFilter=function(value){return createClass(this,ASJS.AbstractFilter,null,function(_scope,_super){_scope.execute=function(){return"brightness("+value+"%)";}});};ASJS.HueRotateFilter=function(value){return createClass(this,ASJS.AbstractFilter,null,function(_scope,_super){_scope.execute=function(){return"hue-rotate("+value+"deg)";}});};ASJS.SepiaFilter=function(value){return createClass(this,ASJS.AbstractFilter,null,function(_scope,_super){_scope.execute=function(){return"sepia("+value+"%)";}});};ASJS.DropShadowFilter=function(h,v,blur,spread,color){return createClass(this,ASJS.AbstractFilter,null,function(_scope,_super){_scope.execute=function(){return"drop-shadow("+h+"px "+v+"px "+blur+"px "+spread+"px "+color+")";}});};ASJS.NotificationHandler=function(){return createSingletonClass(ASJS.NotificationHandler,this,Object,null,function(_scope,_super){var _handlers={};_scope.register=function(dispatcher){if(!dispatcher||!dispatcher._handlers)return;var i=-1;var l=dispatcher._handlers.length;while(++i<l){var type=dispatcher._handlers[i];if(_handlers[type]&&_handlers[type].indexOf(dispatcher)>-1)break;if(!_handlers[type])_handlers[type]=[];_handlers[type].push(dispatcher);}};_scope.remove=function(dispatcher){if(!dispatcher._handlers)return;var i=-1;var l=dispatcher._handlers.length;while(++i<l){var type=dispatcher._handlers[i];if(_handlers[type]){var index=_handlers[type].indexOf(dispatcher);if(index>-1)_handlers[type].splice(index,1);}}};_scope.sendNotification=function(type,data){if(!_handlers[type])return;var i=-1;var l=_handlers[type].length;while(++i<l){if(_handlers[type][i]){_handlers[type][i].reciveNotification(type,data);}else{_handlers[type].splice(i,1);l--;}}}});};ASJS.NotificationDispatcher=function(){return createClass(this,Object,null,function(_scope,_super){_scope._handlers=[];var _nHandler=new ASJS.NotificationHandler();_scope.new=function(){registerHandlers();};_scope.destruct=function(){removeHandlers();};_scope.sendNotification=function(type,data){_nHandler.sendNotification(type,data);};_scope.reciveNotification=function(type,data){};function registerHandlers(){_nHandler.register(_scope);};function removeHandlers(){_nHandler.remove(_scope);}});};ASJS.AbstractCommand=function(){return createClass(this,ASJS.NotificationDispatcher,null,function(_scope,_super){_scope.execute=function(){}});};ASJS.AbstractMediator=function(view){return createClass(this,ASJS.NotificationDispatcher,null,function(_scope,_super){_scope._view=view;});};ASJS.AbstractModel=function(){return createClass(this,ASJS.EventDispatcher,null,function(_scope,_super){var priv={};cnst(priv,"PREFIX","ASJS-AbstractModel-");var _data={};prop(_scope,"data",{get:function(){return _data;},set:function(v){_data=v;_scope.dispatchEvent(ASJS.AbstractModel.CHANGED);}});_scope.get=function(k){return _data&&_data[k]?_data[k]:null;};_scope.set=function(k,v){if(!_data)_data={};var o=_data[k];_data[k]=v;_scope.dispatchEvent(ASJS.AbstractModel.CHANGED);_scope.dispatchEvent(priv.PREFIX+k,[o,v]);};_scope.clear=function(){_data=null;_scope.dispatchEvent(ASJS.AbstractModel.CLEARED);};_scope.watch=function(k,l){_scope.addEventListener(priv.PREFIX+k,l);};_scope.merge=function(d){merge(_data,d);};function merge(oData,nData){for(var nk in nData){if(typeof oData[nk]=="object")merge(oData[nk],nData[nk]);else oData[nk]=nData[nk];}}});};cnst(ASJS.AbstractModel,"CHANGED","ASJS-AbstractModel-changed");cnst(ASJS.AbstractModel,"CLEARED","ASJS-AbstractModel-cleared");