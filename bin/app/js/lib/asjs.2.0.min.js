;(function(){var _vendors=['ms','moz','webkit','o'];function checkCustomEvent(){if(typeof window.CustomEvent==="function")return false;trace("window.CustomEvent is not supported, but replaceable");function CustomEvent(evt,p){p=p||{bubbles:false,cancelable:false,detail:undefined};var e=document.createEvent('CustomEvent');e.initCustomEvent(evt,p.bubbles,p.cancelable,p.detail);return e;};CustomEvent.prototype=window.Event.prototype;window.CustomEvent=CustomEvent;};function checkAnimationFrame(){var lastTime=0;for(var x=0;x<_vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[_vendors[x]+'RequestAnimationFrame'];window.cancelAnimationFrame=window[_vendors[x]+'CancelAnimationFrame']||window[_vendors[x]+'CancelRequestAnimationFrame'];};if(!window.requestAnimationFrame){trace("window.requestAnimationFrame is not supported, but replaceable");window.requestAnimationFrame=function(callback,element){var currTime=new Date().getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall);},timeToCall);lastTime=currTime+timeToCall;return id;};};if(!window.cancelAnimationFrame){trace("window.cancelAnimationFrame is not supported, but replaceable");window.cancelAnimationFrame=function(id){clearTimeout(id);};}};function checkNavigator(){if(!window.navigator)window.navigator=navigator;if(!window.navigator)trace("window.navigator is not supported!");};function checkAudioContext(){if(!window.AudioContext)window.AudioContext=window.webkitAudioContext;if(!window.AudioContext)trace("window.AudioContext is not supported!");};function checkUserMedia(){for(var x=0;x<_vendors.length&&!window.navigator.getUserMedia;++x){window.navigator.getUserMedia=window.navigator[_vendors[x]+'GetUserMedia'];};if(!window.navigator.getUserMedia)trace("window.navigator.getUserMedia is not supported!");};function checkURL(){if(!window.URL)window.URL=window.webkitURL;if(!window.URL)trace("window.URL is not supported!");};function checkFullscreenEnabled(){var pollute=true,doc=document,api,vendor,apis={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},webkit:{enabled:"webkitFullscreenEnabled",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},moz:{enabled:"mozFullScreenEnabled",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}}},w3=apis.w3;for(vendor in apis){if(apis[vendor].enabled in doc){api=apis[vendor];break;}};function dispatch(type,target){var event=doc.createEvent("Event");event.initEvent(type,true,false);target.dispatchEvent(event);};function handleChange(e){e.stopPropagation();e.stopImmediatePropagation();doc[w3.enabled]=doc[api.enabled];doc[w3.element]=doc[api.element];};function handleError(e){};function createResolver(method){return function resolver(resolve,reject){if(method===w3.exit&&!doc[api.element]){setTimeout(function(){reject(new TypeError());},1);return;};function change(){resolve();doc.removeEventListener(api.events.change,change,false);};function error(){reject(new TypeError());doc.removeEventListener(api.events.error,error,false);};doc.addEventListener(api.events.change,change,false);doc.addEventListener(api.events.error,error,false);};};if(pollute&&!(w3.enabled in doc)&&api){doc.addEventListener(api.events.change,handleChange,false);doc.addEventListener(api.events.error,handleError,false);doc[w3.enabled]=doc[api.enabled];doc[w3.element]=doc[api.element];doc[w3.exit]=function(){var result=doc[api.exit]();return!result&&window.Promise?new Promise(createResolver(w3.exit)):result;};Element.prototype[w3.request]=function(){var result=this[api.request].apply(this,arguments);return!result&&window.Promise?new Promise(createResolver(w3.request)):result;};}};checkCustomEvent();checkAnimationFrame();checkNavigator();checkAudioContext();checkUserMedia();checkURL();checkFullscreenEnabled();})();"use strict";function trace(){console.log(arguments);};function prop(t,pn,p){p.enumerable=true;p.configurable=true;Object.defineProperty(t,pn,p);};function cnst(t,pn,v){prop(t,pn,{get:function(){return v;}});};function roFunc(t,pn,f){cnst(t,pn,f);};function createClass(t,p,oa,b){function bc(t,p,a,oa,b){function bca(t,s,a,f){if(!t.$c)t.$c=[];if(t.$c.indexOf(f)==-1)t.$c.push(f);if(a.callee.caller==null||a.callee.caller.name!="bcb"){while(t.$c.length>0){var fnc=t.$c.shift();if(typeof fnc=="function")fnc.call(t);};t.$c=null;t.new=null;delete t.$c;delete t.new;};return t;};function bcb(t,p,a,oa){(p||Object).apply(t,oa||a);var s={};for(var k in t){if(k!="$c"&&k!="new"){if(Object.getOwnPropertyDescriptor(t,k).writable)s[k]=t[k];else prop(s,k,Object.getOwnPropertyDescriptor(t,k));}};return s;};var s=bcb(t,p,a,oa);if(typeof b=="function")b(t,s);return bca(t,s,a,t.new);};var h=arguments.callee.caller;var a=h&&h.name=="createSingletonClass"?h.arguments.callee.caller.arguments:h.arguments;return bc(t,p,a,oa,b);};function createSingletonClass(o,t,p,oa,b){var a=arguments.callee.caller.arguments.callee.caller;if(a&&a.name=="createClass")return createClass(t,p,oa,b);return o.$i||(o.$i=createClass(t,p,oa,b));};function sourcePath(v){if(ASJS.sourcePath=="")ASJS.sourcePath=v;};function includeOnce(f){if(ASJS.includedScript[f])return;ASJS.includedScript[f]=1;var script=ASJS.Tag("script");script.setAttr("type","text/javascript");script.setAttr("src",ASJS.sourcePath+f);(new ASJS.Head()).addChild(script);};var stage;var ASJS={sourcePath:"",includedScript:{},inited:false,start:function(b){if(ASJS.inited)return;ASJS.inited=true;window.onload=function(){stage=new ASJS.Stage();stage.init();new b();};}};ASJS.Point=function(x,y){return createClass(this,Object,null,function(scp,spr){scp.x=x||0;scp.y=y||0;});};ASJS.Rectangle=function(x,y,width,height){return createClass(this,ASJS.Point,null,function(scp,spr){scp.width=width||0;scp.height=height||0;});};ASJS.Matrix=function(a,b,c,d,e,f){return createClass(this,Object,null,function(scp,spr){scp.a=a||1;scp.b=b||0;scp.c=c||0;scp.d=d||1;scp.e=e||0;scp.f=f||0;scp.translate=function(tx,ty){matrix.e=tx;matrix.f=ty;};scp.skew=function(sx,sy){matrix.b=sx;matrix.c=sy;};scp.scale=function(sw,sh){matrix.a=sw;matrix.d=sh;}});};ASJS.GeomUtils={};cnst(ASJS.GeomUtils,"THETA",Math.PI/180);roFunc(ASJS.GeomUtils,"pointInOrigo",function(point){return point.x==0&&point.y==0;});roFunc(ASJS.GeomUtils,"twoPointDistance",function(pointA,pointB){return Math.sqrt(Math.pow(pointB.x-pointA.x,2)+Math.pow(pointB.y-pointA.y,2));});roFunc(ASJS.GeomUtils,"pointInRect",function(point,rect){return point.x>=rect.x&&point.x<=rect.x+rect.width&&point.y>=rect.y&&point.y<=rect.y+rect.height;});roFunc(ASJS.GeomUtils,"twoPointEquals",function(pointA,pointB){return pointA.x==pointB.x&&pointA.y==pointB.y;});roFunc(ASJS.GeomUtils,"twoPointAngle",function(pointA,pointB){var v=new ASJS.Point(pointB.x-pointA.x,pointB.y-pointA.y);var angle=Math.acos(v.x/Math.sqrt(Math.pow(v.x,2)+Math.pow(v.y,2)));return angle/ASJS.GeomUtils.THETA;});roFunc(ASJS.GeomUtils,"rectInRect",function(rectA,rectB){return rectA.x>=rectB.x&&rectA.y==rectB.y&&rectA.x+rectA.width<=rectB.x+rectB.width&&rectA.y+rectA.height<=rectB.y+rectB.height;});roFunc(ASJS.GeomUtils,"localToGlobal",function(target,point){var pos=new ASJS.Point(point.x,point.y);var child=target;while(child){pos.x*=child.scaleX;pos.y*=child.scaleY;pos.x+=child.x;pos.y+=child.y;child=child.parent;};return pos;});roFunc(ASJS.GeomUtils,"globalToLocal",function(target,point){var pos=new ASJS.Point(point.x,point.y);var child=target;var children=[child];while(child){child=child.parent;children.unshift(child);};var i=0;var l=children.length;while(++i<l){child=children[i];pos.x-=child.x;pos.y-=child.y;pos.x/=child.scaleX;pos.y/=child.scaleY;};return pos;});roFunc(ASJS.GeomUtils,"hitTest",function(target,point){var rotationDeg=-target.rotation*ASJS.GeomUtils.THETA;var rect=target.bounds;var globalPos=target.localToGlobal(new ASJS.Point(0,0));var diffPoint=new ASJS.Point(point.x-(globalPos.x+rect.width*0.5),point.y-(globalPos.y+rect.height*0.5));var rotatedDiffPoint=new ASJS.Point(diffPoint.x*Math.cos(rotationDeg)-diffPoint.y*Math.sin(rotationDeg),diffPoint.x*Math.sin(rotationDeg)+diffPoint.y*Math.cos(rotationDeg));var recalcPoint=new ASJS.Point(point.x-(diffPoint.x-rotatedDiffPoint.x),point.y-(diffPoint.y-rotatedDiffPoint.y));var localPoint=target.globalToLocal(recalcPoint);return localPoint.x>=0&&localPoint.y>=0&&localPoint.x<=rect.width&&localPoint.y<=rect.height;});ASJS.EventDispatcher=function(){return createClass(this,Object,null,function(scp,spr){var _handlers={};scp.dispatchEvent=function(event,data,bubble){var e;if(typeof event=="string"){e=new CustomEvent(event,{bubbles:bubble==undefined?true:bubble,cancelable:true,detail:data});}else e=event;var t=e.type||event;if(!scp.hasEventListener(t))return;var handlers=_handlers[t];var i=-1;var l=handlers.length;while(++i<l)handlers[i](e);};scp.addEventListener=function(type,handler){var types=type.split(" ");while(types.length>0){var t=types.shift();if(t!=""){if(scp.hasEventListener(t,handler))return;if(!_handlers[t])_handlers[t]=[];_handlers[t].push(handler);}}};scp.removeEventListeners=function(){_handlers={};};scp.removeEventListener=function(type,handler){if(!scp.hasEventListener(type,handler))return;_handlers[type].slice(_handlers[type].indexOf(handler),1);};scp.hasEventListener=function(type,handler){var handlers=_handlers[type];if(handlers){if(!handler)return true;var i=-1;var l=handlers.length;while(++i<l){if(handlers[i]==handler)return true;}};return false;};});};ASJS.Event={};cnst(ASJS.Event,"CHANGE","change");ASJS.MouseEvent={};cnst(ASJS.MouseEvent,"SCROLL","DOMMouseScroll mousewheel scroll");cnst(ASJS.MouseEvent,"CLICK","click");cnst(ASJS.MouseEvent,"DOUBLE_CLICK","dblclick");cnst(ASJS.MouseEvent,"MOUSE_DOWN","mousedown");cnst(ASJS.MouseEvent,"MOUSE_UP","mouseup");cnst(ASJS.MouseEvent,"MOUSE_LEAVE","mouseleave");cnst(ASJS.MouseEvent,"MOUSE_ENTER","mouseenter");cnst(ASJS.MouseEvent,"MOUSE_MOVE","mousemove");cnst(ASJS.MouseEvent,"MOUSE_OVER","mouseover");cnst(ASJS.MouseEvent,"MOUSE_OUT","mouseout");cnst(ASJS.MouseEvent,"TOUCH_START","touchstart");cnst(ASJS.MouseEvent,"TOUCH_END","touchend");cnst(ASJS.MouseEvent,"TOUCH_MOVE","touchmove");cnst(ASJS.MouseEvent,"TOUCH_CANCEL","touchcancel");cnst(ASJS.MouseEvent,"CONTEXT_MENU","contextmenu");cnst(ASJS.MouseEvent,"SELECT_START","onselectstart");ASJS.KeyboardEvent={};cnst(ASJS.KeyboardEvent,"KEY_UP","keyup");cnst(ASJS.KeyboardEvent,"KEY_DOWN","keydown");cnst(ASJS.KeyboardEvent,"KEY_PRESS","keypress");ASJS.FocusEvent={};cnst(ASJS.FocusEvent,"FOCUS","focus");cnst(ASJS.FocusEvent,"BLUR","blur");ASJS.MediaEvent={};cnst(ASJS.MediaEvent,"ABORT","abort");cnst(ASJS.MediaEvent,"CAN_PLAY","canplay");cnst(ASJS.MediaEvent,"CAN_PLAY_THROUGH","canplaythrough");cnst(ASJS.MediaEvent,"DURATION_CHANGE","durationchange");cnst(ASJS.MediaEvent,"EMPTIED","emptied");cnst(ASJS.MediaEvent,"ENDED","ended");cnst(ASJS.MediaEvent,"ERROR","error");cnst(ASJS.MediaEvent,"LOADED_DATA","loadeddata");cnst(ASJS.MediaEvent,"LOADED_META_DATA","loadedmetadata");cnst(ASJS.MediaEvent,"LOAD_START","loadstart");cnst(ASJS.MediaEvent,"PAUSE","pause");cnst(ASJS.MediaEvent,"PLAY","play");cnst(ASJS.MediaEvent,"PLAYING","playing");cnst(ASJS.MediaEvent,"PROGRESS","progress");cnst(ASJS.MediaEvent,"RATE_CHANGE","ratechange");cnst(ASJS.MediaEvent,"SEEKED","seeked");cnst(ASJS.MediaEvent,"SEEKING","seeking");cnst(ASJS.MediaEvent,"STALLED","stalled");cnst(ASJS.MediaEvent,"SUSPEND","suspend");cnst(ASJS.MediaEvent,"TIME_UPDATE","timeupdate");cnst(ASJS.MediaEvent,"VOLUME_CHANGE","volumechange");cnst(ASJS.MediaEvent,"WAITING","waiting");ASJS.LoaderEvent={};cnst(ASJS.LoaderEvent,"ERROR","error");cnst(ASJS.LoaderEvent,"ABORT","abort");cnst(ASJS.LoaderEvent,"LOAD_START","loadstart");cnst(ASJS.LoaderEvent,"PROGRESS","progress");cnst(ASJS.LoaderEvent,"LOAD","load");cnst(ASJS.LoaderEvent,"LOAD_END","loadend");cnst(ASJS.LoaderEvent,"TIMEOUT","timeout");cnst(ASJS.LoaderEvent,"READY_STATE_CHANGE","readystatechange");ASJS.WindowEvent={};cnst(ASJS.WindowEvent,"POPSTATE","popstate");cnst(ASJS.WindowEvent,"RESIZE","resize");cnst(ASJS.WindowEvent,"ONLINE","online");cnst(ASJS.WindowEvent,"OFFLINE","offline");cnst(ASJS.WindowEvent,"MESSAGE","message");ASJS.Window=function(){return createSingletonClass(ASJS.Window,this,ASJS.EventDispatcher,null,function(scp,spr){var _el=window;var _browserStatus;scp.new=function(){for(var key in _el){if(key.search('on')===0)_el.addEventListener(key.slice(2),function(e){scp.dispatchEvent(e);});};_browserStatus=scp.navigator.onLine?ASJS.WindowEvent.ONLINE:ASJS.WindowEvent.OFFLINE;scp.addEventListener(ASJS.WindowEvent.ONLINE+" "+ASJS.WindowEvent.OFFLINE,function(e){_browserStatus=e.type;});};prop(scp,"el",{get:function(){return _el;}});prop(scp,"isOnline",{get:function(){return _browserStatus==ASJS.WindowEvent.ONLINE;}});prop(scp,"width",{get:function(){return scp.el.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;}});prop(scp,"height",{get:function(){return scp.el.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;}});prop(scp,"screen",{get:function(){return scp.el.screen;}});prop(scp,"screenTop",{get:function(){return scp.screen.availTop;}});prop(scp,"screenLeft",{get:function(){return scp.screen.availLeft;}});prop(scp,"screenWidth",{get:function(){return scp.screen.width;}});prop(scp,"screenHeight",{get:function(){return scp.screen.height;}});prop(scp,"screenAvailWidth",{get:function(){return scp.screen.availWidth;}});prop(scp,"screenAvailHeight",{get:function(){return scp.screen.availHeight;}});prop(scp,"url",{get:function(){return scp.el.URL;}});prop(scp,"navigator",{get:function(){return scp.el.navigator;}});prop(scp,"audioContext",{get:function(){return scp.el.AudioContext;}});prop(scp,"userMedia",{get:function(){return scp.navigator.getUserMedia;}});prop(scp,"devicePixelRatio",{get:function(){return scp.el.devicePixelRatio;}});prop(scp,"scrollTop",{get:function(){return(scp.el.pageYOffset!=undefined?scp.el.pageYOffset:document.scrollTop)-(document.clientTop||0);},set:function(v){scp.el.scrollTo(scp.scrollLeft,v);}});prop(scp,"scrollLeft",{get:function(){return(scp.el.pageXOffset!=undefined?scp.el.pageXOffset:document.scrollLeft)-(document.clientLeft||0);},set:function(v){scp.el.scrollTo(v,scp.scrollTop);}});prop(scp,"location",{get:function(){return scp.el.location;},set:function(v){scp.el.location=v;}});scp.setTimeout=function(callback,duration){return scp.el.setTimeout(function(){scp.requestAnimationFrame(callback);},duration);};scp.clearTimeout=function(id){return scp.el.clearTimeout(id);};scp.setInterval=function(callback,duration){return scp.el.setInterval(function(){scp.requestAnimationFrame(callback);},duration);};scp.clearInterval=function(id){return scp.el.clearInterval(id);};scp.requestAnimationFrame=function(callback){return scp.el.requestAnimationFrame(callback);};scp.cancelAnimationFrame=function(id){scp.el.cancelAnimationFrame(id);}});};ASJS.Keyboard=function(){return createClass(this,Object,null,function(scp,spr){var _window=new ASJS.Window();var _pressedKeys={};var _downCallback;var _upCallback;scp.isPressed=function(w){return _pressedKeys[w];};scp.addKeyListener=function(target,downCallback,upCallback){if(!target)return;_downCallback=downCallback;_upCallback=upCallback;scp.removeKeyListener(target);target.addEventListener(ASJS.KeyboardEvent.KEY_DOWN,onKeyDown);target.addEventListener(ASJS.KeyboardEvent.KEY_UP,onKeyUp);_window.addEventListener(ASJS.FocusEvent.BLUR,onBlur);};scp.removeKeyListener=function(target){target.removeEventListener(ASJS.KeyboardEvent.KEY_DOWN,onKeyDown);target.removeEventListener(ASJS.KeyboardEvent.KEY_UP,onKeyUp);_window.removeEventListener(ASJS.FocusEvent.BLUR,onBlur);};function onBlur(){for(var k in _pressedKeys)_pressedKeys[k]=false;};function onKeyDown(e){_pressedKeys[e.which]=true;if(_downCallback)_downCallback();};function onKeyUp(e){_pressedKeys[e.which]=false;if(_upCallback)_upCallback();};});};cnst(ASJS.Keyboard,"SPACE",32);cnst(ASJS.Keyboard,"BACKSPACE",8);cnst(ASJS.Keyboard,"TAB",9);cnst(ASJS.Keyboard,"ENTER",13);cnst(ASJS.Keyboard,"SHIFT",16);cnst(ASJS.Keyboard,"CTRL",17);cnst(ASJS.Keyboard,"ALT",18);cnst(ASJS.Keyboard,"PAUSE_BREAK",19);cnst(ASJS.Keyboard,"CAPS_LOCK",20);cnst(ASJS.Keyboard,"ESCAPE",27);cnst(ASJS.Keyboard,"PAGE_UP",33);cnst(ASJS.Keyboard,"PAGE_DOWN",34);cnst(ASJS.Keyboard,"END",35);cnst(ASJS.Keyboard,"HOME",36);cnst(ASJS.Keyboard,"LEFT_ARROW",37);cnst(ASJS.Keyboard,"UP_ARROW",38);cnst(ASJS.Keyboard,"RIGHT_ARROW",39);cnst(ASJS.Keyboard,"DOWN_ARROW",40);cnst(ASJS.Keyboard,"INSERT",45);cnst(ASJS.Keyboard,"DELETE",46);cnst(ASJS.Keyboard,"NUM_0",48);cnst(ASJS.Keyboard,"NUM_1",49);cnst(ASJS.Keyboard,"NUM_2",50);cnst(ASJS.Keyboard,"NUM_3",51);cnst(ASJS.Keyboard,"NUM_4",52);cnst(ASJS.Keyboard,"NUM_5",53);cnst(ASJS.Keyboard,"NUM_6",54);cnst(ASJS.Keyboard,"NUM_7",55);cnst(ASJS.Keyboard,"NUM_8",56);cnst(ASJS.Keyboard,"NUM_9",57);cnst(ASJS.Keyboard,"A",65);cnst(ASJS.Keyboard,"B",66);cnst(ASJS.Keyboard,"C",67);cnst(ASJS.Keyboard,"D",68);cnst(ASJS.Keyboard,"E",69);cnst(ASJS.Keyboard,"F",70);cnst(ASJS.Keyboard,"G",71);cnst(ASJS.Keyboard,"H",72);cnst(ASJS.Keyboard,"I",73);cnst(ASJS.Keyboard,"J",74);cnst(ASJS.Keyboard,"K",75);cnst(ASJS.Keyboard,"L",76);cnst(ASJS.Keyboard,"M",77);cnst(ASJS.Keyboard,"N",78);cnst(ASJS.Keyboard,"O",79);cnst(ASJS.Keyboard,"P",80);cnst(ASJS.Keyboard,"Q",81);cnst(ASJS.Keyboard,"R",82);cnst(ASJS.Keyboard,"S",83);cnst(ASJS.Keyboard,"T",84);cnst(ASJS.Keyboard,"U",85);cnst(ASJS.Keyboard,"V",86);cnst(ASJS.Keyboard,"W",87);cnst(ASJS.Keyboard,"X",88);cnst(ASJS.Keyboard,"Y",89);cnst(ASJS.Keyboard,"Z",90);cnst(ASJS.Keyboard,"LEFT_WINDOW_KEY",91);cnst(ASJS.Keyboard,"RIGHT_WINDOW_KEY",92);cnst(ASJS.Keyboard,"SELECT_KEY",93);cnst(ASJS.Keyboard,"NUMPAD_0",96);cnst(ASJS.Keyboard,"NUMPAD_1",97);cnst(ASJS.Keyboard,"NUMPAD_2",98);cnst(ASJS.Keyboard,"NUMPAD_3",99);cnst(ASJS.Keyboard,"NUMPAD_4",100);cnst(ASJS.Keyboard,"NUMPAD_5",101);cnst(ASJS.Keyboard,"NUMPAD_6",102);cnst(ASJS.Keyboard,"NUMPAD_7",103);cnst(ASJS.Keyboard,"NUMPAD_8",104);cnst(ASJS.Keyboard,"NUMPAD_9",105);cnst(ASJS.Keyboard,"MULTIPLY",106);cnst(ASJS.Keyboard,"ADD",107);cnst(ASJS.Keyboard,"SUBTRACT",109);cnst(ASJS.Keyboard,"DECIMAL_POINT",110);cnst(ASJS.Keyboard,"DIVIDE",111);cnst(ASJS.Keyboard,"F1",112);cnst(ASJS.Keyboard,"F2",113);cnst(ASJS.Keyboard,"F3",114);cnst(ASJS.Keyboard,"F4",115);cnst(ASJS.Keyboard,"F5",116);cnst(ASJS.Keyboard,"F6",117);cnst(ASJS.Keyboard,"F7",118);cnst(ASJS.Keyboard,"F8",119);cnst(ASJS.Keyboard,"F9",120);cnst(ASJS.Keyboard,"F10",121);cnst(ASJS.Keyboard,"F11",122);cnst(ASJS.Keyboard,"F12",123);cnst(ASJS.Keyboard,"NUM_LOCK",144);cnst(ASJS.Keyboard,"SCROLL_LOCK",145);cnst(ASJS.Keyboard,"SEMICOLON",186);cnst(ASJS.Keyboard,"EQUAL_SIGN",187);cnst(ASJS.Keyboard,"COMMA",188);cnst(ASJS.Keyboard,"DASH",189);cnst(ASJS.Keyboard,"PERIOD",190);cnst(ASJS.Keyboard,"FORWARD_SLASH",191);cnst(ASJS.Keyboard,"GRAVE_ACCENT",192);cnst(ASJS.Keyboard,"OPEN_BRACKET",219);cnst(ASJS.Keyboard,"BACK_SLASH",220);cnst(ASJS.Keyboard,"CLOSE_BRAKET",221);cnst(ASJS.Keyboard,"SINGLE_QUOTE",222);ASJS.Mouse=function(){return createSingletonClass(ASJS.Mouse,this,Object,null,function(scp,spr){var priv={};cnst(priv,"EVENT",ASJS.MouseEvent.MOUSE_MOVE+" "+ASJS.MouseEvent.TOUCH_MOVE);var _window=new ASJS.Window();var _mousePos=new ASJS.Point();prop(scp,"mouseX",{get:function(){return _mousePos.x;}});prop(scp,"mouseY",{get:function(){return _mousePos.y;}});scp.show=function(){stage.setCSS("cursor","default");};scp.hide=function(){stage.setCSS("cursor","none");};scp.getRelativePosition=function(target){return target.globalToLocal(_mousePos);};scp.init=function(){if(stage)_window.addEventListener(priv.EVENT,onMouseMove);};scp.getTouchPointByEvent=function(e){var iosTouchEvent=e.touches;var androidTouchEvent=(e.originalEvent?e.originalEvent.touches:null);var touches=iosTouchEvent||androidTouchEvent;if(touches&&touches.length>0){var touch=touches[0];return new ASJS.Point(touch.pageX,touch.pageY);};return new ASJS.Point(e.pageX,e.pageY);};function onMouseMove(e){_mousePos=scp.getTouchPointByEvent(e);};});};ASJS.Cycler=function(){return createSingletonClass(ASJS.Cycler,this,Object,null,function(scp,spr){var _window=new ASJS.Window();var _isPlaying=false;var _fps=24;var _interval=getIntervalByFps();var _callbacks=[];var _timeoutId;prop(scp,"isPlaying",{get:function(){return _isPlaying;}});prop(scp,"fps",{get:function(){return _fps;},set:function(v){_fps=v;_interval=getIntervalByFps();scp.start();}});scp.addCallback=function(callback){if(!scp.callbackExists(callback))_callbacks.push(callback);};scp.removeCallback=function(callback){if(!scp.callbackExists(callback))return;var i=-1;var l=_callbacks.length;var index;while(++i<l){if(_callbacks[i]==callback)index=i;};_callbacks.splice(index,1);};scp.callbackExists=function(callback){var i=-1;var l=_callbacks.length;while(++i<l){if(_callbacks[i]==callback)return true;};return false;};scp.start=function(){_isPlaying=true;tick();};scp.stop=function(){_isPlaying=false;_timeoutId=_window.clearTimeout(_timeoutId);};function tick(){_timeoutId=_window.clearTimeout(_timeoutId);var i=-1;var l=_callbacks.length;while(++i<l){if(_callbacks[i])_callbacks[i]();};_timeoutId=_window.setTimeout(tick,_interval);};function getIntervalByFps(){return 1000/_fps;};});};ASJS.Head=function(){return createSingletonClass(ASJS.Head,this,Object,null,function(scp,spr){var _children=[];var _el=document.head;prop(scp,"el",{get:function(){return _head;}});prop(scp,"numChildren",{get:function(){return _children.length;}});scp.addChild=function(child){if(!child)return null;if(child.parent)child.parent.removeChild(child);_children.push(child);_el.append(child.el);child.parent=scp;return child;};scp.removeChild=function(child){if(!child)return null;_el.removeChild(child.el);var index=scp.getChildIndex(child);if(index>-1)_children.splice(index,1);child.parent=null;return child;};scp.contains=function(child){return scp.getChildIndex(child)>-1;};scp.getChildIndex=function(child){return!child?-1:_children.indexOf(child);}});};ASJS.Tag=function(tag){return createClass(this,Object,null,function(scp,spr){var priv={};cnst(priv,"CREATED","created");var _el=!tag||typeof tag=="string"?document.createElement(tag||"div"):tag;var _parent=null;var _state=priv.CREATED;var _eventHandlers={};prop(scp,"text",{get:function(){return _el.textContent||_el.innerText;},set:function(v){_el.textContent=v;_el.innerText=v;}});prop(scp,"html",{get:function(){return _el.innerHTML;},set:function(v){_el.innerHTML=v;}});prop(scp,"el",{get:function(){return _el;}});prop(scp,"bounds",{get:function(){return new ASJS.Rectangle();}});prop(scp,"parent",{get:function(){return _parent;},set:function(v){if(v==null||v.getChildIndex(scp)>-1){_parent=v;scp._sendParentChangeEvent();}}});prop(scp,"stage",{get:function(){return scp.parent?scp.parent.stage:null;}});scp.hasClass=function(v){var classList=scp.getClassList();if(classList)return classList.contains(v);return!!_el.className.match(new RegExp('(\\s|^)'+v+'(\\s|$)'));};scp.addClass=function(v){if(!scp.hasClass(v))_el.className+=" "+v;};scp.removeClass=function(v){var classList=scp.getClassList();if(classList)classList.remove(v);else if(scp.hasClass(v))_el.className=_el.className.replace(new RegExp('(\\s|^)'+v+'(\\s|$)'),' ');};scp.getClassList=function(v){return _el.classList;};scp.getAttr=function(k){return _el.getAttribute(k);};scp.setAttr=function(k,v){if(_el.setAttribute)_el.setAttribute(k,v);};scp.removeAttr=function(k){_el.removeAttribute(k);};scp.clear=function(){scp.html="";scp.text="";};scp.dispatchEvent=function(event,data,bubble){try{var e;if(typeof event=="string"){e=new CustomEvent(event,{bubbles:bubble==undefined?true:bubble,cancelable:true,detail:data});}else e=event;scp.el.dispatchEvent(e);}catch(e){}};scp.addEventListener=function(type,callback,capture){var types=type.split(" ");while(types.length>0){var t=types.shift();if(t!=""){if(scp.hasEventListener(t,callback))return;if(!_eventHandlers[t])_eventHandlers[t]=[];_eventHandlers[t].push(callback);scp.el.addEventListener(t,callback,capture);}}};scp.removeEventListeners=function(){for(var type in _eventHandlers){var handlers=_eventHandlers[type];while(handlers.length>0)scp.removeEventListener(type,handlers[0]);}};scp.removeEventListener=function(type,callback){var handlers=_eventHandlers[type];if(!handlers)return;if(callback){var i=handlers.indexOf(callback);if(i==-1)return;handlers.splice(i,1);scp.el.removeEventListener(type,callback);}else{while(handlers.length>0)scp.removeEventListener(type,handlers[0]);};if(handlers.length==0){_eventHandlers[type]=null;delete _eventHandlers[type];}};scp.hasEventListener=function(type,callback){var handlers=_eventHandlers[type];if(!handlers)return false;if(!callback)return true;return handlers.indexOf(callback)>-1;};scp._sendParentChangeEvent=function(){var state=scp.stage?ASJS.Stage.ADDED_TO_STAGE:ASJS.Stage.REMOVED_FROM_STAGE;if(_state!=priv.CREATED||state!=ASJS.Stage.REMOVED_FROM_STAGE)scp.dispatchEvent(state,null,false);_state=state;}});};ASJS.PrimitiveDisplayObject=function(tag){return createClass(this,ASJS.Tag,null,function(scp,spr){var priv={};cnst(priv,"ADD_PIXEL_TYPES",["width","height","top","left"]);scp.new=function(){scp.id="instance_"+(++ASJS.PrimitiveDisplayObject.instanceId);};prop(scp,"id",{get:function(){return scp.getAttr("id");},set:function(v){scp.setAttr("id",v);}});prop(scp,"enabled",{get:function(){return scp.getAttr("disabled")!="disabled";},set:function(v){if(v){scp.removeAttr("disabled");scp.setCSS("pointer-events","auto");}else{scp.setAttr("disabled","disabled");scp.setCSS("pointer-events","none");}}});scp.getCSS=function(k){var style=window.getComputedStyle(scp.el);var v=style.getPropertyValue(k);if(v=="")v=scp.el.style[ASJS.CSS.replaceHyphen(k)];return priv.ADD_PIXEL_TYPES.indexOf(k)>-1?parseFloat(v):v;};scp.setCSS=function(k,v){k=ASJS.CSS.replaceHyphen(k);scp.el.style[k]=priv.ADD_PIXEL_TYPES.indexOf(k)>-1&&typeof v=="number"?v+"px":v;};function getAbsoluteValue(v){return typeof v=="string"&&v.indexOf("%")>-1&&scp.parent?(scp.parent.width/100)*parseFloat(v):v;}});};ASJS.PrimitiveDisplayObject.instanceId=-1;ASJS.CSS=function(){return createSingletonClass(ASJS.CSS,this,Object,null,function(scp,spr){var _window=new ASJS.Window();var _head=new ASJS.Head();var _runTimeStyle;var _merged;scp.new=function(){updateMergedList();};prop(scp,"styles",{get:function(){return _merged;}});scp.getRuleBySelector=function(s){var i=-1;var l=_merged.length;while(++i<l){var rule=_merged[i].rule;if(rule.selectorText==s)return rule;};return null;};scp.getRuleExists=function(s){return scp.getRuleBySelector(s)!=null;};scp.getPropertyFromRule=function(s,t){var r=scp.getRuleBySelector(s);return!r?null:r.style[t];};scp.setPropertyToRule=function(s,t,v){var r=scp.getRuleBySelector(s);if(r){r.style[t]=v;updateMergedList();}};scp.addRule=function(s,t){if(scp.getRuleBySelector(s))return;createRunTimeStyle();_runTimeStyle.el.sheet.insertRule(s+"{"+(t||"")+"}",0);updateMergedList();};scp.removeRule=function(s){var styles=getSheets();var i=-1;var l=_merged.length;while(++i<l){var rule=_merged[i];if(rule.rule.selectorText==s){styles[rule.sheetId].deleteRule(rule.ruleId);updateMergedList();return;}}};function updateMergedList(){var styles=getSheets();var i=-1;var l=styles.length;_merged=[];while(++i<l){var style=styles[i].cssRules;var j=-1;var m=style.length;while(++j<m)_merged.push(new Rule(i,j,style[j]));}};function getSheets(){return document.styleSheets;};function hasRunTimeStyle(){return _runTimeStyle;};function createRunTimeStyle(){if(hasRunTimeStyle())return;_runTimeStyle=new ASJS.Tag("style");_runTimeStyle.setAttr("type","text/css");_head.addChild(_runTimeStyle);};var Rule=function(sheetId,ruleId,rule){return createClass(this,Object,null,function(scp,spr){scp.sheetId=sheetId;scp.ruleId=ruleId;scp.rule=rule;});};});};prop(ASJS.CSS,"styles",{get:function(){return(new ASJS.CSS()).styles;}});roFunc(ASJS.CSS,"getRuleBySelector",function(s){return(new ASJS.CSS()).getRuleBySelector(s);});roFunc(ASJS.CSS,"getRuleExists",function(s){return(new ASJS.CSS()).getRuleExists(s);});roFunc(ASJS.CSS,"getPropertyFromRule",function(s,t){return(new ASJS.CSS()).getPropertyFromRule(s,t);});roFunc(ASJS.CSS,"setPropertyToRule",function(s,t,v){(new ASJS.CSS()).setPropertyToRule(s,t,v);});roFunc(ASJS.CSS,"addRule",function(s,t){(new ASJS.CSS()).addRule(s,t);});roFunc(ASJS.CSS,"removeRule",function(s){(new ASJS.CSS()).removeRule(s);});roFunc(ASJS.CSS,"replaceHyphen",function(s){return s.replace(/-./g,function(v){return v.replace("-","").toUpperCase();});});ASJS.Deferred=function(){return createClass(this,Object,null,function(scp,spr){var _promise=new Promise();var _calledResolve=false;var _calledReject=false;var _resolveData;var _rejectData;scp.new=function(){_promise.addEventListener(Promise.ADD_RESOLVE,callResolve);_promise.addEventListener(Promise.ADD_REJECT,callReject);};prop(scp,"promise",{get:function(){return _promise;}});scp.resolve=function(data){_resolveData=data;_calledResolve=true;callResolve();};scp.reject=function(data){_rejectData=data;_calledReject=true;callReject();};function callResolve(){if(!_calledResolve)return;while(_promise.resolveFunction.length>0)_promise.resolveFunction.shift()(_resolveData);};function callReject(){if(!_calledReject)return;while(_promise.rejectFunction.length>0)_promise.rejectFunction.shift()(_rejectData);};function Promise(){return createClass(this,ASJS.EventDispatcher,null,function(scp,spr){scp.resolveFunction=[];scp.rejectFunction=[];scp.resolve=function(f){if(scp.resolveFunction.indexOf(f)==-1){scp.resolveFunction.push(f);scp.dispatchEvent(Promise.ADD_RESOLVE);};return scp;};scp.reject=function(f){if(scp.rejectFunction.indexOf(f)==-1){scp.rejectFunction=f;scp.dispatchEvent(Promise.ADD_REJECT);};return scp;}});};cnst(Promise,"ADD_RESOLVE","Promise-addResolve");cnst(Promise,"ADD_REJECT","Promise-addReject");});};ASJS.RequestMethod={};cnst(ASJS.RequestMethod,"DELETE","DELETE");cnst(ASJS.RequestMethod,"GET","GET");cnst(ASJS.RequestMethod,"HEAD","HEAD");cnst(ASJS.RequestMethod,"OPTIONS","OPTIONS");cnst(ASJS.RequestMethod,"POST","POST");cnst(ASJS.RequestMethod,"PUT","PUT");ASJS.Loader=function(){return createClass(this,ASJS.EventDispatcher,null,function(scp,spr){var _async=true;var _method=ASJS.RequestMethod.GET;var _headers={};var _responseType="text";var _request;var _username;var _password;var _url;var _data;scp.new=function(){reset();};prop(scp,"url",{get:function(){return _url;}});prop(scp,"content",{get:function(){return _request.response;}});prop(scp,"status",{get:function(){return _request.status;}});prop(scp,"statusText",{get:function(){return _request.statusText;}});prop(scp,"readyState",{get:function(){return _request.readyState;}});prop(scp,"contentType",{set:function(v){_headers["Content-type"]=v;}});prop(scp,"username",{set:function(v){_username=v;}});prop(scp,"password",{set:function(v){_password=v;}});prop(scp,"data",{set:function(v){_data=v;}});prop(scp,"async",{set:function(v){_async=v;}});prop(scp,"method",{set:function(v){_method=v;}});prop(scp,"responseType",{set:function(v){_responseType=v;}});scp.unload=function(){scp.free();};scp.setHeader=function(k,v){_headers[k]=v;};scp.getHeader=function(k){return _request.getRequestHeader(k);};scp.cancel=function(){_request.abort();};scp.load=function(url){if(!url)return;_url=url;_request.open(_method,_url,_async,_username,_password);_request.responseType=_responseType;for(var k in _headers)_request.setRequestHeader(k,_headers[k]);_request.send(_data);};scp.free=function(){reset();};function reset(){_request=null;_request=new XMLHttpRequest();if("withCredentials"in _request){}else if(typeof XDomainRequest!="undefined"){_request=new XDomainRequest();}else _request=null;if(_request==null)throw new Error("CORS not supported");_request.withCredentials=true;_request.addEventListener(ASJS.LoaderEvent.READY_STATE_CHANGE,onReadyStateChange);_request.addEventListener(ASJS.LoaderEvent.PROGRESS,onProgress);_request.addEventListener(ASJS.LoaderEvent.LOAD,onLoad);_request.addEventListener(ASJS.LoaderEvent.ERROR,onError);_request.addEventListener(ASJS.LoaderEvent.ABORT,onAbort);_request.addEventListener(ASJS.LoaderEvent.LOAD_START,onLoadStart);_request.addEventListener(ASJS.LoaderEvent.TIMEOUT,onTimeout);_request.addEventListener(ASJS.LoaderEvent.LOAD_END,onLoadEnd);};function onReadyStateChange(e){scp.dispatchEvent(ASJS.LoaderEvent.READY_STATE_CHANGE,e);};function onLoadStart(){scp.dispatchEvent(ASJS.LoaderEvent.LOAD_START);};function onProgress(e){if(e.lengthComputable)scp.dispatchEvent(ASJS.LoaderEvent.PROGRESS,e);};function onLoad(e){scp.dispatchEvent(ASJS.LoaderEvent.LOAD,e);};function onAbort(e){scp.dispatchEvent(ASJS.LoaderEvent.ABORT,e);};function onTimeout(e){scp.dispatchEvent(ASJS.LoaderEvent.TIMEOUT,e);};function onLoadEnd(e){scp.dispatchEvent(ASJS.LoaderEvent.LOAD_END,e);};function onError(e){scp.dispatchEvent(ASJS.LoaderEvent.ERROR,e);};});};ASJS.ScriptLoader=function(){return createClass(this,ASJS.Loader,null,function(scp,spr){var _head=new ASJS.Head();var _type=ASJS.ScriptLoader.TYPE_EVALUATE;var _content;prop(scp,"type",{get:function(){return _type;},set:function(v){_type=v;}});prop(scp,"content",{get:function(){if(!_content&&spr.content!=""){_content=_type==ASJS.ScriptLoader.TYPE_EVALUATE?getEvaluatedScript():getImportedScript();scp.free();};return _content;}});scp.unload=function(){_content=null;spr.unload();};scp.load=function(url){scp.unload();spr.load(url);};function getEvaluatedScript(){return new Function(spr.content+" return Main;")();};function getImportedScript(){var id="ew"+(++ASJS.ScriptLoader.scripts);var script=new ASJS.Tag("script");script.setAttr("type","text/javascript");script.text="ASJS."+id+" = function(){"+spr.content+"return Main;};";_head.addChild(script);_head.removeChild(script);script=null;delete script;return ASJS[id]();}});};cnst(ASJS.ScriptLoader,"TYPE_EVALUATE","ASJS-ScriptLoader-typeEvaluate");cnst(ASJS.ScriptLoader,"TYPE_IMPORT","ASJS-ScriptLoader-typeImport");ASJS.ScriptLoader.scripts=0;ASJS.StyleLoader=function(){return createClass(this,ASJS.Loader,null,function(scp,spr){var _head=new ASJS.Head();var _style;scp.useStyle=function(){if(_style||spr.content=="")return;_style=new ASJS.Tag("style");_style.setAttr("type","text/css");_style.text=spr.content;_head.addChild(_style);scp.free();};scp.unload=function(){if(_style&&_head.contains(_style))_head.removeChild(_style);_style=null;spr.unload();};scp.load=function(url){scp.unload();spr.load(url);}});};ASJS.DisplayObject=function(tag){return createClass(this,ASJS.PrimitiveDisplayObject,null,function(scp,spr){var _mouse=new ASJS.Mouse();var _filters=[];var _rotation=0;var _scaleX=1;var _scaleY=1;var _cssDisplay="block";scp.new=function(){scp.tabindex=-1;scp.setCSS("pointer-events","auto");scp.setCSS("position","absolute");scp.setCSS("display",_cssDisplay);scp.setSize(0,0);scp.move(0,0);};prop(scp,"bounds",{get:function(){return new ASJS.Rectangle(scp.calcX,scp.calcY,scp.calcWidth,scp.calcHeight);}});prop(scp,"calcX",{get:function(){return scp.x+(parseFloat(scp.getCSS("marginLeft"))||0);}});prop(scp,"calcY",{get:function(){return scp.y+(parseFloat(scp.getCSS("marginTop"))||0);}});prop(scp,"calcWidth",{get:function(){var paddingLeft=parseFloat(scp.getCSS("paddingLeft"))||0;var paddingRight=parseFloat(scp.getCSS("paddingRight"))||0;var borderLeft=parseFloat(scp.getCSS("borderLeft"))||0;var borderRight=parseFloat(scp.getCSS("borderRight"))||0;return scp.width+paddingLeft+paddingRight+borderLeft+borderRight;}});prop(scp,"calcHeight",{get:function(){var paddingTop=parseFloat(scp.getCSS("paddingTop"))||0;var paddingBottom=parseFloat(scp.getCSS("paddingBottom"))||0;var borderTop=parseFloat(scp.getCSS("borderTop"))||0;var borderBottom=parseFloat(scp.getCSS("borderBottom"))||0;return scp.height+paddingTop+paddingBottom+borderTop+borderBottom;}});prop(scp,"mouse",{get:function(){return _mouse.getRelativePosition(scp);}});prop(scp,"tabIndex",{get:function(){return scp.getAttr("tabindex");},set:function(v){scp.setAttr("tabindex",v);}});prop(scp,"tooltip",{get:function(){return scp.setAttr("title");},set:function(v){scp.setAttr("title",v);}});prop(scp,"filters",{get:function(){return _filters;},set:function(v){_filters=v;var filters="";var i=-1;var l=_filters.length;while(++i<l)filters+=" "+_filters[i].execute();scp.setCSS("filter",filters);}});prop(scp,"display",{get:function(){return _cssDisplay;},set:function(v){_cssDisplay=v;scp.setCSS("display",_cssDisplay);}});prop(scp,"visible",{get:function(){return scp.getCSS("display")!="none";},set:function(v){scp.setCSS("display",v?_cssDisplay:"none");}});prop(scp,"alpha",{get:function(){return parseFloat(scp.getCSS("opacity"));},set:function(v){scp.setCSS("opacity",v);}});prop(scp,"x",{get:function(){return(parseFloat(scp.getCSS("left"))||0)-(scp.width-scp.width/_scaleX)*0.5;},set:function(v){scp.setCSS("left",v+(scp.width-scp.width/_scaleX)*0.5);}});prop(scp,"y",{get:function(){return(parseFloat(scp.getCSS("top"))||0)-(scp.height-scp.height/_scaleY)*0.5;},set:function(v){scp.setCSS("top",v+(scp.height-scp.height/_scaleY)*0.5);}});prop(scp,"width",{get:function(){return parseFloat(scp.getCSS("width"))*_scaleX;},set:function(v){scp.setCSS("width",typeof v!="number"?v:(parseFloat(v)/_scaleX));}});prop(scp,"height",{get:function(){return parseFloat(scp.getCSS("height"))*_scaleY;},set:function(v){scp.setCSS("height",typeof v!="number"?v:(parseFloat(v)/_scaleY));}});prop(scp,"rotation",{get:function(){return _rotation;},set:function(v){_rotation=parseFloat(v);drawTransform();}});prop(scp,"scaleX",{get:function(){return _scaleX;},set:function(v){_scaleX=parseFloat(v);var oW=scp.width/_scaleX;scp.x+=(scp.width-oW)*0.5;drawTransform();}});prop(scp,"scaleY",{get:function(){return _scaleY;},set:function(v){_scaleY=parseFloat(v);var oH=scp.height/_scaleY;scp.y+=(scp.height-oH)*0.5;drawTransform();}});scp.requestFullscreen=function(){if(!ASJS.DisplayObject.FULLSCREEN_ENABLED)return;scp.el.requestFullscreen();};scp.exitFullscreen=function(){if(!ASJS.DisplayObject.FULLSCREEN_ENABLED)return;document.exitFullscreen();};scp.scale=function(scaleX,scaleY){scp.scaleX=scaleX;scp.scaleY=scaleY;};scp.move=function(x,y){scp.x=x;scp.y=y;};scp.setSize=function(w,h){scp.width=w;scp.height=h;};scp.hitTest=function(point){return ASJS.GeomUtils.hitTest(scp,point);};scp.localToGlobal=function(point){return ASJS.GeomUtils.localToGlobal(scp,point);};scp.globalToLocal=function(point){return ASJS.GeomUtils.globalToLocal(scp,point);};function drawTransform(){scp.setCSS("transform",'rotate('+_rotation+'deg) scaleX('+_scaleX+') scaleY('+_scaleY+')');}});};cnst(ASJS.DisplayObject,"FULLSCREEN_ENABLED",document.fullscreenEnabled);ASJS.Sprite=function(tag){return createClass(this,ASJS.DisplayObject,null,function(scp,spr){var _children=[];var _mouseChildren=true;prop(scp,"bounds",{get:function(){var rect=spr.bounds;var size=new ASJS.Rectangle();var i=-1;var l=scp.numChildren;while(++i<l){var child=scp.getChildAt(i);var childRect=child.bounds;if(i==0){size.x=childRect.x;size.y=childRect.y;size.width=childRect.width+childRect.x;size.height=childRect.height+childRect.y;}else{if(childRect.x<size.x)size.x=childRect.x;if(childRect.y<size.y)size.y=childRect.y;if(childRect.width+childRect.x>size.width)size.width=childRect.width+childRect.x;if(childRect.height+childRect.y>size.height)size.height=childRect.height+childRect.y;}};rect.x+=size.x;rect.y+=size.y;if(size.width-size.x>rect.width)rect.width=size.width-size.x;if(size.height-size.y>rect.height)rect.height=size.height-size.y;return rect;}});prop(scp,"mouseChildren",{get:function(){return _mouseChildren;},set:function(v){_mouseChildren=v;var i=-1;var l=scp.numChildren;while(++i<l)scp.getChildAt(i).enabled=_mouseChildren;}});prop(scp,"numChildren",{get:function(){return _children.length;}});scp.clear=function(){while(scp.numChildren>0)scp.removeChildAt(0);spr.clear();};scp.contains=function(child){return scp.getChildIndex(child)>-1;};scp.addChild=function(child){return scp.addChildAt(child,scp.numChildren);};scp.addChildAt=function(child,index){if(!child)return null;if(child.parent)child.parent.removeChild(child);scp.el.appendChild(child.el);child.enabled=child.enabled?_mouseChildren:child.enabled;_children.push(child);scp.setChildIndex(child,index);child.parent=scp;return child;};scp.removeChild=function(child){if(!child)return null;scp.el.removeChild(child.el);var index=scp.getChildIndex(child);if(index>-1)_children.splice(index,1);child.parent=null;return child;};scp.removeChildAt=function(index){return scp.removeChild(scp.getChildAt(index));};scp.getChildAt=function(index){return index<0||index>scp.numChildren-1?null:_children[index];};scp.setChildIndex=function(child,index){if(!child||index<0)return null;var childActualIndex=scp.getChildIndex(child);if(childActualIndex>-1)_children.splice(childActualIndex,1);var afterChild=scp.getChildAt(index);if(afterChild)scp.el.insertBefore(child.el,afterChild.el);_children.splice(index,0,child);return child;};scp.getChildIndex=function(child){return!child?-1:_children.indexOf(child);};scp.swapChildren=function(childA,childB){var childAIndex=scp.getChildIndex(childA);var childBIndex=scp.getChildIndex(childB);if(childAIndex==-1||childBIndex==-1)return false;scp.setChildIndex(childA,childBIndex);scp.setChildIndex(childB,childAIndex);return true;};scp.getChildByDOMObject=function(domObject){if(!domObject)return null;var i=-1;var l=scp.numChildren;while(++i<l){var child=scp.getChildAt(i);if(domObject.id==child.id)return child;else if(child.numChildren){var grandChild=child.getChildByDOMObject(domObject);if(grandChild)return grandChild;}};return null;};scp._sendParentChangeEvent=function(){spr._sendParentChangeEvent();var i=-1;var l=scp.numChildren;while(++i<l)scp.getChildAt(i)._sendParentChangeEvent();}});};ASJS.Stage=function(){return createSingletonClass(ASJS.Stage,this,ASJS.Sprite,[document.body],function(scp,spr){var _inited=false;var _mouse=new ASJS.Mouse();var _window=new ASJS.Window();var _stageWidth=0;var _stageHeight=0;prop(scp,"title",{get:function(){return document.title;},set:function(v){document.title=v;}});prop(scp,"stage",{get:function(){return scp;}});prop(scp,"stageWidth",{get:function(){return _stageWidth;}});prop(scp,"stageHeight",{get:function(){return _stageHeight;}});scp.init=function(){if(_inited)return;_inited=true;scp.clear();scp.setSize("100%","100%");_window.addEventListener(ASJS.WindowEvent.RESIZE,recalcStageSize);recalcStageSize();_mouse.init();};function recalcStageSize(){var overflowX=scp.getCSS("overflow-x");var overflowY=scp.getCSS("overflow-y");scp.setCSS("overflow-x","hidden");scp.setCSS("overflow-y","hidden");_stageWidth=_window.width;_stageHeight=_window.height;scp.setCSS("overflow-x",overflowX);scp.setCSS("overflow-y",overflowY);scp.dispatchEvent(ASJS.Stage.RESIZE);}});};cnst(ASJS.Stage,"RESIZE","ASJS-Stage-resize");cnst(ASJS.Stage,"ADDED_TO_STAGE","ASJS-Stage-addedToStage");cnst(ASJS.Stage,"REMOVED_FROM_STAGE","ASJS-Stage-removedFromStage");ASJS.IFrame=function(){return createClass(this,ASJS.DisplayObject,["iframe"],function(scp,spr){prop(scp,"src",{get:function(){return scp.getAttr("src");},set:function(v){scp.setAttr("src",v);}});scp.isLoaded=function(){return scp.el.contentDocument.title.indexOf("404")==-1;};scp.sendMessage=function(data){scp.el.contentWindow.postMessage(data,"*");}});};ASJS.Bitmap=function(bitmapWidth,bitmapHeight){return createClass(this,ASJS.DisplayObject,["canvas"],function(scp,spr){var priv={};cnst(priv,"TARGET_FILL","targetFill");cnst(priv,"TARGET_STROKE","targetStroke");var _context;var _drawLine=false;var _drawFill=false;var _bitmapFilters;var _keepOriginal=true;var _original;scp.new=function(){if(!getContext())throw new Error("ASJS.Bitmap (canvas) is not supported in your browser!");scp.setBitmapSize(bitmapWidth,bitmapHeight);};prop(scp,"keepOriginal",{get:function(){return _keepOriginal;},set:function(v){_keepOriginal=v;}});prop(scp,"bitmapFilters",{get:function(){return _bitmapFilters;},set:function(v){_bitmapFilters=v;executeFilters();}});prop(scp,"bitmapWidth",{get:function(){return scp.getAttr("width");},set:function(v){scp.setAttr("width",Math.max(1,v||1));}});prop(scp,"bitmapHeight",{get:function(){return scp.getAttr("height");},set:function(v){scp.setAttr("height",Math.max(1,v||1));}});prop(scp,"blendMode",{get:function(){return getContext().globalCompositeOperation;},set:function(v){getContext().globalCompositeOperation=v;}});prop(scp,"globalAlpha",{get:function(){return getContext().globalAlpha;},set:function(v){getContext().globalAlpha=v;}});scp.beginLineColorStyle=function(size,rgb,alpha,miterLimit,lineJoin,lineCap){beginPath();setLineStyle(size,miterLimit,lineJoin,lineCap);beginColorFill(priv.TARGET_STROKE,rgb,alpha);};scp.beginLineGradientStyle=function(size,type,gradientParams,colors,lineMitter,lineJoin,lineCap){beginPath();setLineStyle(size,miterLimit,lineJoin,lineCap);beginGradientFill(priv.TARGET_STROKE,type,gradientParams,colors);};scp.beginLinePatternStyle=function(size,image,repeat,lineMitter,lineJoin,lineCap){beginPath();setLineStyle(size,miterLimit,lineJoin,lineCap);beginPatternFill(priv.TARGET_STROKE,image,repeat);};scp.beginColorFill=function(rgb,alpha){beginFill();beginColorFill(priv.TARGET_FILL,rgb,alpha);};scp.beginGradientFill=function(type,gradientParams,colors){beginFill();beginGradientFill(priv.TARGET_FILL,type,gradientParams,colors);};scp.beginPatternFill=function(image,repeat){beginFill();beginPatternFill(priv.TARGET_FILL,image,repeat);};scp.translate=function(x,y){getContext().translate(x,y);};scp.rotate=function(v){getContext().rotate(v*ASJS.GeomUtils.THETA);};scp.scale=function(w,h){getContext().scale(w,h);};scp.transform=function(matrix){getContext().transform(matrix.a,matrix.b,matrix.c,matrix.d,matrix.e,matrix.f);};scp.endLineStyle=function(){var ctx=getContext();if(_drawLine)ctx.stroke();_drawLine=false;};scp.endFill=function(){var ctx=getContext();getContext().closePath();if(_drawFill)ctx.fill();_drawFill=false;};scp.moveTo=function(x,y){getContext().moveTo(x,y);};scp.lineTo=function(x,y){getContext().lineTo(x,y);};scp.drawRect=function(x,y,w,h){var ctx=getContext();if(_drawFill)ctx.fillRect(x,y,w,h);if(_drawLine)ctx.strokeRect(x,y,w,h);};scp.drawCircle=function(x,y,r){scp.drawArc(x,y,r,0,2*Math.PI);};scp.drawArc=function(x,y,r,begin,end,counterclockwise){getContext().arc(x,y,r,begin,end,counterclockwise);};scp.drawHTML=function(v){try{rasterizeHTML.drawHTML(v,scp.el);}catch(e){throw new Error("Missing: http://www.github.com/cburgmer/rasterizeHTML.js");}};scp.drawImage=function(image,sx,sy,sw,sh,x,y,w,h){try{getContext().drawImage(image.el,sx,sy,sw,sh,x,y,w,h);}catch(e){}};scp.textStyle=function(font,align,baseline){var ctx=getContext();ctx.font=font;ctx.textAlign=align;ctx.textBaseline=baseline;};scp.drawText=function(text,x,y){var ctx=getContext();if(_drawFill)ctx.fillText(text,x,y);if(_drawLine)ctx.strokeText(text,x,y);};scp.measureText=function(text){return getContext().measureText(text);};scp.clearRect=function(x,y,w,h){getContext().clearRect(x,y,w,h);};scp.getDataUrl=function(type,encoderOptions){return scp.el.toDataURL(type,encoderOptions);};scp.getColorRgb=function(x,y){var color=scp.getImageData(x,y,1,1);return{r:color.data[0],g:color.data[1],b:color.data[2],a:color.data[3]};};scp.setColor=function(x,y){scp.drawRect(x,y,1,1);};scp.getImageData=function(x,y,w,h){return getContext().getImageData(x,y,w,h);};scp.putImageData=function(imageData,x,y){getContext().putImageData(imageData,x,y);};scp.merge=function(bitmap,srcX,srcY,srcW,srcH,x,y){scp.putImageData(bitmap.getImageData(srcX,srcY,srcW,srcH),x,y);};scp.destroy=function(){scp.clearRect(0,0,scp.bitmapWidth,scp.bitmapHeight);scp.setBitmapSize(1,1);if(_original)_original=null;};scp.setBitmapSize=function(width,height){scp.bitmapWidth=width;scp.bitmapHeight=height;};scp.clone=function(){var bmp=new ASJS.Bitmap(scp.bitmapWidth,scp.bitmapHeight);bmp.setSize(scp.bitmapWidth,scp.bitmapHeight);bmp.drawImage(scp,0,0,scp.bitmapWidth,scp.bitmapHeight,0,0,scp.bitmapWidth,scp.bitmapHeight);return bmp;};scp.getOriginal=function(){var bmp=new ASJS.Bitmap(scp.bitmapWidth,scp.bitmapHeight);if(_original)bmp.drawImage(_original,0,0,scp.bitmapWidth,scp.bitmapHeight,0,0,scp.bitmapWidth,scp.bitmapHeight);return bmp;};function beginPath(){getContext().beginPath();_drawLine=true;};function beginFill(){getContext().beginPath();_drawFill=true;};function addColorToGradient(gradient,stop,color,alpha){var rgb=hexToRGB(color);rgb.a=alpha;gradient.addColorStop(stop,rgbToString(rgb));};function fillStyle(targetType,v){var ctx=getContext();if(targetType==priv.TARGET_FILL)ctx.fillStyle=v;else ctx.strokeStyle=v;};function setLineStyle(size,miterLimit,lineJoin,lineCap){var ctx=getContext();ctx.lineWidth=size;ctx.miterLimit=miterLimit||10;ctx.lineJoin=lineJoin||ASJS.Bitmap.LINE_JOIN_MITER;ctx.lineCap=lineCap||ASJS.Bitmap.LINE_CAP_BUTT;};function beginColorFill(targetType,rgb,alpha){var rgb=hexToRgb(rgb);rgb.a=alpha;fillStyle(targetType,rgbToString(rgb));};function beginGradientFill(targetType,type,gradientData,colors){var ctx=getContext();var gradient;switch(type){case ASJS.Bitmap.GRADIENT_LINEAR:gradient=ctx.createLinearGradient(gradientParams);break;case ASJS.Bitmap.GRADIENT_RADIAL:gradient=ctx.createRadialGradient(gradientParams);break;};var i=-1;var l=colors.length;var color;while(++i<l){color=colors[i];addColorToGradient(gradient,color.stop,color.color,color.alpha);};fillStyle(targetType,gradient);};function beginPatternFill(targetType,image,repeat){var pattern=getContext().createPattern(image.el,repeat||ASJS.Bitmap.PATTERN_REPEAT);fillStyle(targetType,pattern);};function getContext(){if(!_context)_context=scp.el.getContext("2d");return _context;};function rgbToString(rgb){return"rgba( "+rgb.r+", "+rgb.g+", "+rgb.b+", "+rgb.a+" )";};function hexToRgb(v){var shorthandRegex=/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i;v=v.replace(shorthandRegex,function(m,r,g,b){return r+r+g+g+b+b;});var result=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(v);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16),a:1}:null;};function executeFilters(){var l=scp.bitmapFilters.length;if(l==0)return;if(scp.keepOriginal){if(!_original){_original=new ASJS.Image();_original.src=scp.getDataUrl("image/png",1.0);}else{scp.drawImage(_original,0,0,scp.bitmapWidth,scp.bitmapHeight,0,0,scp.bitmapWidth,scp.bitmapHeight);_original=null;}};var i=-1;var pixels=scp.getImageData(0,0,scp.bitmapWidth,scp.bitmapHeight);while(++i<l){var filter=scp.bitmapFilters[i];pixels=filter.execute(pixels);};scp.putImageData(pixels,0,0);}});};cnst(ASJS.Bitmap,"GRADIENT_LINEAR","ASJS-Bitmap-gradientLinear");cnst(ASJS.Bitmap,"GRADIENT_RADIAL","ASJS-Bitmap-gradientRadial");cnst(ASJS.Bitmap,"PATTERN_REPEAT","repeat");cnst(ASJS.Bitmap,"PATTERN_NO_REPEAT","no-repeat");cnst(ASJS.Bitmap,"PATTERN_REPEAT_X","repeat-x");cnst(ASJS.Bitmap,"PATTERN_REPEAT_Y","repeat-y");cnst(ASJS.Bitmap,"LINE_CAP_BUTT","butt");cnst(ASJS.Bitmap,"LINE_CAP_ROUND","round");cnst(ASJS.Bitmap,"LINE_CAP_SQUARE","square");cnst(ASJS.Bitmap,"LINE_JOIN_BEVEL","bevel");cnst(ASJS.Bitmap,"LINE_JOIN_ROUND","round");cnst(ASJS.Bitmap,"LINE_JOIN_MITER","miter");ASJS.Image=function(){return createClass(this,ASJS.DisplayObject,["img"],function(scp,spr){prop(scp,"bitmap",{get:function(){var bmp=new ASJS.Bitmap(scp.imageWidth,scp.imageHeight);bmp.drawImage(scp,0,0,scp.imageWidth,scp.imageHeight,0,0,scp.imageWidth,scp.imageHeight);return bmp;}});prop(scp,"imageWidth",{get:function(){return scp.el.width;}});prop(scp,"imageHeight",{get:function(){return scp.el.height;}});prop(scp,"src",{get:function(){return scp.getAttr("src");},set:function(v){scp.setAttr("src",v);}});prop(scp,"alt",{get:function(){return scp.getAttr("alt");},set:function(v){scp.setAttr("alt",v);}});});};ASJS.Label=function(){return createClass(this,ASJS.DisplayObject,["label"],function(scp,spr){prop(scp,"for",{get:function(){return scp.getAttr("for");},set:function(v){if(v&&v.id)scp.setAttr("for",v.id);}});});};ASJS.Link=function(){return createClass(this,ASJS.Sprite,["a"],function(scp,spr){prop(scp,"href",{get:function(){return scp.getAttr("href");},set:function(v){scp.setAttr("href",v);}});prop(scp,"target",{get:function(){return scp.getAttr("target");},set:function(v){scp.setAttr("target",v);}});prop(scp,"download",{get:function(){return scp.getAttr("download");},set:function(v){scp.setAttr("download",v);}});});};ASJS.Scale9Grid=function(){return createClass(this,ASJS.Sprite,null,function(scp,spr){var _size=new ASJS.Point();var _rectangle=new ASJS.Rectangle();var _blocks=[];scp.new=function(){var i=-1;var l=9;while(++i<l){_blocks[i]=new ASJS.Sprite();_blocks[i].setCSS("background-repeat","no-repeat");scp.addChild(_blocks[i]);};_blocks[0].setCSS("background-position","left top");_blocks[2].setCSS("background-position","right top");_blocks[6].setCSS("background-position","left bottom");_blocks[8].setCSS("background-position","right bottom");};prop(scp,"x",{set:function(v){spr.x=v;}});prop(scp,"y",{set:function(v){spr.y=v;}});prop(scp,"width",{set:function(v){spr.width=v;}});prop(scp,"height",{set:function(v){spr.height=v;}});prop(scp,"backgroundImage",{set:function(v){var i=-1;var l=9;while(++i<l)_blocks[i].setCSS("background-image","url("+v+")");}});prop(scp,"size",{get:function(){return _size;},set:function(v){_size=v;}});prop(scp,"rect",{get:function(){return _rectangle;},set:function(v){_rectangle=v;}});scp.setSize=function(w,h){spr.setSize(w,h);};scp.render=function(){var rightSize=_size.x-(_rectangle.x+_rectangle.width);var bottomSize=_size.y-(_rectangle.y+_rectangle.height);var center=new ASJS.Point(scp.width-_rectangle.x-rightSize,scp.height-_rectangle.y-bottomSize);var percent=new ASJS.Point(Math.round(center.x/_rectangle.width),Math.round(center.y/_rectangle.height));var tl=new ASJS.Point(-(percent.x*_rectangle.x)*2,-(percent.y*_rectangle.y)*2);var br=new ASJS.Point(percent.x*rightSize,percent.y*bottomSize);var ps=new ASJS.Point((_size.x*percent.x)*2,(_size.y*percent.y)*2);_blocks[0].setSize(_rectangle.x,_rectangle.y);_blocks[1].setSize(scp.width-_rectangle.x-rightSize,_rectangle.y);_blocks[2].setSize(scp.width-_blocks[0].width-_blocks[1].width,_rectangle.y);_blocks[3].setSize(_rectangle.x,scp.height-_rectangle.y-bottomSize);_blocks[4].setSize(_blocks[1].width,_blocks[3].height);_blocks[5].setSize(_blocks[2].width,_blocks[3].height);_blocks[6].setSize(_rectangle.x,scp.height-_blocks[0].height-_blocks[3].height);_blocks[7].setSize(_blocks[1].width,_blocks[6].height);_blocks[8].setSize(_blocks[2].width,_blocks[6].height);_blocks[1].x=_blocks[0].width;_blocks[2].x=_blocks[1].x+_blocks[1].width;_blocks[3].y=_blocks[0].height;_blocks[4].move(_blocks[3].width,_blocks[1].height);_blocks[5].move(_blocks[4].x+_blocks[4].width,_blocks[1].height);_blocks[6].y=_blocks[3].y+_blocks[3].height;_blocks[7].move(_blocks[6].width,_blocks[6].y);_blocks[8].move(_blocks[7].x+_blocks[7].width,_blocks[6].y);_blocks[1].setCSS("background-position",tl.x+"px top");_blocks[1].setCSS("background-size",ps.x+"px "+_size.y+"px");_blocks[3].setCSS("background-position","left "+tl.y+"px");_blocks[3].setCSS("background-size",_size.x+"px "+ps.y+"px");_blocks[4].setCSS("background-position",tl.x+"px "+tl.y+"px");_blocks[4].setCSS("background-size",ps.x+"px "+ps.y+"px");_blocks[5].setCSS("background-position","right "+tl.y+"px");_blocks[5].setCSS("background-size",_size.x+"px "+ps.y+"px");_blocks[7].setCSS("background-position",tl.x+"px bottom");_blocks[7].setCSS("background-size",ps.x+"px "+_size.y+"px");}});};ASJS.AbstractMediaPlayer=function(tag){return createClass(this,ASJS.Sprite,null,function(scp,spr){scp.new=function(){scp.controls=false;scp.preload=ASJS.AbstractMediaPlayer.PRELOAD_AUTO;};prop(scp,"buffered",{get:function(){return scp.el.buffered;}});prop(scp,"controller",{get:function(){return scp.el.controller;}});prop(scp,"currentSrc",{get:function(){return scp.el.currentSrc;}});prop(scp,"duration",{get:function(){return scp.el.duration;}});prop(scp,"ended",{get:function(){return scp.el.ended;}});prop(scp,"error",{get:function(){return scp.el.error;}});prop(scp,"networkState",{get:function(){return scp.el.networkState;}});prop(scp,"paused",{get:function(){return scp.el.paused;}});prop(scp,"played",{get:function(){return scp.el.played;}});prop(scp,"readyState",{get:function(){return scp.el.readyState;}});prop(scp,"seekable",{get:function(){return scp.el.seekable;}});prop(scp,"seeking",{get:function(){return scp.el.seeking;}});prop(scp,"startDate",{get:function(){return scp.el.startDate;}});prop(scp,"textTracks",{get:function(){return scp.el.textTracks;}});prop(scp,"controls",{get:function(){return scp.el.controls;},set:function(v){scp.el.controls=v;}});prop(scp,"preload",{get:function(){return scp.el.preload;},set:function(v){scp.el.preload=v;}});prop(scp,"muted",{get:function(){return scp.el.muted;},set:function(v){scp.el.muted=v;}});prop(scp,"loop",{get:function(){return scp.el.loop;},set:function(v){scp.el.loop=v;}});prop(scp,"autoplay",{get:function(){return scp.el.autoplay;},set:function(v){scp.el.autoplay=v;}});prop(scp,"src",{get:function(){return scp.el.src;},set:function(v){scp.el.src=v;}});prop(scp,"crossOrigin",{get:function(){return scp.el.crossOrigin;},set:function(v){scp.el.crossOrigin=v;}});prop(scp,"currentTime",{get:function(){return scp.el.currentTime;},set:function(v){scp.el.currentTime=v;}});prop(scp,"defaultMuted",{get:function(){return scp.el.defaultMuted;},set:function(v){scp.el.defaultMuted=v;}});prop(scp,"defaultPlaybackRate",{get:function(){return scp.el.defaultPlaybackRate;},set:function(v){scp.el.defaultPlaybackRate=v;}});prop(scp,"mediaGroup",{get:function(){return scp.el.mediaGroup;},set:function(v){scp.el.mediaGroup=v;}});prop(scp,"playbackRate",{get:function(){return scp.el.playbackRate;},set:function(v){scp.el.playbackRate=v;}});prop(scp,"volume",{get:function(){return scp.el.volume;},set:function(v){scp.el.volume=v;}});scp.play=function(){scp.el.play();};scp.pause=function(){scp.el.pause();};scp.load=function(){scp.el.load();};scp.unload=function(){scp.clear();scp.removeAttr("src");}});};cnst(ASJS.AbstractMediaPlayer,"PRELOAD_NONE","none");cnst(ASJS.AbstractMediaPlayer,"PRELOAD_AUTO","auto");cnst(ASJS.AbstractMediaPlayer,"PRELOAD_METADATA","metadata");ASJS.VideoPlayer=function(){return createClass(this,ASJS.AbstractMediaPlayer,["video"],function(scp,spr){prop(scp,"poster",{get:function(){return scp.el.poster;},set:function(v){scp.el.poster=v;}});});};ASJS.AudioPlayer=function(){return createClass(this,ASJS.AbstractMediaPlayer,["audio"]);};ASJS.MediaSource=function(src,type){return createClass(this,ASJS.DisplayObject,["source"],function(scp,spr){scp.new=function(){scp.src=src;scp.type=type;};prop(scp,"type",{get:function(){return scp.getAttr("type");},set:function(v){scp.setAttr("type",v);}});prop(scp,"src",{get:function(){return scp.getAttr("src");},set:function(v){scp.setAttr("src",v);}});});};cnst(ASJS.MediaSource,"TYPE_AUDIO_MP3","audio/mpeg");cnst(ASJS.MediaSource,"TYPE_AUDIO_OGG","audio/ogg");cnst(ASJS.MediaSource,"TYPE_AUDIO_WAV","audio/wav");cnst(ASJS.MediaSource,"TYPE_VIDEO_MP4","video/mp4");cnst(ASJS.MediaSource,"TYPE_VIDEO_OGG","video/ogg");cnst(ASJS.MediaSource,"TYPE_VIDEO_WEBM","video/webm");ASJS.VideoTrack=function(){return createClass(this,ASJS.DisplayObject,["track"],function(scp,spr){prop(scp,"src",{get:function(){return scp.getAttr("src");},set:function(v){scp.setAttr("src",v);}});prop(scp,"kind",{get:function(){return scp.getAttr("kind");},set:function(v){scp.setAttr("kind",v);}});prop(scp,"label",{get:function(){return scp.getAttr("label");},set:function(v){scp.setAttr("label",v);}});prop(scp,"srclang",{get:function(){return scp.getAttr("srclang");},set:function(v){scp.setAttr("srclang",v);}});});};cnst(ASJS.VideoTrack,"KIND_CAPTIONS","captions");cnst(ASJS.VideoTrack,"KIND_CHAPTERS","chapters");cnst(ASJS.VideoTrack,"KIND_DESCRIPTIONS","descriptions");cnst(ASJS.VideoTrack,"KIND_METADATA","metadata");cnst(ASJS.VideoTrack,"KIND_SUBTITLES","subtitles");ASJS.Easing=function(){return createClass(this,Object,null,function(scp,spr){var _cycler=new ASJS.Cycler();var _isPlaying;var _id;var _step;var _target;var _from;var _change;var _to;var _type;var _duration;var _stepCallback;var _completeCallback;scp.new=function(){scp.stop();};scp.stop=function(){_isPlaying=false;_cycler.removeCallback(update);};scp.play=function(target,to,duration,type,stepCallback,completeCallback){_target=target;_from={};_change={};_to=to;_type=type;_duration=(duration/(1000/_cycler.fps));_stepCallback=stepCallback;_completeCallback=completeCallback;iterateParameters(function(k){_from[k]=_target[k];_change[k]=_to[k]-_from[k];});if(!ASJS.Easing[_type])_type="linearTween";letsPlay();};function letsPlay(){if(_isPlaying)return;_step=0;_isPlaying=true;_cycler.addCallback(update);};function update(){if(!_isPlaying)return;if(_step>=_duration){scp.stop();iterateParameters(function(k){_target[k]=_to[k];});if(_stepCallback)_stepCallback();if(_completeCallback)_completeCallback();return;};iterateParameters(function(k){_target[k]=ASJS.Easing[_type](_step,_from[k],_change[k],_duration);});if(_stepCallback)_stepCallback();_step++;};function iterateParameters(callback){for(var k in _to)callback(k);}});};roFunc(ASJS.Easing,"linearTween",function(t,b,c,d){return c*t/d+b;});roFunc(ASJS.Easing,"easeInQuad",function(t,b,c,d){t/=d;return c*t*t+b;});roFunc(ASJS.Easing,"easeOutQuad",function(t,b,c,d){t/=d;return-c*t*(t-2)+b;});roFunc(ASJS.Easing,"easeInOutQuad",function(t,b,c,d){t/=d/2;if(t<1)return c/2*t*t+b;t--;return-c/2*(t*(t-2)-1)+b;});roFunc(ASJS.Easing,"easeInCubic",function(t,b,c,d){t/=d;return c*t*t*t+b;});roFunc(ASJS.Easing,"easeOutCubic",function(t,b,c,d){t/=d;t--;return c*(t*t*t+1)+b;});roFunc(ASJS.Easing,"easeInOutCubic",function(t,b,c,d){t/=d/2;if(t<1)return c/2*t*t*t+b;t-=2;return c/2*(t*t*t+2)+b;});roFunc(ASJS.Easing,"easeInQuart",function(t,b,c,d){t/=d;return c*t*t*t*t+b;});roFunc(ASJS.Easing,"easeOutQuart",function(t,b,c,d){t/=d;t--;return-c*(t*t*t*t-1)+b;});roFunc(ASJS.Easing,"easeInOutQuart",function(t,b,c,d){t/=d/2;if(t<1)return c/2*t*t*t*t+b;t-=2;return-c/2*(t*t*t*t-2)+b;});roFunc(ASJS.Easing,"easeInQuint",function(t,b,c,d){t/=d;return c*t*t*t*t*t+b;});roFunc(ASJS.Easing,"easeOutQuint",function(t,b,c,d){t/=d;t--;return c*(t*t*t*t*t+1)+b;});roFunc(ASJS.Easing,"easeInOutQuint",function(t,b,c,d){t/=d/2;if(t<1)return c/2*t*t*t*t*t+b;t-=2;return c/2*(t*t*t*t*t+2)+b;});roFunc(ASJS.Easing,"easeInSine",function(t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b;});roFunc(ASJS.Easing,"easeOutSine",function(t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b;});roFunc(ASJS.Easing,"easeInOutSine",function(t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b;});roFunc(ASJS.Easing,"easeInExpo",function(t,b,c,d){return c*Math.pow(2,10*(t/d-1))+b;});roFunc(ASJS.Easing,"easeOutExpo",function(t,b,c,d){return c*(-Math.pow(2,-10*t/d)+1)+b;});roFunc(ASJS.Easing,"easeInOutExpo",function(t,b,c,d){t/=d/2;if(t<1)return c/2*Math.pow(2,10*(t-1))+b;t--;return c/2*(-Math.pow(2,-10*t)+2)+b;});roFunc(ASJS.Easing,"easeInCirc",function(t,b,c,d){t/=d;return-c*(Math.sqrt(1-t*t)-1)+b;});roFunc(ASJS.Easing,"easeOutCirc",function(t,b,c,d){t/=d;t--;return c*Math.sqrt(1-t*t)+b;});roFunc(ASJS.Easing,"easeInOutCirc",function(t,b,c,d){t/=d/2;if(t<1)return-c/2*(Math.sqrt(1-t*t)-1)+b;t-=2;return c/2*(Math.sqrt(1-t*t)+1)+b;});ASJS.AnimationDescriptor=function(name,spriteSheet,size,frameDelay,sequenceList){return createClass(this,Object,null,function(scp,spr){scp.name=name||"";scp.spriteSheet=spriteSheet||"";scp.size=size||new ASJS.Point();scp.frameDelay=Math.floor(Math.max(1,frameDelay||1));scp.sequenceList=sequenceList||[];});};ASJS.AnimatedSprite=function(){return createClass(this,ASJS.DisplayObject,null,function(scp,spr){var _cycler=new ASJS.Cycler();var _animations={};var _isPlaying=false;var _selectedAnimation="";var _step=0;var _angle=ASJS.AnimatedSprite.PLAY_NORMAL;var _imageCache=[];scp.new=function(){scp.stop();};prop(scp,"selectedAnimation",{get:function(){return _selectedAnimation;}});scp.addAnimationDescriptorList=function(animationDescriptorList){var i=-1;var l=animationDescriptorList.length;while(++i<l)scp.addAnimationDescriptor(animationDescriptorList[i]);};scp.addAnimationDescriptor=function(animationDescriptor){_animations[animationDescriptor.name]=animationDescriptor;};scp.removeAnimationDescriptor=function(name){_animations[name]=null;delete _animations[name];};scp.stop=function(){_step=0;_isPlaying=false;_cycler.removeCallback(update);};scp.play=function(name,type){if(!_animations[name])return;var angle=!type?ASJS.AnimatedSprite.PLAY_NORMAL:(type==ASJS.AnimatedSprite.PLAY_NORMAL?ASJS.AnimatedSprite.PLAY_NORMAL:ASJS.AnimatedSprite.PLAY_REVERSE);if(_selectedAnimation==name&&_angle==angle){letsPlay();return;};_selectedAnimation=name;_angle=angle;_step=0;var spriteSheet=_animations[_selectedAnimation].spriteSheet;if(spriteSheet!=""){if(_imageCache.indexOf(spriteSheet)>-1)setSpriteSheet(spriteSheet);else{var loader=new ASJS.Loader();loader.addEventListener(ASJS.LoaderEvent.LOAD,function(){_imageCache.push(spriteSheet);setSpriteSheet(spriteSheet);});loader.addEventListener(ASJS.LoaderEvent.ERROR,function(){trace("Error: missing animation sprite sheet");});loader.load(spriteSheet);}}else letsPlay();};function setSpriteSheet(v){scp.setCSS("background-image","url("+v+")");letsPlay();};function letsPlay(){if(_isPlaying)return;_isPlaying=true;_cycler.addCallback(update);};function update(){if(!_isPlaying)return;var selectedAnimation=_animations[_selectedAnimation];var sequenceList=selectedAnimation.sequenceList;var rect=sequenceList[_step];var size=selectedAnimation.size;var percentW=scp.width/rect.width;var percentH=scp.height/rect.height;scp.setCSS("background-position",(-rect.x*percentW)+"px "+(-rect.y*percentH)+"px");scp.setCSS("background-size",(size.x*percentW)+"px "+(size.y*percentH)+"px");scp.setSize(rect.width*percentW,rect.height*percentH);if(_angle==ASJS.AnimatedSprite.PLAY_NORMAL){if(++_step>=sequenceList.length)_step=0;}else{if(--_step<0)_step=sequenceList.length-1;}}});};cnst(ASJS.AnimatedSprite,"PLAY_NORMAL","ASJS-AnimatedSprite-playNormal");cnst(ASJS.AnimatedSprite,"PLAY_REVERSE","ASJS-AnimatedSprite-playReverse");ASJS.AnimationLoader=function(){return createClass(this,Object,null,function(scp,spr){var _dfd;var _loader;scp.load=function(url){_dfd=new ASJS.Deferred();_loader=new ASJS.Loader();_loader.addEventListener(ASJS.LoaderEvent.LOAD,onLoad);_loader.addEventListener(ASJS.LoaderEvent.ERROR,onLoadError);_loader.method=ASJS.RequestMethod.GET;_loader.responseType="json";_loader.load(url);return _dfd.promise;};function parseAnimationDescriptor(data){var animationDescriptor=new ASJS.AnimationDescriptor(data.id,data.image,new ASJS.Point(data.imageSize.w,data.imageSize.h),data.frameDelay);var i=-1;var l=data.frames.length;var frames=[];while(++i<l){var frame=data.frames[i];var j=-1;var m=Math.max(1,frame.l||1)*animationDescriptor.frameDelay;while(++j<m)frames.push(new ASJS.Rectangle(frame.x,frame.y,frame.w,frame.h));};animationDescriptor.sequenceList=frames;return animationDescriptor;};function onLoad(){_loader.removeEventListeners();try{var i=-1;var l=_loader.content.length;var animationDescriptorList=[];while(++i<l)animationDescriptorList.push(parseAnimationDescriptor(_loader.content[i]));_dfd.resolve(animationDescriptorList);}catch(e){trace(e);throw new Error("Invalid animation descriptor file: "+_loader.url);_dfd.reject();}};function onLoadError(){_loader.removeEventListeners();_dfd.reject();}});};ASJS.BlendMode={};cnst(ASJS.BlendMode,"SOURCE_OVER","source-over");cnst(ASJS.BlendMode,"SOURCE_IN","source-in");cnst(ASJS.BlendMode,"SOURCE_OUT","source-out");cnst(ASJS.BlendMode,"SOURCE_ATOP","source-atop");cnst(ASJS.BlendMode,"DESTINATION_OVER","destination-over");cnst(ASJS.BlendMode,"DESTINATION_IN","destination-in");cnst(ASJS.BlendMode,"DESTINATION_OUT","destination-out");cnst(ASJS.BlendMode,"DESTINATION_ATOP","destination-atop");cnst(ASJS.BlendMode,"LIGHTER","lighter");cnst(ASJS.BlendMode,"COPY","copy");cnst(ASJS.BlendMode,"XOR","xor");cnst(ASJS.BlendMode,"MULTIPLY","multiply");cnst(ASJS.BlendMode,"SCREEN","screen");cnst(ASJS.BlendMode,"OVERLAY","overlay");cnst(ASJS.BlendMode,"DARKEN","darken");cnst(ASJS.BlendMode,"LIGHTEN","lighten");cnst(ASJS.BlendMode,"COLOR_DODGE","color-dodge");cnst(ASJS.BlendMode,"COLOR_BURN","color-burn");cnst(ASJS.BlendMode,"HARD_LIGHT","hard-light");cnst(ASJS.BlendMode,"SOFT_LIGHT","soft-light");cnst(ASJS.BlendMode,"DIFFERENCE","difference");cnst(ASJS.BlendMode,"EXCLUSION","exclusion");cnst(ASJS.BlendMode,"HUE","hue");cnst(ASJS.BlendMode,"SATURATION","saturation");cnst(ASJS.BlendMode,"COLOR","color");cnst(ASJS.BlendMode,"LUMINOSITY","luminosity");ASJS.GradientColorData=function(stop,color,alpha){return createClass(this,Object,null,function(scp,spr){scp.stop=stop||0;scp.color=color||"#0";scp.alpha=alpha||1;});};ASJS.LinearGradientData=function(x,y,w,h){return createClass(this,ASJS.Rectangle);};ASJS.RadialGradientData=function(x0,y0,r0,x1,y1,r1){return createClass(this,Object,null,function(scp,spr){scp.x0=x0||0;scp.y0=y0||0;scp.r0=r0||0;scp.x1=x1||0;scp.y1=y1||0;scp.r1=r1||0;});};ASJS.AbstractBitmapFilter=function(){return createClass(this,Object,null,function(scp,spr){scp.execute=function(pixels){return pixels;}});};ASJS.AbstractConvoluteBitmapFilter=function(opaque){return createClass(this,ASJS.AbstractBitmapFilter,null,function(scp,spr){var _opaque=opaque;prop(scp,"_matrix",{get:function(){return[1];}});scp.execute=function(pixels){var d=pixels.data;return convolute(pixels);};function convolute(pixels){var weights=scp._matrix;var side=Math.round(Math.sqrt(weights.length));var halfSide=Math.floor(side*0.5);var src=pixels.data;var sw=pixels.width;var sh=pixels.height;var w=sw;var h=sh;var bitmapHelper=new ASJS.Bitmap(w,h);var output=bitmapHelper.getImageData(0,0,w,h);var dst=output.data;var alphaFac=_opaque?1:0;var y=-1;while(++y<h){var x=-1;while(++x<w){var sy=y;var sx=x;var dstOff=(y*w+x)*4;var r=0;var g=0;var b=0;var a=0;var cy=-1;while(++cy<side){var cx=-1;while(++cx<side){var scy=sy+cy-halfSide;var scx=sx+cx-halfSide;if(scy>=0&&scy<sh&&scx>=0&&scx<sw){var srcOff=(scy*sw+scx)*4;var wt=weights[cy*side+cx];r+=src[srcOff]*wt;g+=src[srcOff+1]*wt;b+=src[srcOff+2]*wt;a+=src[srcOff+3]*wt;}}};dst[dstOff]=r;dst[dstOff+1]=g;dst[dstOff+2]=b;dst[dstOff+3]=a+alphaFac*(255-a);}};return output;};});};ASJS.AlphaBitmapFilter=function(type){return createClass(this,ASJS.AbstractBitmapFilter,null,function(scp,spr){var _isDarkness=type==ASJS.AlphaBitmapFilter.TYPE_DARKNESS;scp.execute=function(pixels){var d=pixels.data;var i=-4;var l=d.length;while((i+=4)<l){var average=((d[i]+d[i+1]+d[i+2])/3);var a=Math.round(_isDarkness?255-average:average);d[i+3]-=a;};return pixels;}});};cnst(ASJS.AlphaBitmapFilter,"TYPE_DARKNESS","ASJS-AlphaBitmapFilter-typeDarkness");cnst(ASJS.AlphaBitmapFilter,"TYPE_BRIGHTNESS","ASJS-AlphaBitmapFilter-typeBrightness");ASJS.BlurBitmapFilter=function(opaque,value){return createClass(this,ASJS.AbstractConvoluteBitmapFilter,null,function(scp,spr){var _blurValue=Math.max(1,value||1);prop(scp,"_matrix",{get:function(){var value=1/Math.pow(_blurValue,2);var matrix=[];var i=-1;while(++i<_blurValue){var j=-1;while(++j<_blurValue){matrix.push(value);}};return matrix;}});});};ASJS.BrightnessBitmapFilter=function(adjustment){return createClass(this,ASJS.AbstractBitmapFilter,null,function(scp,spr){var _adjustment=adjustment;scp.execute=function(pixels){var d=pixels.data;var i=-4;var l=d.length;while((i+=4)<l){d[i]+=_adjustment;d[i+1]+=_adjustment;d[i+2]+=_adjustment;};return pixels;}});};ASJS.ContrastBitmapFilter=function(adjustment){return createClass(this,ASJS.AbstractBitmapFilter,null,function(scp,spr){var _adjustment=adjustment||1;scp.execute=function(pixels){var d=pixels.data;var i=-4;var l=d.length;while((i+=4)<l){d[i]=128-((128-d[i])*_adjustment);d[i+1]=128-((128-d[i+1])*_adjustment);d[i+2]=128-((128-d[i+2])*_adjustment);};return pixels;}});};ASJS.CutoutBitmapFilter=function(adjustment){return createClass(this,ASJS.AbstractBitmapFilter,null,function(scp,spr){var _adjustment=adjustment||255;scp.execute=function(pixels){var d=pixels.data;var average=255/_adjustment;var i=-4;var l=d.length;while((i+=4)<l){d[i]=Math.floor(d[i]/average)*average;d[i+1]=Math.floor(d[i+1]/average)*average;d[i+2]=Math.floor(d[i+2]/average)*average;};return pixels;}});};ASJS.GrayscaleBitmapFilter=function(){return createClass(this,ASJS.AbstractBitmapFilter,null,function(scp,spr){scp.execute=function(pixels){var d=pixels.data;var i=-4;var l=d.length;while((i+=4)<l){var r=d[i];var g=d[i+1];var b=d[i+2];var v=0.2126*r+0.7152*g+0.0722*b;d[i]=d[i+1]=d[i+2]=v;};return pixels;}});};ASJS.InvertBitmapFilter=function(){return createClass(this,ASJS.AbstractBitmapFilter,null,function(scp,spr){scp.execute=function(pixels){var d=pixels.data;var i=-4;var l=d.length;while((i+=4)<l){d[i]=128-(d[i]-128);d[i+1]=128-(d[i+1]-128);d[i+2]=128-(d[i+2]-128);};return pixels;}});};ASJS.SharpenBitmapFilter=function(opaque){return createClass(this,ASJS.AbstractConvoluteBitmapFilter,null,function(scp,spr){prop(scp,"_matrix",{get:function(){return[0,-1,0,-1,5,-1,0,-1,0];}});});};ASJS.ThresholdBitmapFilter=function(threshold){return createClass(this,ASJS.AbstractBitmapFilter,null,function(scp,spr){var _threshold=threshold;scp.execute=function(pixels){var d=pixels.data;var i=-4;var l=d.length;while((i+=4)<l){var r=d[i];var g=d[i+1];var b=d[i+2];var v=(0.2126*r+0.7152*g+0.0722*b>=_threshold)?255:0;d[i]=d[i+1]=d[i+2]=v;};return pixels;}});};ASJS.TintBitmapFilter=function(r,g,b,a){return createClass(this,ASJS.AbstractBitmapFilter,null,function(scp,spr){var _r=r||0;var _g=g||0;var _b=b||0;var _a=a||0;scp.execute=function(pixels){var d=pixels.data;var i=-4;var l=d.length;while((i+=4)<l){d[i]+=_r;d[i+1]+=_g;d[i+2]+=_b;d[i+3]+=_a;};return pixels;}});};ASJS.OpacityBitmapFilter=function(adjustment){return createClass(this,ASJS.AbstractBitmapFilter,null,function(scp,spr){var _adjustment=adjustment||1;scp.execute=function(pixels){var d=pixels.data;var i=-4;var l=d.length;while((i+=4)<l){d[i+3]*=_adjustment;};return pixels;}});};ASJS.MaskBitmapFilter=function(mask,pos,invert,cutout){return createClass(this,ASJS.AbstractBitmapFilter,null,function(scp,spr){var _mask=mask;var _pos=pos;var _invert=invert;var _cutout=cutout==undefined?true:cutout;scp.execute=function(pixels){var srcD=pixels.data;var maskPixels=mask.getImageData(0,0,mask.bitmapWidth,mask.bitmapHeight);var maskD=maskPixels.data;var srcW=pixels.width;var maskW=maskPixels.width;var maskH=maskPixels.height;var maxMaskW=_pos.x+maskW;var maxMaskH=_pos.y+maskH;var i=-4;var l=srcD.length;while((i+=4)<l){var srcPixelLinearPos=Math.floor(i/4);var srcPixelPos=new ASJS.Point(Math.floor(srcPixelLinearPos%srcW),Math.floor(srcPixelLinearPos/srcW));if(srcPixelPos.x>=_pos.x&&srcPixelPos.y>=_pos.y&&srcPixelPos.x<maxMaskW&&srcPixelPos.y<maxMaskH){var j=((srcPixelPos.y-_pos.y)*maskW+(srcPixelPos.x-_pos.x))*4;var sA=srcD[i+3];var mA=maskD[j+3];srcD[i+3]=Math.floor(sA*((_invert?(255-mA):mA)/255));}else if(_cutout)srcD[i+3]=0;};return pixels;}});};ASJS.PixelateBitmapFilter=function(value){return createClass(this,ASJS.AbstractBitmapFilter,null,function(scp,spr){var _value=Math.max(1,value||1);scp.execute=function(pixels){var d=pixels.data;var pixS=_value;var w=pixels.width;var h=pixels.height;var step=4*pixS;var i=-step;var l=d.length;while((i+=step)<l){var pixelLinearPos=Math.floor(i/4);var pixelPos=new ASJS.Point(Math.floor(pixelLinearPos%w),Math.floor(pixelLinearPos/w));if(pixelPos.x%pixS>0)i=i-pixelPos.x*4-step;else if((pixelPos.y%pixS)==0){var x;var y;var r=0;var g=0;var b=0;var a=0;var maxW=Math.min(w-pixelPos.x,pixS);var maxH=Math.min(h-pixelPos.y,pixS);x=-1;while(++x<maxW){y=-1;while(++y<maxH){var pos=i+y*4*w+x*4;r+=d[pos];g+=d[pos+1];b+=d[pos+2];a+=d[pos+3];}};var pb=maxW*maxH;r=Math.round(r/pb);g=Math.round(g/pb);b=Math.round(b/pb);a=Math.round(a/pb);x=-1;while(++x<maxW){y=-1;while(++y<maxH){var pos=i+y*4*w+x*4;d[pos]=r;d[pos+1]=g;d[pos+2]=b;d[pos+3]=a;}}}};return pixels;}});};ASJS.BitmapBounds={};roFunc(ASJS.BitmapBounds,"execute",function(bitmap){var pixels=bitmap.getImageData(0,0,bitmap.bitmapWidth,bitmap.bitmapHeight);var d=pixels.data;var w=pixels.width;var size=new ASJS.Rectangle(pixels.width,pixels.height,0,0);var i=-4;var l=d.length;while((i+=4)<l){if(d[i+3]>0){var pixelLinearPos=Math.floor(i/4);var pixelPos=new ASJS.Point(Math.floor(pixelLinearPos%w),Math.floor(pixelLinearPos/w));if(pixelPos.x<size.x)size.x=pixelPos.x;if(pixelPos.y<size.y)size.y=pixelPos.y;if(pixelPos.x-size.x+1>size.width)size.width=pixelPos.x-size.x+1;if(pixelPos.y-size.y+1>size.height)size.height=pixelPos.y-size.y+1;}};return size;});ASJS.Cell=function(tag){return createClass(this,ASJS.Sprite,null,function(scp,spr){var _data={};var _checked=false;scp.new=function(){scp.setCSS("position","relative");scp.mouseChildren=false;scp.addEventListener(ASJS.MouseEvent.CLICK,onClick);};prop(scp,"name",{get:function(){return scp.getAttr("name");},set:function(v){scp.setAttr("name",v);}});prop(scp,"checked",{get:function(){return _checked;},set:function(v){_checked=v;}});prop(scp,"data",{get:function(){return _data;},set:function(v){_data=v;if(_data.id)scp.id=_data.id;scp.showData();}});scp.render=function(){};scp.showData=function(){};function onClick(e){scp.dispatchEvent(ASJS.Cell.CLICK,{ctrlKey:e.ctrlKey,shiftKey:e.shiftKey});}});};cnst(ASJS.Cell,"CLICK","ASJS-Cell-click");ASJS.CustomList=function(){return createClass(this,ASJS.Sprite,null,function(scp,spr){var _multiselect=false;var _cell=ASJS.Cell;var _lastCellIndex=0;var _itemsContainer=new ASJS.Sprite();var _name="";scp.new=function(){_itemsContainer.setCSS("position","relative");_itemsContainer.setSize("auto","auto");_itemsContainer.addEventListener(ASJS.Cell.CLICK,onCellClick);scp.addChild(_itemsContainer);};prop(scp,"length",{get:function(){return _itemsContainer.numChildren;}});prop(scp,"cell",{set:function(v){_cell=v;}});prop(scp,"multiselect",{get:function(){return _multiselect;},set:function(v){_multiselect=v;}});prop(scp,"selected",{get:function(){var v=[];var i=-1;var l=scp.length;while(++i<l){var item=scp.getCellAt(i);if(item.checked)v.push(item);};return v;},set:function(v){scp.clearSelection();var j=-1;var l=scp.length;var vLength=scp.multiselect?v.length:1;while(++j<vLength){var i=-1;while(++i<l){if(i==v[j])scp.getCellAt(i).checked=true;}}}});prop(scp,"name",{get:function(){return _name;},set:function(v){_name=v;var i=-1;var l=scp.length;while(++i<l)scp.getCellAt(i).name=_name;}});scp.clearSelection=function(){var i=-1;var l=scp.length;while(++i<l)scp.getCellAt(i).checked=false;};scp.clearList=function(){while(scp.length>0)_itemsContainer.removeChildAt(0);};scp.setList=function(cellDataVoList){scp.clearList();var i=-1;var l=cellDataVoList.length;while(++i<l)scp.addItem(cellDataVoList[i]);};scp.getList=function(){var list=[];var i=-1;var l=scp.length;while(++i<l)list.push(scp.getItemAt(i));return list;};scp.getCellAt=function(index){return index<0||index>=scp.length?null:_itemsContainer.getChildAt(index);};scp.getItemAt=function(index){var cell=scp.getCellAt(index);return cell?cell.data:null;};scp.getCellById=function(id){var i=-1;var l=scp.length;while(++i<l){var cell=scp.getCellAt(i);if(cell.id==id)return cell;};return null;};scp.getItemById=function(id){var cell=scp.getCellById(id);return cell?cell.data:null;};scp.addItem=function(cellDataVo){var cell=new _cell();cell.name=_name;cell.data=cellDataVo;return _itemsContainer.addChild(cell);};scp.addItemAt=function(cellDataVo,index){return _itemsContainer.setChildIndex(scp.addItem(cellDataVo),index);};scp.removeCell=function(cell){if(!cell||!_itemsContainer.contains(cell))return;_itemsContainer.removeChild(cell);};scp.removeCellById=function(id){scp.removeCell(scp.getCellById(id));};scp.render=function(){var i=-1;var l=scp.length;while(++i<l){var cell=scp.getCellAt(i);cell.setSize(scp.width,scp.height);cell.render();}};function onCellClick(e){var cell=_itemsContainer.getChildByDOMObject(e.target);if(!cell)return;if(!scp.multiselect||(!e.detail.ctrlKey&&!e.detail.shiftKey))scp.clearSelection();cell.checked=e.detail.ctrlKey?!cell.checked:true;var cellIndex=_itemsContainer.getChildIndex(cell);if(scp.multiselect&&!e.detail.ctrlKey&&e.detail.shiftKey){var i=-1;var l=Math.abs(cellIndex-_lastCellIndex);var step=cellIndex>_lastCellIndex?-1:1;while(++i<l){cell=scp.getCellAt(cellIndex+((i+1)*step));cell.checked=true;}};_lastCellIndex=cellIndex;scp.dispatchEvent(ASJS.CustomList.CHANGE);}});};cnst(ASJS.CustomList,"CHANGE","ASJS-CustomList-change");ASJS.CellDataVo=function(data){return createClass(this,Object,null,function(scp,spr){scp.id;scp.new=function(){var d=data||{};scp.id=d.id||null;}});};ASJS.FormElement=function(tag){return createClass(this,ASJS.Sprite,null,function(scp,spr){scp.new=function(){scp.tabIndex="auto";};prop(scp,"name",{get:function(){return scp.getAttr("name");},set:function(v){scp.setAttr("name",v);}});scp.render=function(){};});};ASJS.AbstractTextElement=function(tag){return createClass(this,ASJS.FormElement,null,function(scp,spr){var _protectedChars=[ASJS.Keyboard.LEFT_ARROW,ASJS.Keyboard.UP_ARROW,ASJS.Keyboard.RIGHT_ARROW,ASJS.Keyboard.DOWN_ARROW,ASJS.Keyboard.BACKSPACE,ASJS.Keyboard.TAB,ASJS.Keyboard.DELETE,ASJS.Keyboard.ENTER,ASJS.Keyboard.SHIFT,ASJS.Keyboard.CTRL,ASJS.Keyboard.END,ASJS.Keyboard.HOME,ASJS.Keyboard.CAPS_LOCK,ASJS.Keyboard.ESCAPE];var _controlChars=[ASJS.Keyboard.A,ASJS.Keyboard.C,ASJS.Keyboard.V,ASJS.Keyboard.X,ASJS.Keyboard.NUMPAD_1,ASJS.Keyboard.NUMPAD_3,ASJS.Keyboard.F7,ASJS.Keyboard.F9];var _restrict;scp.new=function(){scp.addEventListener(ASJS.KeyboardEvent.KEY_PRESS,onKeyPress);scp.addEventListener(ASJS.KeyboardEvent.KEY_UP,onKeyUp);scp.addEventListener(ASJS.Event.CHANGE,onChange);};prop(scp,"readonly",{get:function(){return scp.getAttr("readonly");},set:function(v){if(v)scp.setAttr("readonly","readonly");else scp.removeAttr("readonly");}});prop(scp,"placeholder",{get:function(){return scp.getAttr("placeholder");},set:function(v){scp.setAttr("placeholder",v);}});prop(scp,"val",{get:function(){return scp.el.value;},set:function(v){scp.el.value=v;}});prop(scp,"maxChar",{get:function(){return scp.getAttr("maxLength");},set:function(v){scp.setAttr("maxLength",v);}});prop(scp,"restrict",{get:function(){return _restrict;},set:function(v){_restrict=v;}});prop(scp,"autofocus",{get:function(){return scp.getAttr("autofocus");},set:function(v){if(v)scp.setAttr("autofocus","autofocus");else scp.removeAttr("autofocus");}});function onKeyPress(e){if(_restrict){var charCode=e.which?e.which:e.keyCode;if(_protectedChars.indexOf(e.keyCode)>-1||(e.ctrlKey&&_controlChars.indexOf(charCode)>-1))return;if(!new RegExp(_restrict,"i").test(String.fromCharCode(e.which)))return false;}};function onKeyUp(e){var charCode=e.which?e.which:e.keyCode;if(e.ctrlKey&&_controlChars.indexOf(charCode)>-1)onChange(e);};function onChange(){if(_restrict)scp.val=scp.val.replace(new RegExp("(?!"+_restrict+").","g"),'');}});};ASJS.Button=function(){return createClass(this,ASJS.FormElement,["input"],function(scp,spr){scp.new=function(){scp.setAttr("type","button");};prop(scp,"label",{get:function(){return scp.getAttr("value");},set:function(v){scp.setAttr("value",v);}});prop(scp,"submit",{get:function(){return scp.getAttr("type")=="submit";},set:function(v){scp.setAttr("type",v?"submit":"button");}});});};ASJS.Checkbox=function(){return createClass(this,ASJS.FormElement,["label"],function(scp,spr){var _checkbox=new ASJS.DisplayObject("input");var _label=new ASJS.DisplayObject();scp.new=function(){_checkbox.setAttr("type","checkbox");_checkbox.visible=false;scp.addChild(_checkbox);_label.setSize("100%","100%");_label.enabled=false;scp.addChild(_label);};prop(scp,"label",{get:function(){return _label;}});prop(scp,"checkbox",{get:function(){return _checkbox;}});prop(scp,"enabled",{set:function(v){spr.enabled=_checkbox.enabled=v;scp.render();}});prop(scp,"name",{get:function(){return _checkbox.getAttr("name");},set:function(v){_checkbox.setAttr("name",v);}});prop(scp,"checked",{get:function(){return _checkbox.el.checked;},set:function(v){_checkbox.el.checked=v;_checkbox.el.change();}});});};ASJS.DropDownOption=function(value,label,disabled,selected){return createClass(this,ASJS.PrimitiveDisplayObject,["option"],function(scp,spr){scp.new=function(){scp.value=value||0;scp.label=label||"";scp.disabled=disabled||false;scp.selected=selected||false;};prop(scp,"value",{get:function(){return scp.getAttr("value");},set:function(v){scp.setAttr("value",v);}});prop(scp,"label",{get:function(){return scp.text;},set:function(v){scp.text=v;}});prop(scp,"selected",{get:function(){return scp.getAttr("selected");},set:function(v){if(v)scp.setAttr("selected","selected");else scp.removeAttr("selected");}});prop(scp,"disabled",{get:function(){return scp.getAttr("disabled");},set:function(v){if(v)scp.setAttr("disabled","disabled");else scp.removeAttr("disabled");}});});};ASJS.DropDown=function(){return createClass(this,ASJS.FormElement,null,function(scp,spr){var _select=new ASJS.Sprite("select");scp.new=function(){scp.setCSS("overflow","hidden");scp.addChild(_select);};prop(scp,"select",{get:function(){return _select;}});prop(scp,"enabled",{set:function(v){spr.enabled=_select.enabled=v;scp.render();}});prop(scp,"name",{get:function(){return _select.getAttr("name");},set:function(v){_select.setAttr("name",v);}});prop(scp,"val",{get:function(){return _select.el.value;},set:function(v){_select.el.value=v;}});scp.clearOptions=function(){_select.html="";};scp.setOptions=function(options){scp.clearOptions();var i=-1;var l=options.length;while(++i<l)scp.addOption(options[i]);};scp.addOption=function(option){_select.addChild(option);};scp.render=function(){_select.setSize(scp.width+30,scp.height);}});};ASJS.FileSelector=function(){return createClass(this,ASJS.FormElement,null,function(scp,spr){scp._fileInput=new ASJS.DisplayObject("input");var _preview=new ASJS.Sprite();scp.new=function(){scp._fileInput.setAttr("type","file");scp._fileInput.addEventListener(ASJS.Event.CHANGE,scp._onChange);scp._fileInput.visible=false;scp.addChild(scp._fileInput);_preview.setSize("100%","100%");_preview.move(0,0);scp.addChild(_preview);scp.addEventListener(ASJS.MouseEvent.CLICK,onClick);};prop(scp,"preview",{get:function(){return _preview;}});prop(scp,"val",{get:function(){return scp._fileInput.el.value;}});prop(scp,"fileInput",{get:function(){return _fileInput;}});prop(scp,"enabled",{set:function(v){spr.enabled=scp._fileInput.enabled=v;scp.render();}});prop(scp,"name",{get:function(){return scp._fileInput.getAttr("name");},set:function(v){scp._fileInput.setAttr("name",v);}});scp._onChange=function(){_preview.text=scp.val;scp.dispatchEvent(ASJS.FileSelector.ON_CHANGE);};function onClick(e){if(e.target==scp._fileInput.el)return;scp._fileInput.el.click();}});};cnst(ASJS.FileSelector,"ON_CHANGE","ASJS-FileSelector-onChange");ASJS.Form=function(){return createClass(this,ASJS.Sprite,["form"],function(scp,spr){prop(scp,"action",{get:function(){return scp.getAttr("action");},set:function(v){scp.setAttr("action",v);}});prop(scp,"method",{get:function(){return scp.getAttr("method");},set:function(v){scp.setAttr("method",v);}});prop(scp,"enctype",{get:function(){return scp.getAttr("enctype");},set:function(v){scp.setAttr("enctype",v);}});scp.reset=function(){scp.el.reset();};scp.submit=function(){scp.el.submit();}});};cnst(ASJS.Form,"ENCTYPE_MULTIPART","multipart/form-data");ASJS.ImageSelector=function(){return createClass(this,ASJS.FileSelector,null,function(scp,spr){var _reader=new FileReader();scp.new=function(){_reader.onload=readerOnLoad;};scp._onChange=function(){var target=scp._fileInput.el;if(target.files&&target.files[0]){scp.dispatchEvent(ASJS.ImageSelector.ON_CHANGE_START);_reader.readAsDataURL(target.files[0]);}};function readerOnLoad(e){scp.preview.setCSS('background-image','url('+e.target.result+')');scp.dispatchEvent(ASJS.FileSelector.ON_CHANGE);}});};cnst(ASJS.ImageSelector,"ON_CHANGE_START","ASJS-ImageSelector-onChangeStart");ASJS.TextArea=function(){return createClass(this,ASJS.AbstractTextElement,["textarea"]);};ASJS.TextInput=function(){return createClass(this,ASJS.AbstractTextElement,["input"],function(scp,spr){scp.new=function(){scp.type=ASJS.TextInput.TYPE_TEXT;};prop(scp,"type",{get:function(){return scp.getAttr("type");},set:function(v){scp.setAttr("type",v);}});});};cnst(ASJS.TextInput,"TYPE_TEXT","text");cnst(ASJS.TextInput,"TYPE_PASSWORD","password");cnst(ASJS.TextInput,"TYPE_EMAIL","email");cnst(ASJS.TextInput,"TYPE_NUMBER","number");ASJS.RadioButton=function(){return createClass(this,ASJS.FormElement,["label"],function(scp,spr){var _radio=new ASJS.DisplayObject("input");var _label=new ASJS.DisplayObject();scp.new=function(){_radio.setAttr("type","radio");_radio.visible=false;scp.addChild(_radio);_label.setSize("100%","100%");_label.enabled=false;scp.addChild(_label);};prop(scp,"radio",{get:function(){return _radio;}});prop(scp,"enabled",{set:function(v){spr.enabled=_radio.enabled=v;scp.render();}});prop(scp,"name",{get:function(){return _radio.getAttr("name");},set:function(v){_radio.setAttr("name",v);}});prop(scp,"checked",{get:function(){return _radio.el.checked;},set:function(v){_radio.el.checked=v;if(v)_radio.el.change();}});prop(scp,"val",{get:function(){return _radio.value;},set:function(v){_radio.value=v;}});scp.render=function(){};});};ASJS.AbstractFilter=function(){return createClass(this,Object,null,function(scp,spr){scp.execute=function(){}});};ASJS.ContrastFilter=function(value){return createClass(this,ASJS.AbstractFilter,null,function(scp,spr){scp.execute=function(){return"contrast("+value+"%)";}});};ASJS.InvertFilter=function(value){return createClass(this,ASJS.AbstractFilter,null,function(scp,spr){scp.execute=function(){return"invert("+value+"%)";}});};ASJS.BlurFilter=function(value){return createClass(this,ASJS.AbstractFilter,null,function(scp,spr){scp.execute=function(){return"blur("+value+"px)";}});};ASJS.GrayscaleFilter=function(value){return createClass(this,ASJS.AbstractFilter,null,function(scp,spr){scp.execute=function(){return"grayscale("+value+"%)";}});};ASJS.SaturateFilter=function(value){return createClass(this,ASJS.AbstractFilter,null,function(scp,spr){scp.execute=function(){return"saturate("+value+"%)";}});};ASJS.BrightnessFilter=function(value){return createClass(this,ASJS.AbstractFilter,null,function(scp,spr){scp.execute=function(){return"brightness("+value+"%)";}});};ASJS.HueRotateFilter=function(value){return createClass(this,ASJS.AbstractFilter,null,function(scp,spr){scp.execute=function(){return"hue-rotate("+value+"deg)";}});};ASJS.SepiaFilter=function(value){return createClass(this,ASJS.AbstractFilter,null,function(scp,spr){scp.execute=function(){return"sepia("+value+"%)";}});};ASJS.DropShadowFilter=function(h,v,blur,spread,color){return createClass(this,ASJS.AbstractFilter,null,function(scp,spr){scp.execute=function(){return"drop-shadow("+h+"px "+v+"px "+blur+"px "+spread+"px "+color+")";}});};ASJS.NotificationHandler=function(){return createSingletonClass(ASJS.NotificationHandler,this,Object,null,function(scp,spr){var _handlers={};scp.register=function(dispatcher,handlers){if(!dispatcher||!handlers)return;var i=-1;var l=handlers.length;while(++i<l){var type=handlers[i];if(_handlers[type]&&_handlers[type].indexOf(dispatcher)>-1)break;if(!_handlers[type])_handlers[type]=[];_handlers[type].push(dispatcher);}};scp.remove=function(dispatcher){if(!dispatcher.handlers)return;var i=-1;var l=dispatcher.handlers.length;while(++i<l){var type=dispatcher.handlers[i];if(_handlers[type]){var index=_handlers[type].indexOf(dispatcher);if(index>-1)_handlers[type].splice(index,1);}}};scp.sendNotification=function(type,data){if(!_handlers[type])return;var i=-1;var l=_handlers[type].length;while(++i<l){if(_handlers[type][i]){_handlers[type][i].reciveNotification(type,data);}else{_handlers[type].splice(i,1);l--;}}}});};ASJS.NotificationDispatcher=function(){return createClass(this,Object,null,function(scp,spr){scp._handlers=[];var _nHandler=new ASJS.NotificationHandler();scp.new=function(){registerHandlers();};scp.destruct=function(){removeHandlers();};scp.sendNotification=function(type,data){_nHandler.sendNotification(type,data);};scp.reciveNotification=function(type,data){};function registerHandlers(){_nHandler.register(scp,scp._handlers);};function removeHandlers(){_nHandler.remove(scp);}});};ASJS.AbstractCommand=function(){return createClass(this,ASJS.NotificationDispatcher,null,function(scp,spr){scp.execute=function(){}});};ASJS.AbstractMediator=function(view){return createClass(this,ASJS.NotificationDispatcher,null,function(scp,spr){scp._view=view;});};ASJS.AbstractModel=function(){return createClass(this,ASJS.EventDispatcher,null,function(scp,spr){var priv={};cnst(priv,"PREFIX","ASJS-AbstractModel-");var _data={};prop(scp,"data",{get:function(){return _data;},set:function(v){_data=v;scp.dispatchEvent(ASJS.AbstractModel.CHANGED);}});scp.get=function(k){return _data&&_data[k]?_data[k]:null;};scp.set=function(k,v){if(!_data)_data={};var o=_data[k];_data[k]=v;scp.dispatchEvent(ASJS.AbstractModel.CHANGED);scp.dispatchEvent(priv.PREFIX+k,[o,v]);};scp.clear=function(){_data=null;scp.dispatchEvent(ASJS.AbstractModel.CLEARED);};scp.watch=function(k,l){scp.addEventListener(priv.PREFIX+k,l);};scp.merge=function(d){merge(_data,d);};function merge(oData,nData){for(var nk in nData){if(typeof oData[nk]=="object")merge(oData[nk],nData[nk]);else oData[nk]=nData[nk];}}});};cnst(ASJS.AbstractModel,"CHANGED","ASJS-AbstractModel-changed");cnst(ASJS.AbstractModel,"CLEARED","ASJS-AbstractModel-cleared");