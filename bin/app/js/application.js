;function Config(){return createSingletonClass(Config,this,ASJS.AbstractModel,null,function(scp,spr){scp.construct=function(){}});};function JSONLoader(){return createClass(this,ASJS.Loader,null,function(scp,spr){scp.construct=function(){scp.responseType="json";}});};function DataProxy(){return createSingletonClass(DataProxy,this,Object,null,function(scp,spr){scp.construct=function(){};scp.loadJSON=function(url){var _v0=new $.Deferred();var _v1=new JSONLoader();_v1.method=ASJS.RequestMethod.GET;_v1.addEventListener(ASJS.LoaderEvent.LOAD,function(e){_v0.resolve(_v1.content);});_v1.addEventListener(ASJS.LoaderEvent.ERROR,function(e){_v0.reject(_v1.content);});_v1.load(url);return _v0.promise();};scp.loadAnimation=function(url){return(new ASJS.AnimationLoader()).load(url);}});};function ConfigLoaderCommand(){return createClass(this,ASJS.AbstractCommand,null,function(scp,spr){var _v0=new Config();var _v1=new DataProxy();scp.construct=function(){};scp.execute=function(){var _v2=_v1.loadJSON("json/config.json");_v2.done(function(response){_v0.data=response;});return _v2;}});};function Language(){return createSingletonClass(Language,this,ASJS.AbstractModel,null,function(scp,spr){var _v0={};var _v2;var _v1;scp.construct=function(){};prop(scp,"supportedLanguages",{get:function(){return _v2;}});prop(scp,"data",{set:function(v){spr.data=v.elements;_v2=v.supported_languages;_v1=v.default_language;}});prop(scp,"selectedLanguage",{get:function(){return _v1;},set:function(v){_v1=v;}});scp.getText=function(k){var i=scp.get(k);return i!=null&&i[scp.selectedLanguage]!=undefined?i[scp.selectedLanguage]:"";};scp.genText=function(str){for(var k in scp.data)str=str.split("{{"+k+"}}").join(scp.getText(k));return str;}});};function LanguageLoaderCommand(){return createClass(this,ASJS.AbstractCommand,null,function(scp,spr){var _v1=new Language();var _v0=new DataProxy();scp.construct=function(){};scp.execute=function(){var _v2=_v0.loadJSON("json/language.json");_v2.done(function(response){_v1.data=response;});return _v2;}});};var Tools={};roFunc(Tools,"replaceText",function(s,o){var r=/{{.*?}}/g;var rt=s;var m;while((m=r.exec(s))!==null){if(m.index===r.lastIndex)r.lastIndex++;var e=m[0].split("{{").join("").split("}}").join("");var c=Tools.ref(o,e);rt=rt.replace(m[0],c!=null?c:m[0]);};return rt;});roFunc(Tools,"ref",function(o,s){return s.split(".").reduce(function(o,x){return o[x];},o);});roFunc(Tools,"isValidEmailAddress",function(email){var re=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(email);});roFunc(Tools,"getURLParams",function(param){var _v2=decodeURIComponent(new ASJS.Window().location.href).split("#");if(_v2[1]==''||_v2[1]==undefined)return[];var _v1=_v2[1].split('&');var i=-1;var l=_v1.length;var _v3={};while(++i<l){var _v0=_v1[i].split('=');_v3[_v0[0]]=_v0[1];};return _v3[param];});roFunc(Tools,"createUrlParams",function(_v1){var _v2="";for(var k in _v1){if(_v2!="")_v2+="&";_v2+=k+"="+_v1[k];};new ASJS.Window().location.href='#'+_v2;Tools.reload();});roFunc(Tools,"reload",function(){new ASJS.Window().location.reload(true);});function Cookies(){return createSingletonClass(Cookies,this,Object,null,function(scp,spr){scp.construct=function(){};scp.createCookie=function(n,v,d){if(d){var _v0=new Date();_v0.setTime(_v0.getTime()+(d*86400000));var _v1="; _v1="+_v0.toGMTString();}else var _v1="";document.cookie=n+"="+v+_v1+"; path=/";try{if(typeof(Storage)!=="undefined")localStorage[n]=v;}catch(e){trace(e);}};scp.readCookie=function(n){var _v2=n+"=";var ca=document.cookie.split(';');var i=-1;var l=ca.length;while(++i<l){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(_v2)==0)return c.substring(_v2.length,c.length);};try{if(typeof(Storage)!=="undefined")return localStorage[n];}catch(e){trace(e);};return null;};scp.eraseCookie=function(n){scp.createCookie(n,"",-1);try{if(typeof(Storage)!=="undefined")delete localStorage[n];}catch(e){trace(e);}}});};function EnvironmentCommand(){return createClass(this,ASJS.AbstractCommand,null,function(scp,spr){var _v5=new ASJS.Window();var _v3=new Language();var _v1=new Cookies();var _v2=new ASJS.Cycler();var _v0=new Config();var _v4;scp.construct=function(){};scp.execute=function(){_v10();_v9();_v11();};function _v10(){var _v8=Tools.getURLParams('lang');if(_v8==undefined||_v3.supportedLanguages.indexOf(_v8)==-1)_v8=_v1.readCookie('language');if(_v8==undefined||_v3.supportedLanguages.indexOf(_v8)==-1)_v8=_v3.selectedLanguage;_v3.selectedLanguage=_v8;_v1.createCookie('language',_v3.selectedLanguage);stage.title=_v3.getText("title");};function _v9(){_v2.fps=_v0.get("fps");_v2.start();};function _v11(){stage.addEventListener(ASJS.Stage.RESIZE,_v6);};function _v6(){_v4=_v5.clearTimeout(_v4);_v4=_v5.setTimeout(_v7,_v0.get("resizeInterval"));};function _v7(){_v4=_v5.clearTimeout(_v4);scp.sendNotification(ASJS.Stage.RESIZE);}});};function AbstractResizeMediator(view){return createClass(this,ASJS.AbstractMediator,null,function(scp,spr){scp._handlers=[ASJS.Stage.RESIZE];scp.construct=function(){};scp.reciveNotification=function(type,data){switch(type){case ASJS.Stage.RESIZE:scp._onResize();break;}};scp._onResize=function(){}});};function AbstractView(){return createClass(this,ASJS.Sprite,null,function(scp,spr){var _v1={alpha:0};var _v0=new ASJS.Easing();scp.construct=function(){scp.addEventListener(ASJS.Stage.ADDED_TO_STAGE,_v2);};scp._animateTo=function(to,completeCallback){_v1={alpha:scp.alpha};_v0.stop();_v0.play(_v1,{alpha:to},1000,"easeInOutExpo",function(){scp.alpha=_v1.alpha;},completeCallback);};function _v2(){scp.alpha=0;scp._animateTo(1);}});};function ContentView(){return createClass(this,AbstractView,null,function(scp,spr){var _v18={};cnst(_v18,"ANIMATION_EXPLODE_ID","animationExplode");cnst(_v18,"ANIMATION_FIREWORKS_ID","animationFireworks");var _v13=new Language();var _v12=new ASJS.Mouse();var _v10=new ASJS.Sprite();var _v17=new ASJS.Sprite();var _v14=new ASJS.Label();var _v16=new ASJS.Button();var _v0=new ASJS.AnimatedSprite();var _v15=false;scp.construct=function(){scp.addEventListener(ASJS.Stage.ADDED_TO_STAGE,_v11);};scp.drawNow=function(){_v10.setSize(stage.stageWidth,stage.stageHeight);_v17.x=(stage.stageWidth-_v17.width)*0.5;};scp.init=function(data){_v10.addClass("background");_v10.setCSS("position","fixed");_v10.alpha=0.5;scp.addChild(_v10);_v17.addClass("box");_v17.setSize(320,130);_v17.y=100;scp.addChild(_v17);_v14.text=_v13.getText("new_asjs_base_site");_v14.addClass("box_label");_v14.setSize(320,30);_v14.move(0,34);_v17.addChild(_v14);_v16.label=_v13.getText("show_notification_window");_v16.addClass("box_button");_v16.setSize(320,40);_v16.move(0,_v17.height-_v16.height);_v16.addEventListener(ASJS.MouseEvent.CLICK,_v7);_v17.addChild(_v16);_v0.addAnimationDescriptorList(data);_v0.move(10,10);scp.addChild(_v0);_v0.addEventListener(ASJS.MouseEvent.CLICK,_v1);_v0.addEventListener(ASJS.MouseEvent.MOUSE_DOWN+" "+ASJS.MouseEvent.TOUCH_START,_v8);stage.addEventListener(ASJS.MouseEvent.MOUSE_UP+" "+ASJS.MouseEvent.TOUCH_END,_v6);stage.addEventListener(ASJS.MouseEvent.MOUSE_LEAVE,_v6);stage.addEventListener(ASJS.MouseEvent.MOUSE_MOVE+" "+ASJS.MouseEvent.TOUCH_MOVE,_v4);scp.addEventListener(ASJS.MouseEvent.CLICK,_v5);scp.drawNow();};function _v11(){_v2();};function _v7(){scp.dispatchEvent(ContentMediator.ON_SHOW_NOTIFICATION_WINDOW_CLICK);};function _v3(){if(!_v0)return;_v0.setSize(256,128);_v0.play(_v18.ANIMATION_EXPLODE_ID,ASJS.AnimatedSprite.PLAY_REVERSE);};function _v2(){if(!_v0)return;_v0.setSize(200,200);_v0.play(_v18.ANIMATION_FIREWORKS_ID);};function _v1(){if(_v0.selectedAnimation==_v18.ANIMATION_FIREWORKS_ID)_v3();else _v2();};function _v8(){_v15=true;};function _v6(){_v15=false;};function _v4(){scp.filters=[new ASJS.BlurFilter((Math.max(0,stage.stageHeight/(stage.stageHeight-_v12.mouseY))/10))];if(!_v15)return;_v0.move(_v12.mouseX-_v0.width*0.5,_v12.mouseY-_v0.height*0.5);};function _v5(){var _v9=_v17.hitTest(new ASJS.Point(_v12.mouseX,_v12.mouseY));_v14.text=_v13.getText(_v9?"hit_test_inside":"hit_test_outside");}});};function NotificationWindowView(){return createClass(this,AbstractView,null,function(scp,spr){var _v2={};var _v5=new ASJS.Scale9Grid();var _v4=new ASJS.Sprite();var _v1=new ASJS.Sprite();var _v3=new ASJS.Button();var _v0=new ASJS.Button();scp.construct=function(){scp.setCSS("background-color","rgba( 0, 0, 0, 0.4 )");scp.setSize("100%","100%");scp.setCSS("position","fixed");_v5.size=new ASJS.Point(30,80);_v5.rect=new ASJS.Rectangle(13,60,4,7);_v5.backgroundImage="images/window.png";scp.addChild(_v5);_v4.height=50;_v4.setCSS("line-height",_v4.height+"px");_v4.addClass("notification_title");scp.addChild(_v4);_v1.addClass("notification_content");scp.addChild(_v1);_v3.addEventListener(ASJS.MouseEvent.CLICK,function(){scp.hideWindow();if(_v2['okCallback']!=undefined)_v2['okCallback']();});_v6(_v3);_v0.addEventListener(ASJS.MouseEvent.CLICK,function(){scp.hideWindow();if(_v2['cancelCallback']!=undefined)_v2['cancelCallback']();});_v6(_v0);};scp.hideWindow=function(){scp._animateTo(0,function(){scp.dispatchEvent(NotificationWindowMediator.HIDE);_v4.html="";_v1.html="";if(_v8())scp.removeChild(_v3);_v3.label="";if(_v7())scp.removeChild(_v0);_v0.label="";});};scp.showWindow=function(notificationItem){_v2=notificationItem;_v4.html=_v2.title;_v1.html=_v2.content;if(_v2['showOk']){_v3.label=_v2['okLabel'];if(!_v8())scp.addChild(_v3);}else if(_v8())scp.removeChild(_v3);if(_v2['showCancel']){_v0.label=_v2['cancelLabel'];if(!_v7())scp.addChild(_v0);}else if(_v7())scp.removeChild(_v0);};scp.drawNow=function(){_v5.setSize(Math.max(150,Math.min(scp.width,_v2.width)),Math.max(150,Math.min(scp.height,_v2.height)));_v5.move((scp.width-_v5.width)*0.5,Math.max(0,(scp.height-_v5.height)*0.5));_v5.drawNow();_v4.move(_v5.x+25,_v5.y+10);_v4.width=_v5.width-50;_v1.move(_v4.x,_v4.y+_v4.height+25);_v1.setSize(_v4.width,_v5.height-_v4.height-55-(_v8()||_v7()?60:0));if(_v1.drawNow)_v1.drawNow();_v3.width=_v5.width*0.5-20;if(_v8()){_v3.x=_v5.x+(_v7()?_v5.width*0.5-10-_v3.width:((_v5.width-_v3.width)*0.5));_v3.y=_v5.y+_v5.height-_v3.height-30;};_v0.width=_v3.width;if(_v7()){_v0.x=_v5.x+(_v8()?_v5.width*0.5+10:((_v5.width-_v0.width)*0.5));_v0.y=_v5.y+_v5.height-_v0.height-30;}};function _v8(){return scp.contains(_v3);};function _v7(){return scp.contains(_v0);};function _v6(target){target.addClass("notification_button");target.height=42;}});};function NotificationWindowDataVo(){return createClass(this,Object,null,function(scp,spr){scp.title="";scp.content="";scp.showOk=true;scp.showCancel=false;scp.okCallback=null;scp.cancelCallback=null;scp.okLabel=null;scp.cancelLabel=null;scp.width=500;scp.height=200;scp.construct=function(){}});};function NotificationWindowMediator(view){return createClass(this,AbstractResizeMediator,null,function(scp,spr){scp._handlers.push(NotificationWindowMediator.SHOW);var _v3=[];var _v4=false;var _v1="";var _v0="";var _v2=new NotificationWindowView();scp.construct=function(){_v2.addEventListener(NotificationWindowMediator.HIDE,_v5);};scp.reciveNotification=function(type,data){spr.reciveNotification(type,data);switch(type){case NotificationWindowMediator.SHOW:_v8(data);break;}};scp.setDefault=function(okLabel,cancelLabel){_v1=okLabel;_v0=cancelLabel;};scp._onResize=function(){if(scp._view.contains(_v2))_v2.drawNow();};function _v8(data){if(data==undefined)data=new NotificationDataVo();if(!data.okLabel)data.okLabel=_v1;if(!data.cancelLabel)data.cancelLabel=_v0;_v3.push(data);if(!_v4)_v9();};function _v5(){if(_v3.length>0)_v9();else _v6();};function _v6(){scp._view.removeChild(_v2);_v4=false;};function _v9(){var _v7=_v3[0];_v3.shift();_v4=true;_v2.showWindow(_v7);if(!scp._view.contains(_v2))scp._view.addChild(_v2);scp._onResize();}});};cnst(NotificationWindowMediator,"SHOW","NotificationWindowMediator-_v8");cnst(NotificationWindowMediator,"HIDE","NotificationWindowMediator-_v5");function ContentMediator(view){return createClass(this,AbstractResizeMediator,null,function(scp,spr){scp._handlers.push(ContentMediator.SHOW);var _v1=new DataProxy();var _v2=new Language();var _v0=new ContentView();scp.construct=function(){};scp.reciveNotification=function(type,data){spr.reciveNotification(type,data);switch(type){case ContentMediator.SHOW:_v5();break;}};scp._onResize=function(){if(scp._view.contains(_v0))_v0.drawNow();};function _v4(data){_v0.init(data);scp._view.addChild(_v0);};function _v5(){_v0.addEventListener(ContentMediator.ON_SHOW_NOTIFICATION_WINDOW_CLICK,function(){var _v3=new NotificationWindowDataVo();_v3.title=_v2.getText("notification_title");_v3.content=_v2.getText("notification_content");_v3.height=230;scp.sendNotification(NotificationWindowMediator.SHOW,_v3);});_v1.loadAnimation("json/animation/contentAnimation.json").done(_v4);scp._onResize();}});};cnst(ContentMediator,"SHOW","ContentMediator-show");cnst(ContentMediator,"ON_SHOW_NOTIFICATION_WINDOW_CLICK","ContentMediator-onShowNotificationWindowClick");function ViewPrepCommand(){return createClass(this,ASJS.AbstractCommand,null,function(scp,spr){var _v0=new Language();scp.construct=function(){};scp.execute=function(app){new ContentMediator(app.contentView);var _v1=new NotificationWindowMediator(app.notificationWindowView);_v1.setDefault(_v0.getText('notification_ok_button'),_v0.getText('notification_cancel_button'));}});};function StartupCommand(){return createClass(this,ASJS.AbstractCommand,null,function(scp,spr){var _v0;scp.construct=function(){};scp.execute=function(app){_v0=app;_v2();};function _v2(){(new ConfigLoaderCommand()).execute().done(_v3);};function _v3(){(new LanguageLoaderCommand()).execute().done(_v1);};function _v1(){(new EnvironmentCommand()).execute();(new ViewPrepCommand()).execute(_v0);scp.sendNotification(ContentMediator.SHOW);}});};function Application(){return createClass(this,Object,null,function(scp,spr){var _v0=new ASJS.Sprite();var _v1=new ASJS.Sprite();scp.construct=function(){trace("<AS/JS> 2.0 Application");stage.addChild(scp.contentView);stage.addChild(scp.notificationWindowView);(new StartupCommand()).execute(scp);};prop(scp,"contentView",{get:function(){return _v0;}});prop(scp,"notificationWindowView",{get:function(){return _v1;}});});};ASJS.start(Application);