;function Config(){return createSingletonClass(Config,this,ASJS.AbstractModel);};function JSONLoader(){return createClass(this,ASJS.Loader,null,function(v0,v1){v0.new=function(){v0.responseType="json";}});};function DataProxy(){return createSingletonClass(DataProxy,this,Object,null,function(v2,v3){v2.loadJSON=function(v0){var v1=new ASJS.Deferred();var v4=new JSONLoader();v4.method=ASJS.RequestMethod.GET;v4.addEventListener(ASJS.LoaderEvent.LOAD,function(e){v1.resolve(v4.content);});v4.addEventListener(ASJS.LoaderEvent.ERROR,function(e){v1.reject(v4.content);});v4.load(v0);return v1.promise;};v2.loadAnimation=function(v0){return(new ASJS.AnimationLoader()).load(v0);}});};function ConfigLoaderCommand(){return createClass(this,ASJS.AbstractCommand,null,function(v0,v1){var v2=new Config();var v5=new DataProxy();v0.execute=function(){var v3=v5.loadJSON("json/config.json");v3.resolve(function(v4){v2.data=v4;});return v3;}});};function Language(){return createSingletonClass(Language,this,ASJS.AbstractModel,null,function(v1,v2){prop(v1,"supportedLanguages",{get:function(){return v2.data.supportedLanguages;}});prop(v1,"selectedLanguage",{get:function(){return v2.data.selectedLanguage;}});v1.getText=function(k){var i=v1.get("elements")[k];return i!=null&&i[v1.selectedLanguage]!=undefined?i[v1.selectedLanguage]:"";};v1.genText=function(v0){for(var k in v1.data)v0=v0.split("{{"+k+"}}").join(v1.getText(k));return v0;}});};function LanguageLoaderCommand(){return createClass(this,ASJS.AbstractCommand,null,function(v0,v1){var v4=new Language();var v5=new DataProxy();v0.execute=function(){var v2=v5.loadJSON("json/language.json");v2.resolve(function(v3){v4.data=v3;});return v2;}});};var Tools={};roFunc(Tools,"replaceText",function(s,o){var r=/{{.*?}}/g;var rt=s;var m;while((m=r.exec(s))!==null){if(m.index===r.lastIndex)r.lastIndex++;var e=m[0].split("{{").join("").split("}}").join("");var c=Tools.ref(o,e);rt=rt.replace(m[0],c!=null?c:m[0]);};return rt;});roFunc(Tools,"ref",function(o,s){return s.split(".").reduce(function(o,x){return o[x];},o);});roFunc(Tools,"isValidEmailAddress",function(v3){var re=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(v3);});roFunc(Tools,"getURLParams",function(v2){var v0=decodeURIComponent(new ASJS.Window().location.href).split("#");if(v0[1]==''||v0[1]==undefined)return[];var v5=v0[1].split('&');var i=-1;var l=v5.length;var v7={};while(++i<l){var v1=v5[i].split('=');v7[v1[0]]=v1[1];};return v7[v2];});roFunc(Tools,"createUrlParams",function(v5,v4){var v0="";for(var k in v5){if(v0!="")v0+="&";v0+=k+"="+v5[k];};var v6=new ASJS.Window();v6.location.href=v6.location.href.split(v6.location.hash).join("")+"#"+v0;if(v4)Tools.reload();});roFunc(Tools,"reload",function(){new ASJS.Window().location.reload(true);});function Cookies(){return createSingletonClass(Cookies,this,Object,null,function(v1,v2){v1.createCookie=function(n,v,d){if(d){var v0=new Date();v0.setTime(v0.getTime()+(d*86400000));var v4="; expires="+v0.toGMTString();}else var v4="";document.cookie=n+"="+v+v4+"; path=/";try{if(typeof(Storage)!=="undefined")localStorage[n]=v;}catch(e){trace(e);}};v1.readCookie=function(n){var v3=n+"=";var ca=document.cookie.split(';');var i=-1;var l=ca.length;while(++i<l){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(v3)==0)return c.substring(v3.length,c.length);};try{if(typeof(Storage)!=="undefined")return localStorage[n];}catch(e){trace(e);};return null;};v1.eraseCookie=function(n){v1.createCookie(n,"",-1);try{if(typeof(Storage)!=="undefined")delete localStorage[n];}catch(e){trace(e);}}});};function EnvironmentCommand(){return createClass(this,ASJS.AbstractCommand,null,function(v0,v1){var v2=new ASJS.Window();var v6=new Language();var v5=new Cookies();var v3=new ASJS.Cycler();var v4=new Config();var v12;v0.execute=function(){v10();v9();v8();};function v10(){var v13=Tools.getURLParams('lang');if(v13==undefined||v6.supportedLanguages.indexOf(v13)==-1)v13=v5.readCookie('language');if(v13==undefined||v6.supportedLanguages.indexOf(v13)==-1)v13=v6.selectedLanguage;v6.set("selectedLanguage",v13);v5.createCookie('language',v6.selectedLanguage);stage.title=v6.getText("title");};function v9(){v3.fps=v4.get("fps");v3.start();};function v8(){stage.addEventListener(ASJS.Stage.RESIZE,v11);};function v11(){v12=v2.clearTimeout(v12);v12=v2.setTimeout(v7,v4.get("resizeInterval"));};function v7(){v12=v2.clearTimeout(v12);v0.sendNotification(ASJS.Stage.RESIZE);}});};function AbstractResizeMediator(view){return createClass(this,ASJS.AbstractMediator,null,function(v2,v3){v2._handlers=[ASJS.Stage.RESIZE];v2.reciveNotification=function(v0,v1){switch(v0){case ASJS.Stage.RESIZE:v2._onResize();break;}};v2._onResize=function(){}});};function AbstractView(){return createClass(this,ASJS.Sprite,null,function(v0,v1){var v4={alpha:0};var v2=new ASJS.Easing();v0.new=function(){v0.addEventListener(ASJS.Stage.ADDED_TO_STAGE,v3);};v0._animateTo=function(to,v5){v4={alpha:v0.alpha};v2.stop();v2.play(v4,{alpha:to},1000,"easeInOutExpo",function(){v0.alpha=v4.alpha;},v5);};function v3(){v0.alpha=0;v0._animateTo(1);}});};function ContentView(){return createClass(this,AbstractView,null,function(v6,v4){var v2={};cnst(v2,"ANIMATION_EXPLODE_ID","animationExplode");cnst(v2,"ANIMATION_FIREWORKS_ID","animationFireworks");var v10=new Language();var v7=new ASJS.Mouse();var v12=new ASJS.Sprite();var v1=new ASJS.Sprite();var v5=new ASJS.Label();var v8=new ASJS.Button();var v16=new ASJS.AnimatedSprite();var v3=false;v6.new=function(){v6.addEventListener(ASJS.Stage.ADDED_TO_STAGE,v13);};v6.render=function(){v12.setSize(stage.stageWidth,stage.stageHeight);v1.x=(stage.stageWidth-v1.width)*0.5;};v6.init=function(v0){v12.addClass("content-view--background");v12.setCSS("position","fixed");v12.alpha=0.5;v6.addChild(v12);v1.addClass("content-view--box");v1.setSize(320,130);v1.y=100;v6.addChild(v1);v5.text=v10.getText("new_asjs_base_site");v5.addClass("content-view--box--label");v5.setSize(320,30);v5.move(0,34);v1.addChild(v5);v8.label=v10.getText("show_notification_window");v8.addClass("content-view--box--button");v8.setSize(320,40);v8.move(0,v1.height-v8.height);v8.addEventListener(ASJS.MouseEvent.CLICK,v15);v1.addChild(v8);v16.addAnimationDescriptorList(v0);v16.move(10,10);v6.addChild(v16);v16.addEventListener(ASJS.MouseEvent.CLICK,v19);v16.addEventListener(ASJS.MouseEvent.MOUSE_DOWN+" "+ASJS.MouseEvent.TOUCH_START,v21);stage.addEventListener(ASJS.MouseEvent.MOUSE_UP+" "+ASJS.MouseEvent.TOUCH_END,v11);stage.addEventListener(ASJS.MouseEvent.MOUSE_LEAVE,v11);stage.addEventListener(ASJS.MouseEvent.MOUSE_MOVE+" "+ASJS.MouseEvent.TOUCH_MOVE,v17);v6.addEventListener(ASJS.MouseEvent.CLICK,v14);v6.render();};function v13(){v20();};function v15(){v6.dispatchEvent(ContentMediator.ON_SHOW_NOTIFICATION_WINDOW_CLICK);};function v18(){if(!v16)return;v16.setSize(256,128);v16.play(v2.ANIMATION_EXPLODE_ID,ASJS.AnimatedSprite.PLAY_REVERSE);};function v20(){if(!v16)return;v16.setSize(200,200);v16.play(v2.ANIMATION_FIREWORKS_ID);};function v19(){if(v16.selectedAnimation==v2.ANIMATION_FIREWORKS_ID)v18();else v20();};function v21(){v3=true;};function v11(){v3=false;};function v17(){v6.filters=[new ASJS.BlurFilter((Math.max(0,stage.stageHeight/(stage.stageHeight-v7.mouseY))/10))];if(!v3)return;v16.move(v7.mouseX-v16.width*0.5,v7.mouseY-v16.height*0.5);};function v14(){var v9=v1.hitTest(new ASJS.Point(v7.mouseX,v7.mouseY));v5.text=v10.getText(v9?"hit_test_inside":"hit_test_outside");}});};function NotificationWindowView(){return createClass(this,AbstractView,null,function(v0,v1){var v12={};var v4=new ASJS.Scale9Grid();var v2=new ASJS.Sprite();var v5=new ASJS.Sprite();var v6=new ASJS.Button();var v8=new ASJS.Button();v0.new=function(){v0.setCSS("background-color","rgba( 0, 0, 0, 0.4 )");v0.setCSS("position","fixed");v4.size=new ASJS.Point(30,80);v4.rect=new ASJS.Rectangle(13,60,4,7);v4.backgroundImage="images/window.png";v0.addChild(v4);v2.height=50;v2.setCSS("line-height",v2.height+"px");v2.addClass("notification-window-view--title-label");v0.addChild(v2);v5.addClass("notification-window-view--content-label");v0.addChild(v5);v6.addEventListener(ASJS.MouseEvent.CLICK,function(){v0.hideWindow();if(v12['okCallback']!=undefined)v12['okCallback']();});v10(v6);v8.addEventListener(ASJS.MouseEvent.CLICK,function(){v0.hideWindow();if(v12['cancelCallback']!=undefined)v12['cancelCallback']();});v10(v8);};v0.hideWindow=function(){v0._animateTo(0,function(){v0.dispatchEvent(NotificationWindowMediator.HIDE);v2.html="";v5.html="";if(v7())v0.removeChild(v6);v6.label="";if(v9())v0.removeChild(v8);v8.label="";});};v0.showWindow=function(v11){v12=v11;v2.html=v12.title;v5.html=v12.content;if(v12['showOk']){v6.label=v12['okLabel'];if(!v7())v0.addChild(v6);}else if(v7())v0.removeChild(v6);if(v12['showCancel']){v8.label=v12['cancelLabel'];if(!v9())v0.addChild(v8);}else if(v9())v0.removeChild(v8);};v0.render=function(){v0.setSize(stage.stageWidth,stage.stageHeight);v4.setSize(Math.max(150,Math.min(stage.stageWidth,v12.width)),Math.max(150,Math.min(stage.stageHeight,v12.height)));v4.move((stage.stageWidth-v4.width)*0.5,Math.max(0,(stage.stageHeight-v4.height)*0.5));v4.render();v2.move(v4.x+25,v4.y+10);v2.width=v4.width-50;v5.move(v2.x,v2.y+v2.height+25);v5.setSize(v2.width,v4.height-v2.height-55-(v7()||v9()?60:0));if(v5.render)v5.render();v6.width=v4.width*0.5-20;if(v7()){v6.x=v4.x+(v9()?v4.width*0.5-10-v6.width:((v4.width-v6.width)*0.5));v6.y=v4.y+v4.height-v6.height-30;};v8.width=v6.width;if(v9()){v8.x=v4.x+(v7()?v4.width*0.5+10:((v4.width-v8.width)*0.5));v8.y=v4.y+v4.height-v8.height-30;}};function v7(){return v0.contains(v6);};function v9(){return v0.contains(v8);};function v10(v3){v3.addClass("notification-window-view--button");v3.height=42;}});};function NotificationWindowDataVo(){return createClass(this,Object,null,function(v0,v1){v0.title="";v0.content="";v0.showOk=true;v0.showCancel=false;v0.okCallback=null;v0.cancelCallback=null;v0.okLabel=null;v0.cancelLabel=null;v0.width=500;v0.height=200;});};function NotificationWindowMediator(view){return createClass(this,AbstractResizeMediator,null,function(v5,v6){v5._handlers.push(NotificationWindowMediator.SHOW);var v4=[];var v7=false;var v12="";var v14="";var v15=new NotificationWindowView();v5.new=function(){v15.addEventListener(NotificationWindowMediator.HIDE,v3);};v5.reciveNotification=function(v1,v0){v6.reciveNotification(v1,v0);switch(v1){case NotificationWindowMediator.SHOW:v2(v0);break;}};v5.setDefault=function(v8,v11){v12=v8;v14=v11;};v5._onResize=function(){if(v5._view.contains(v15))v15.render();};function v2(v0){if(v0==undefined)v0=new NotificationDataVo();if(!v0.okLabel)v0.okLabel=v12;if(!v0.cancelLabel)v0.cancelLabel=v14;v4.push(v0);if(!v7)v10();};function v3(){if(v4.length>0)v10();else v9();};function v9(){v5._view.removeChild(v15);v7=false;};function v10(){var v13=v4[0];v4.shift();v7=true;v15.showWindow(v13);if(!v5._view.contains(v15))v5._view.addChild(v15);v5._onResize();}});};cnst(NotificationWindowMediator,"SHOW","NotificationWindowMediator-show");cnst(NotificationWindowMediator,"HIDE","NotificationWindowMediator-hide");function ContentMediator(view){return createClass(this,AbstractResizeMediator,null,function(v2,v3){v2._handlers.push(ContentMediator.SHOW);var v6=new DataProxy();var v5=new Language();var v7=new ContentView();v2.reciveNotification=function(v1,v0){v3.reciveNotification(v1,v0);switch(v1){case ContentMediator.SHOW:v4();break;}};v2._onResize=function(){if(v2._view.contains(v7))v7.render();};function v8(v0){v7.init(v0);v2._view.addChild(v7);};function v4(){v7.addEventListener(ContentMediator.ON_SHOW_NOTIFICATION_WINDOW_CLICK,function(){var v9=new NotificationWindowDataVo();v9.title=v5.getText("notification_title");v9.content=v5.getText("notification_content");v9.height=230;v2.sendNotification(NotificationWindowMediator.SHOW,v9);});v6.loadAnimation("json/animation/contentAnimation.json").resolve(v8);v2._onResize();}});};cnst(ContentMediator,"SHOW","ContentMediator-show");cnst(ContentMediator,"ON_SHOW_NOTIFICATION_WINDOW_CLICK","ContentMediator-onShowNotificationWindowClick");function ViewPrepCommand(){return createClass(this,ASJS.AbstractCommand,null,function(v1,v2){var v3=new Language();v1.execute=function(v0){new ContentMediator(v0.contentView);var v4=new NotificationWindowMediator(v0.notificationWindowView);v4.setDefault(v3.getText('notification_ok_button'),v3.getText('notification_cancel_button'));}});};function StartupCommand(){return createClass(this,ASJS.AbstractCommand,null,function(v2,v3){var v1;v2.execute=function(v0){v1=v0;v4();};function v4(){(new ConfigLoaderCommand()).execute().resolve(v5);};function v5(){(new LanguageLoaderCommand()).execute().resolve(v6);};function v6(){(new EnvironmentCommand()).execute();(new ViewPrepCommand()).execute(v1);v2.sendNotification(ContentMediator.SHOW);}});};function Application(){return createClass(this,Object,null,function(v0,v1){var v2=new ASJS.Sprite();var v3=new ASJS.Sprite();v0.new=function(){trace("<AS/JS> 2.0 Application");stage.addChild(v0.contentView);stage.addChild(v0.notificationWindowView);(new StartupCommand()).execute(v0);};prop(v0,"contentView",{get:function(){return v2;}});prop(v0,"notificationWindowView",{get:function(){return v3;}});});};ASJS.start(Application);