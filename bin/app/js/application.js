;function Config(){return createSingletonClass(Config,this,ASJS.AbstractModel);};function JSONLoader(){return createClass(this,ASJS.Loader,null,function(v19,v16){v19.new=function(){v19.responseType="json";}});};function DataProxy(){return createSingletonClass(DataProxy,this,Object,null,function(v19,v16){v19.loadJSON=function(v2){var v3=new ASJS.Deferred();var v25=new JSONLoader();v25.method=ASJS.RequestMethod.GET;v25.addEventListener(ASJS.LoaderEvent.LOAD,function(e){v3.resolve(v25.content);});v25.addEventListener(ASJS.LoaderEvent.ERROR,function(e){v3.reject(v25.content);});v25.load(v2);return v3.promise;}
v19.loadAnimation=function(v2){return(new ASJS.AnimationLoader()).load(v2);}});};function ConfigLoaderCommand(){return createClass(this,ASJS.AbstractCommand,null,function(v19,v16){var v32=new Config();var v46=new DataProxy();v19.execute=function(){var v33=v46.loadJSON("json/config.json");v33.resolve(function(v38){v32.data=v38;});return v33;}});};function Language(){return createSingletonClass(Language,this,ASJS.AbstractModel,null,function(v19,v16){prop(v19,"supportedLanguages",{get:function(){return v16.data.supportedLanguages;}});prop(v19,"selectedLanguage",{get:function(){return v16.data.selectedLanguage;}});v19.getText=function(k){var i=v19.get("elements")[k];return i!=null&&i[v19.selectedLanguage]!=undefined?i[v19.selectedLanguage]:"";}
v19.genText=function(v1){for(var k in v19.data)v1=v1.split("{{"+k+"}}").join(v19.getText(k));return v1;}});};function LanguageLoaderCommand(){return createClass(this,ASJS.AbstractCommand,null,function(v19,v16){var v43=new Language();var v46=new DataProxy();v19.execute=function(){var v33=v46.loadJSON("json/language.json");v33.resolve(function(v38){v43.data=v38;});return v33;}});};var Tools={};roFunc(Tools,"replaceText",function(s,o){var r=/{{.*?}}/g;var rt=s;var m;while((m=r.exec(s))!==null){if(m.index===r.lastIndex)r.lastIndex++;var e=m[0].split("{{").join("").split("}}").join("");var c=Tools.ref(o,e);rt=rt.replace(m[0],c!=null?c:m[0]);}
return rt;});roFunc(Tools,"ref",function(o,s){return s.split(".").reduce(function(o,x){return o[x];},o);});roFunc(Tools,"isValidEmailAddress",function(v14){var re=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(v14);});roFunc(Tools,"getURLParams",function(param){var v2=decodeURIComponent(new ASJS.Window().location.href).split("#");if(v2[1]==''||v2[1]==undefined)return[];var v26=v2[1].split('&');var i=-1;var l=v26.length;var v40={};while(++i<l){var v9=v26[i].split('=');v40[v9[0]]=v9[1];}
return v40[param];});roFunc(Tools,"createUrlParams",function(v26,reload){var v2="";for(var k in v26){if(v2!="")v2+="&";v2+=k+"="+v26[k];}
var v22=new ASJS.Window();v22.location.href=v22.location.href.split(v22.location.hash).join("")+"#"+v2;if(reload)Tools.reload();});roFunc(Tools,"reload",function(){new ASJS.Window().location.reload(true);});function Cookies(){return createSingletonClass(Cookies,this,Object,null,function(v19,v16){v19.createCookie=function(n,v,d){if(d){var v7=new Date();v7.setTime(v7.getTime()+(d*86400000));var v36="; expires="+v7.toGMTString();}else var v36="";document.cookie=n+"="+v+v36+"; path=/";try{if(typeof(Storage)!=="undefined")localStorage[n]=v;}catch(e){trace(e);}}
v19.readCookie=function(n){var v20=n+"=";var ca=document.cookie.split(';');var i=-1;var l=ca.length;while(++i<l){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(v20)==0)return c.substring(v20.length,c.length);}
try{if(typeof(Storage)!=="undefined")return localStorage[n];}catch(e){trace(e);}
return null;}
v19.eraseCookie=function(n){v19.createCookie(n,"",-1);try{if(typeof(Storage)!=="undefined")delete localStorage[n];}catch(e){trace(e);}}});};function EnvironmentCommand(){return createClass(this,ASJS.AbstractCommand,null,function(v19,v16){var v31=new ASJS.Window();var v43=new Language();var v39=new Cookies();var v35=new ASJS.Cycler();var v32=new Config();var v73;v19.execute=function(){v60();v50();v49();}
function v60(){var v74=Tools.getURLParams('lang');if(v74==undefined||v43.supportedLanguages.indexOf(v74)==-1)v74=v39.readCookie('language');if(v74==undefined||v43.supportedLanguages.indexOf(v74)==-1)v74=v43.selectedLanguage;v43.set("selectedLanguage",v74);v39.createCookie('language',v43.selectedLanguage);stage.title=v43.getText("title");}
function v50(){v35.fps=v32.get("fps");v35.start();}
function v49(){stage.addEventListener(ASJS.Stage.RESIZE,v62);}
function v62(){v73=v31.clearTimeout(v73);v73=v31.setTimeout(v42,v32.get("resizeInterval"));}
function v42(){v73=v31.clearTimeout(v73);v19.sendNotification(ASJS.Stage.RESIZE);}});};function AbstractResizeMediator(view){return createClass(this,ASJS.AbstractMediator,[view],function(v19,v16){v19._handlers=[ASJS.Stage.RESIZE];v19.reciveNotification=function(v5,v4){switch(v5){case ASJS.Stage.RESIZE:v19._onResize();break;}}
v19._onResize=function(){}});};function AbstractView(){return createClass(this,ASJS.Sprite,null,function(v19,v16){var v63={alpha:0};var v29=new ASJS.Easing();v19.new=function(){v19.addEventListener(ASJS.Stage.ADDED_TO_STAGE,v57);}
v19._animateTo=function(to,v70){v63={alpha:v19.alpha};v29.stop();v29.play(v63,{alpha:to},1000,"easeInOutExpo",function(){v19.alpha=v63.alpha;},v70);}
function v57(){v19.alpha=0;v19._animateTo(1);}});};function ContentView(){return createClass(this,AbstractView,null,function(v19,v16){var v11={};cnst(v11,"ANIMATION_EXPLODE_ID","animationExplode");cnst(v11,"ANIMATION_FIREWORKS_ID","animationFireworks");var v43=new Language();var v17=new ASJS.Mouse();var v51=new ASJS.Sprite();var v8=new ASJS.Sprite();var v18=new ASJS.Label();var v27=new ASJS.Button();var v66=new ASJS.AnimatedSprite();var v15=false;v19.new=function(){v19.addEventListener(ASJS.Stage.ADDED_TO_STAGE,v57);}
v19.render=function(){v51.setSize(stage.stageWidth,stage.stageHeight);v8.x=(stage.stageWidth-v8.width)*0.5;}
v19.init=function(v4){v51.addClass("content-view--background");v51.setCSS("position","fixed");v51.alpha=0.5;v19.addChild(v51);v8.addClass("content-view--box");v8.setSize(320,130);v8.y=100;v19.addChild(v8);v18.text=v43.getText("new_asjs_base_site");v18.addClass("content-view--box--label");v18.setSize(320,30);v18.move(0,34);v8.addChild(v18);v27.label=v43.getText("show_notification_window");v27.addClass("content-view--box--button");v27.setSize(320,40);v27.move(0,v8.height-v27.height);v27.addEventListener(ASJS.MouseEvent.CLICK,v59);v8.addChild(v27);v66.addAnimationDescriptorList(v4);v66.move(10,10);v19.addChild(v66);v66.addEventListener(ASJS.MouseEvent.CLICK,v78);v66.addEventListener(ASJS.MouseEvent.MOUSE_DOWN+" "+ASJS.MouseEvent.TOUCH_START,v82);stage.addEventListener(ASJS.MouseEvent.MOUSE_UP+" "+ASJS.MouseEvent.TOUCH_END,v48);stage.addEventListener(ASJS.MouseEvent.MOUSE_LEAVE,v48);stage.addEventListener(ASJS.MouseEvent.MOUSE_MOVE+" "+ASJS.MouseEvent.TOUCH_MOVE,v72);v19.addEventListener(ASJS.MouseEvent.CLICK,v55);v19.render();}
function v57(){v79();}
function v59(){v19.dispatchEvent(ContentMediator.ON_SHOW_NOTIFICATION_WINDOW_CLICK);}
function v77(){if(!v66)return;v66.setSize(256,128);v66.play(v11.ANIMATION_EXPLODE_ID,ASJS.AnimatedSprite.PLAY_REVERSE);}
function v79(){if(!v66)return;v66.setSize(200,200);v66.play(v11.ANIMATION_FIREWORKS_ID);}
function v78(){if(v66.selectedAnimation==v11.ANIMATION_FIREWORKS_ID)v77();else v79();}
function v82(){v15=true;}
function v48(){v15=false;}
function v72(){v19.filters=[new ASJS.BlurFilter((Math.max(0,stage.stageHeight/(stage.stageHeight-v17.mouseY))/10))];if(!v15)return;v66.move(v17.mouseX-v66.width*0.5,v17.mouseY-v66.height*0.5);}
function v55(){var v28=v8.hitTest(new ASJS.Point(v17.mouseX,v17.mouseY));v18.text=v43.getText(v28?"hit_test_inside":"hit_test_outside");}});};function NotificationWindowView(){return createClass(this,AbstractView,null,function(v19,v16){var v75={};var v31=new ASJS.Scale9Grid();var v23=new ASJS.Sprite();var v37=new ASJS.Sprite();var v41=new ASJS.Button();var v61=new ASJS.Button();v19.new=function(){v19.setCSS("background-color","rgba( 0, 0, 0, 0.4 )");v19.setCSS("position","fixed");v31.size=new ASJS.Point(30,80);v31.rect=new ASJS.Rectangle(13,60,4,7);v31.backgroundImage="images/window.png";v19.addChild(v31);v23.height=50;v23.setCSS("line-height",v23.height+"px");v23.addClass("notification-window-view--title-label");v19.addChild(v23);v37.addClass("notification-window-view--content-label");v19.addChild(v37);v41.addEventListener(ASJS.MouseEvent.CLICK,function(){v19.hideWindow();if(v75['okCallback']!=undefined)v75['okCallback']();});v68(v41);v61.addEventListener(ASJS.MouseEvent.CLICK,function(){v19.hideWindow();if(v75['cancelCallback']!=undefined)v75['cancelCallback']();});v68(v61);}
v19.hideWindow=function(){v19._animateTo(0,function(){v19.dispatchEvent(NotificationWindowMediator.HIDE);v23.html="";v37.html="";if(v52())v19.removeChild(v41);v41.label="";if(v69())v19.removeChild(v61);v61.label="";});}
v19.showWindow=function(v71){v75=v71;v23.html=v75.title;v37.html=v75.content;if(v75['showOk']){v41.label=v75['okLabel'];if(!v52())v19.addChild(v41);}else if(v52())v19.removeChild(v41);if(v75['showCancel']){v61.label=v75['cancelLabel'];if(!v69())v19.addChild(v61);}else if(v69())v19.removeChild(v61);}
v19.render=function(){v19.setSize(stage.stageWidth,stage.stageHeight);v31.setSize(Math.max(150,Math.min(stage.stageWidth,v75.width)),Math.max(150,Math.min(stage.stageHeight,v75.height)));v31.move((stage.stageWidth-v31.width)*0.5,Math.max(0,(stage.stageHeight-v31.height)*0.5));v31.render();v23.move(v31.x+25,v31.y+10);v23.width=v31.width-50;v37.move(v23.x,v23.y+v23.height+25);v37.setSize(v23.width,v31.height-v23.height-55-(v52()||v69()?60:0));if(v37.render)v37.render();v41.width=v31.width*0.5-20;if(v52()){v41.x=v31.x+(v69()?v31.width*0.5-10-v41.width:((v31.width-v41.width)*0.5));v41.y=v31.y+v31.height-v41.height-30;}
v61.width=v41.width;if(v69()){v61.x=v31.x+(v52()?v31.width*0.5+10:((v31.width-v61.width)*0.5));v61.y=v31.y+v31.height-v61.height-30;}}
function v52(){return v19.contains(v41);}
function v69(){return v19.contains(v61);}
function v68(v24){v24.addClass("notification-window-view--button");v24.height=42;}});};function NotificationWindowDataVo(){return createClass(this,Object,null,function(v19,v16){v19.title="";v19.content="";v19.showOk=true;v19.showCancel=false;v19.okCallback=null;v19.cancelCallback=null;v19.okLabel=null;v19.cancelLabel=null;v19.width=500;v19.height=200;});};function NotificationWindowMediator(view){return createClass(this,AbstractResizeMediator,[view],function(v19,v16){v19._handlers.push(NotificationWindowMediator.SHOW);var v58=true;var v13=[];var v30=false;var v67="";var v76="";var v80=new NotificationWindowView();v19.new=function(){v80.addEventListener(NotificationWindowMediator.HIDE,v12);}
v19.reciveNotification=function(v5,v4){v16.reciveNotification(v5,v4);switch(v5){case NotificationWindowMediator.SHOW:v10(v4);break;}}
v19.setDefault=function(v34,v53){v67=v34;v76=v53;}
v19._onResize=function(){v58=true;if(!v19._view.contains(v80))return;v80.render();v58=false;}
function v10(v4){if(v4==undefined)v4=new NotificationDataVo();if(!v4.okLabel)v4.okLabel=v67;if(!v4.cancelLabel)v4.cancelLabel=v76;v13.push(v4);if(!v30)v47();}
function v12(){if(v13.length>0)v47();else v45();}
function v45(){v19._view.removeChild(v80);v30=false;}
function v47(){var v71=v13[0];v13.shift();v30=true;v80.showWindow(v71);if(!v19._view.contains(v80))v19._view.addChild(v80);if(v58)v19._onResize();}});}
cnst(NotificationWindowMediator,"SHOW","NotificationWindowMediator-show");cnst(NotificationWindowMediator,"HIDE","NotificationWindowMediator-hide");function ContentMediator(view){return createClass(this,AbstractResizeMediator,[view],function(v19,v16){v19._handlers.push(ContentMediator.SHOW);var v58=true;var v46=new DataProxy();var v43=new Language();var v54=new ContentView();v19.reciveNotification=function(v5,v4){v16.reciveNotification(v5,v4);switch(v5){case ContentMediator.SHOW:v21();break;}}
v19._onResize=function(){v58=true;if(!v19._view.contains(v54))return;v54.render();v58=false;}
function v64(v4){v54.init(v4);v19._view.addChild(v54);}
function v21(){v54.addEventListener(ContentMediator.ON_SHOW_NOTIFICATION_WINDOW_CLICK,function(){var v81=new NotificationWindowDataVo();v81.title=v43.getText("notification_title");v81.content=v43.getText("notification_content");v81.height=230;v19.sendNotification(NotificationWindowMediator.SHOW,v81);});v46.loadAnimation("json/animation/contentAnimation.json").resolve(v64);if(v58)v19._onResize();}});}
cnst(ContentMediator,"SHOW","ContentMediator-show");cnst(ContentMediator,"ON_SHOW_NOTIFICATION_WINDOW_CLICK","ContentMediator-onShowNotificationWindowClick");function ViewPrepCommand(){return createClass(this,ASJS.AbstractCommand,null,function(v19,v16){var v43=new Language();v19.execute=function(v0){new ContentMediator(v0.contentView);var v83=new NotificationWindowMediator(v0.notificationWindowView);v83.setDefault(v43.getText('notification_ok_button'),v43.getText('notification_cancel_button'));}});};function StartupCommand(){return createClass(this,ASJS.AbstractCommand,null,function(v19,v16){var v6;v19.execute=function(v0){v6=v0;v44();}
function v44(){(new ConfigLoaderCommand()).execute().resolve(v56);}
function v56(){(new LanguageLoaderCommand()).execute().resolve(v65);}
function v65(){(new EnvironmentCommand()).execute();(new ViewPrepCommand()).execute(v6);v19.sendNotification(ContentMediator.SHOW);}});};function Application(){return createClass(this,Object,null,function(v19,v16){var v54=new ASJS.Sprite();var v80=new ASJS.Sprite();v19.new=function(){trace("<AS/JS> 2.0 Application");stage.addChild(v19.contentView);stage.addChild(v19.notificationWindowView);(new StartupCommand()).execute(v19);}
prop(v19,"contentView",{get:function(){return v54;}});prop(v19,"notificationWindowView",{get:function(){return v80;}});});};ASJS.start(Application);